{"meta":{"title":"Henry","subtitle":"é¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€","description":null,"author":"æå®ä¼Ÿ","url":"http://blog.nicexiangcun.com"},"posts":[{"title":"awk","slug":"å¤šè·¯å¤ç”¨","date":"2020-03-11T13:58:51.000Z","updated":"2020-11-20T13:06:15.520Z","comments":true,"path":"2020/03/11/å¤šè·¯å¤ç”¨/","link":"","permalink":"http://blog.nicexiangcun.com/2020/03/11/%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/","excerpt":"","text":"nginx æ˜¯ä¸ƒæˆçš„æ˜¯tcp3æ¬¡æ¡æ‰‹ä¹‹åçš„äº‹æƒ…ï¼Œ æ•°æ®åŒ…ï¼š æ¡æ‰‹çš„åŒ…ï¼Œä¼ è¾“æ•°æ®çš„åŒ…ï¼Œp æ ‡ç¤ºä»£è¡¨å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨çš„æ•°æ®åŒ…éœ€è¦äº¤ç»™åº”ç”¨ç¨‹åºç«‹å³å¤„ç†ï¼Œç«‹å³æ‰“æ–­ç¼“å†²åŒºçš„æ•°æ®ç«‹å³å¤„ç†ï¼Œè¯´ç™½äº†ï¼Œè¦ç»ˆæ­¢å½“å‰ï¼Œæ‰“æ–­ç¼“å†²ï¼Œç«‹å³æ‰§è¡Œã€‚buffer æ˜¯ä¸æ–­å †ç§¯ä¸œè¥¿ï¼Œåˆ°ä¸€å®šé‡å°±è¦æ‰§è¡Œã€‚ å››å±‚ç½‘ç»œæˆè´Ÿè´£èµ„æºå¼€è¾Ÿã€‚å¼€è¾Ÿèµ„æºåæ‰æœ‰socketï¼Œæ‰æœ‰æ–‡ä»¶æè¿°ç¬¦ã€‚ å·¥å…· ncï¼ˆnetcatï¼‰ å¯ç”¨æ¨¡æ‹Ÿ æœåŠ¡ç«¯ å’Œå®¢æˆ·ç«¯ã€‚ nc -l 8081 ä¹‹åç­‰å¾…é“¾æ¥ nc localhost 8081 åˆ›å»ºå®¢æœç«¯ï¼Œè¿æ¥æœåŠ¡ç«¯ æŸ¥çœ‹nc æœåŠ¡ç«¯çš„è¿›ç¨‹ID=2485 ps -ef | grep nc æŸ¥çœ‹nc è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ cd /proc/2485/fd å¯ä»¥çœ‹åˆ°ä»»ä½•ç¨‹åºéƒ½ä¼šæœ‰ 0ï¼Œ1ï¼Œ2 ï¼ŒåŒæ—¶è¿˜çœ‹åˆ°äº†ä¸€ä¸ªsocket ï¼Œ0 æ ‡å‡†è¾“å…¥ï¼ˆè¯»ï¼‰ 1 æ ‡å‡†è¾“å‡ºï¼ˆå†™ï¼‰ 2 æŠ¥é”™ã€‚ æ­¤æ—¶è¿˜æ²¡æœ‰å®¢æˆ·ç«¯å»é“¾æ¥å®ƒï¼Œä½†æ˜¯ä¾ç„¶ä¼šæœ‰socket,åªä¸è¿‡æ­¤æ—¶å¤„äºç›‘å¬çŠ¶æ€ã€‚ç°åœ¨ç”¨ä¸€ä¸ªå®¢æˆ·ç«¯å»é“¾æ¥å®ƒï¼Œåœ¨å»çœ‹æè¿°ç¬¦åˆ—è¡¨ï¼Œæ­¤æ—¶å°±ä¼šå¤šå‡ºä¸€ä¸ª4å·ã€‚ å·¥å…· strace å¯ä»¥è¿½è¸ªç¨‹åºä¸ç³»ç»Ÿå†…æ ¸çš„è°ƒç”¨å’Œä¿¡å·ã€‚ mkdir -p /home/vagrant/lihongwei/strace_file ä¼šæŠ“å–è¿™ä¸ªncè¿›ç¨‹çš„æ‰€æœ‰çš„ç³»ç»Ÿå†…æ ¸çš„è°ƒç”¨ strace -ff -o out nc -l 8080 ç„¶åæŸ¥çœ‹æ—¥å¿—ï¼š tail -f out.2753 é€šè¿‡æ—¥å¿—è®°å½•çš„ç³»ç»Ÿå‡½æ•°åå¯ä»¥æŸ¥çœ‹å¸®åŠ© ï¼Œç³»ç»Ÿ2ç±»çš„ï¼Œè¯»æ–‡æ¡£ man 2 socket man 2 bind ç¨‹åºè°ƒç”¨ socket æ‰§è¡ŒæˆåŠŸä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚å¦‚ä¸Šé¢çš„ socket 3, ç„¶åå°± accept 3 äº†ã€‚ å¼€å¯è¿½è¸ª+å¼€å¯æ—¥å¿—ç›‘å¬å å¯åŠ¨ä¸€ä¸ªå®¢æˆ·ç«¯é“¾æ¥æœåŠ¡ç«¯ã€‚ ç›‘å¬åˆ°æ–°çš„æè¿°ç¬¦4ï¼ŒåŒæ—¶è¿½è¸ªåˆ°çš„å¯¹ç³»ç»Ÿè°ƒç”¨çš„ poll(),åŒæ—¶é˜»å¡åˆ°äº†pollã€‚ ç”¨å®¢æˆ·ç«¯å‘é€å­—ç¬¦helloç»™æœåŠ¡ç«¯ï¼Œåœ¨çœ‹æ—¥å¿—æƒ…å†µã€‚ é€šè¿‡è¿½è¸ªæ—¥å¿—å¯ä»¥å¼€åˆ°ï¼Œç³»ç»Ÿè°ƒç”¨ read ä» æè¿°ç¬¦4 ä¸­è¯»å– hello ï¼Œç„¶åé€šè¿‡ç³»ç»Ÿè°ƒç”¨write å†™å…¥æ ‡å‡†è¾“å‡ºæè¿°ç¬¦1ã€‚ ç”¨æœåŠ¡ç«¯å‘é€å­—ç¬¦lihongweiç»™å®¢æˆ·ç«¯ï¼Œåœ¨çœ‹æ—¥å¿—æƒ…å†µã€‚ é€šè¿‡è¿½è¸ªæ—¥å¿—å¯ä»¥å¼€åˆ°ï¼Œç³»ç»Ÿè°ƒç”¨ read ä» æ ‡å‡†è¾“å…¥æè¿°ç¬¦0 ä¸­è¯»å– lihongwei ï¼Œç„¶åé€šè¿‡ç³»ç»Ÿè°ƒç”¨write å†™å…¥æè¿°ç¬¦4ï¼ˆå®¢æˆ·ç«¯ï¼‰ã€‚ ç°åœ¨ åœ¨æ¢³ç† åŸå§‹ç‰ˆæœ¬çš„ socket è¿‡ç¨‹ã€‚ å…ˆä¸çœ‹ poll() ,ç†è®ºä¸Šåªè¦æˆ‘ä»¬å¾—åˆ°äº†æ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»è¯»å®ƒã€‚åªä¸è¿‡æ²¡æœ‰å†…å®¹å°±ä¼šé˜»å¡åœ¨é‚£ï¼Œå¦‚æœæè¿°ç¬¦4ä¸€ç›´åœ¨é‚£é˜»å¡ï¼Œå½“æœ‰æ–°çš„å®¢æˆ·ç«¯å®Œæˆ3æ¬¡æ¡æ‰‹åˆ›å»ºäº†æ–°çš„æ–‡ä»¶æè¿°ç¬¦5ï¼Œé‚£ä¹ˆ5ä¼šä¸€ç›´åœ¨accept(). è¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸º BIO. åœ¨åæ¥ï¼ŒæœåŠ¡ç«¯é€šè¿‡å¤šçº¿ç¨‹æ–¹å¼ï¼Œä¸ºæ¯ä¸ªæ–‡ä»¶æè¿°ç¬¦clone ä¸€ä¸ªçº¿ç¨‹å»è¯»å–ï¼Œä½¿æ¯ä¸€ä¸ªçº¿ç¨‹é˜»å¡è‡ªå·±çš„ï¼Œå¼Šç«¯å°±æ˜¯å®¢æˆ·ç«¯å¤šäº†ï¼Œå°±éœ€è¦å¤šå°‘ä¸ªå®¢æˆ·ç«¯çš„çº¿ç¨‹,clone å±äºç³»ç»Ÿè°ƒç”¨ï¼Œæµªè´¹èµ„æºã€‚ åœ¨åæ¥ï¼Œéé˜»å¡IOæ—¶æœŸçš„åˆ°æ¥ï¼ˆNIOï¼‰ï¼Œå†…æ ¸æä¾›acceptï¼ˆï¼‰ï¼Œå¯ä»¥è®¾ç½®æˆä¸ºéé˜»å¡äº†ï¼Œè¿™æ ·ä¸»ç¨‹åºå†™ä¸€ä¸ªæ­»å¾ªç¯(ä¸€ä¸ªçº¿ç¨‹)ï¼Œread() æ²¡æœ‰æ•°æ®ç»§ç»­ accept(),ç„¶ååˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡å¾ªç¯è¯»å–é˜Ÿåˆ—é‡Œçš„fdï¼Œçœ‹çœ‹æ˜¯å¦æ˜¯å¯è¯»å¯å†™ã€‚å¼Šç«¯ï¼šæ¯æ¬¡éƒ½è¦æ‰€æœ‰çš„fdé˜Ÿåˆ—è°ƒç”¨ï¼Œå¦‚æœåªç”¨ç¬¬1000ä¸ªfdå¯è¯»å¯å†™ï¼Œå‰é¢çš„éƒ½æ˜¯æµªè´¹çš„ï¼Œé‡ç‚¹æ˜¯è¿˜æ˜¯ä¸æ–­çš„è°ƒç”¨å†…æ ¸æ˜¯æµªè´¹çš„ã€‚ man 2 select åœ¨åæ¥ï¼Œå†…æ ¸ æ–°å¢ selectç³»ç»Ÿè°ƒç”¨ï¼Œ å¯ä»¥åŒæ—¶ç›‘å¬å¤šä¸ªå…·æŸ„çš„çŠ¶æ€å˜åŒ–ï¼Œåº”ç”¨ç¨‹åºè°ƒç”¨ select å‘Šè¯‰å†…æ ¸æœ‰å¤šå°‘ fd.æœ‰å†…æ ¸å®Œæˆéå† fdï¼Œç„¶åé€šçŸ¥åº”ç”¨ç¨‹åºã€‚åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ª Oï¼ˆ1ï¼‰çš„selct è°ƒç”¨ï¼Œä½†æ˜¯å†…æ ¸è¿˜æ˜¯ä¸€ä¸ªOï¼ˆnï¼‰çš„éå†ã€‚è¿”å›å¯è¯»å¯å†™çš„fd ç»™åº”ç”¨ç¨‹åºã€‚å¼Šç«¯ï¼šæ–‡ä»¶æè¿°ç¬¦æ˜¯æœ‰é™åˆ¶çš„ select é»˜è®¤æ”¯æŒ 1024ä¸ªã€‚ åœ¨åæ¥ï¼Œepool çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç½‘å¡çš„é«˜ä½å‹ç”µç“¶ æ¥æ”¶æ•°æ®ï¼Œç»™å†…å­˜bufferï¼Œæ‰€æœ‰è®¾å¤‡éƒ½æ˜¯è°æœ‰æ•°æ®è¾¾åˆ°ï¼Œå°±å¾€æ•°æ®æ€»çº¿æ‰“äº‹ä»¶ï¼Œç„¶åè§¦å‘cupä¸­æ–­ï¼Œcpu å¤„ç†ç„¶åå›æ‰ï¼ˆé©±åŠ¨çš„äº‹æƒ…ï¼‰ï¼Œ åˆ©ç”¨ä¸­æ–­äº§ç”Ÿäº‹ä»¶åŸç†ï¼Œepool_ctl ä¼šå°†é“¾æ¥çš„æè¿°ç¬¦æ”¾åœ¨å†…æ ¸çš„ä¸€ä¸ªæŒ‡å®šåŒºåŸŸAï¼Œå½“æœ‰å¯è¯»å¯å†™çš„æ—¶å€™ï¼Œå†…æ ¸ä¼šé€šè¿‡ä¸­æ–­æœºåˆ¶ï¼Œå°†å¯è¯»å¯å†™çš„æ”¾åœ¨å¦ä¸€ä¸ªåŒºåŸŸBï¼Œè€Œepool_wait å°±æ˜¯å¾ªç¯è¯»å–è¿™ä¸ªåŒºåŸŸã€‚ çœ‹strace æ—¥å¿—ï¼Œæœ‰ä¸€ä¸ªsendfile() ç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥æŸ¥çœ‹å¸®åŠ©ï¼Œman 2 sendfile, å®ç°çš„æ˜¯ä¸€ä¸ª0æ‹·è´ï¼Œæ˜¯ç³»ç»Ÿå†…æ ¸è¯»å‡ºæ–‡ä»¶æè¿°ç¬¦ï¼Œè‡ªå·±å‘é€ç»™å®¢æˆ·ç«¯æ–‡ä»¶æè¿°ç¬¦ï¼Œå¦åˆ™çš„è¯æµç¨‹æ˜¯è¿™æ ·çš„åº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨ç³»ç»Ÿå†…æ ¸read,å†…æ ¸å°†æ–‡ä»¶å†…å®¹è¯»åˆ°å†…æ ¸ä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶ååº”ç”¨ç¨‹åºåœ¨è°ƒç”¨å†…æ ¸ write(), å†…æ ¸åœ¨é€šè¿‡wirte å†™ç»™å®¢æˆ·ç«¯æ–‡ä»¶æè¿°ç¬¦ã€‚ ç›´æ¥å†…å­˜ï¼š å†…æ ¸ä»£ç åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šè¢«ç³»ç»Ÿä¿æŠ¤èµ·æ¥ï¼Œç§°ä¹‹ä¸ºå†…æ ¸æ€ï¼Œå†…æ ¸æ€ä¸ºäº†é˜²æ­¢ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºé»‘å®¢çš„ç ´åï¼Œåªæä¾›äº†ä¸€äº›å¯ä¾›è°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°ï¼Œè€Œæ•°æ®äº¤äº’éƒ½æ˜¯é€šè¿‡å†…æ ¸æä¾›çš„ç¼“å†²åŒºäº¤äº’ï¼Œä¸åœçš„æ‹·è´æ¥æ‹·è´å»ï¼Œæ•ˆç‡å°±å¾ˆä½ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå°±ç”³è¯·äº†ä¸€å—ç”¨æˆ·æ€å’Œå†…æ ¸æ€å…±äº«çš„å†…å­˜ç©ºé—´bufferï¼Œä¸ç”¨è€ƒå‘—æ¥æ‹·è´å»ã€‚å…¸å‹çš„ä¸€ä¸ªæ¡ˆä¾‹æ˜¯kafa,ä»–çš„åŸç†å°±æ˜¯ï¼šå®¢æˆ·ç«¯é“¾æ¥kafka æœåŠ¡ç«¯brokerï¼ŒæœåŠ¡ç«¯brokerï¼Œç³»ç»Ÿå†…æ ¸è°ƒç”¨readï¼Œè¯»åˆ°æ¶ˆæ¯ï¼Œè¿™æ­©ç³»ç»Ÿè°ƒç”¨å°‘ä¸äº†ï¼Œç„¶åä¸‹ä¸€æ­¥éœ€è¦å†™å…¥ç£ç›˜ï¼Œè¿™ä¸€æ­¥ä¸ç”¨åœ¨ç³»ç»Ÿè°ƒç”¨äº†ï¼Œç›´æ¥ç»´æŠ¤ä¸€ä¸ª1gçš„å…±äº«å†…å­˜ï¼Œç›´æ¥å†™å†…å­˜ï¼Œç„¶åå†…æ ¸è½å…¥ç£ç›˜ã€‚kafaka sendfile() å’Œ ç›´æ¥å†…å­˜2é¡¹æŠ€æœ¯ éƒ½ç”¨åˆ°äº†ã€‚ cd /usr/sbin strace -ff -o out ./nginx çœ‹worker è¿›ç¨‹çš„æœ€ç»ˆæ—¥å¿—ï¼š ä»¥ä¸Šçš„ä¸€äº›è§£å†³æ–¹æ¡ˆï¼Œéƒ½æ˜¯åœ¨æœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºåœ¨æ¢ç´¢æ–¹æ¡ˆã€‚ æœ€ç»ˆæŠŠ nc æ¢æˆæˆ‘ä»¬æ—¥å¸¸å…¶ä»–çš„åº”ç”¨ç¨‹åºã€‚","raw":null,"content":null,"categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"http://blog.nicexiangcun.com/tags/Linux/"}]},{"title":"åŸºäºdockeræ­å»ºkongåˆ†å¸ƒå¼é›†ç¾¤","slug":"kong","date":"2020-01-07T13:52:10.000Z","updated":"2020-11-20T13:06:15.513Z","comments":true,"path":"2020/01/07/kong/","link":"","permalink":"http://blog.nicexiangcun.com/2020/01/07/kong/","excerpt":"Â¶åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ\ndocker network create kong-net\nÂ¶å®‰è£…kongä¾èµ–çš„æ•°æ®åº“\n123456docker run -d --name kong-database \\     --network=kong-net \\     -p 5432:5432 \\     -e &quot;POSTGRES_USER=kong&quot; \\     -e &quot;POSTGRES_DB=kong&quot; \\     postgres:9.6\n12345docker run --rm \\     --network=kong-net \\     -e &quot;KONG_DATABASE=postgres&quot; \\     -e &quot;KONG_PG_HOST=kong-database&quot; \\     kong:latest kong migrations bootstrap","text":"Â¶åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ docker network create kong-net Â¶å®‰è£…kongä¾èµ–çš„æ•°æ®åº“ 123456docker run -d --name kong-database \\ --network=kong-net \\ -p 5432:5432 \\ -e &quot;POSTGRES_USER=kong&quot; \\ -e &quot;POSTGRES_DB=kong&quot; \\ postgres:9.6 12345docker run --rm \\ --network=kong-net \\ -e &quot;KONG_DATABASE=postgres&quot; \\ -e &quot;KONG_PG_HOST=kong-database&quot; \\ kong:latest kong migrations bootstrap Â¶å®‰è£…2å°kongèŠ‚ç‚¹ 12345678910111213141516171819202122232425262728293031docker run -d --name kong-node1 \\ --network=kong-net \\ -e &quot;KONG_DATABASE=postgres&quot; \\ -e &quot;KONG_PG_HOST=kong-database&quot; \\ -e &quot;KONG_PROXY_ACCESS_LOG=/dev/stdout&quot; \\ -e &quot;KONG_ADMIN_ACCESS_LOG=/dev/stdout&quot; \\ -e &quot;KONG_PROXY_ERROR_LOG=/dev/stderr&quot; \\ -e &quot;KONG_ADMIN_ERROR_LOG=/dev/stderr&quot; \\ -e &quot;KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl&quot; \\ -p 8000:8000 \\ -p 8443:8443 \\ -p 8001:8001 \\ -p 8444:8444 \\ kong:latestdocker run -d --name kong-node2 \\ --network=kong-net \\ -e &quot;KONG_DATABASE=postgres&quot; \\ -e &quot;KONG_PG_HOST=kong-database&quot; \\ -e &quot;KONG_PROXY_ACCESS_LOG=/dev/stdout&quot; \\ -e &quot;KONG_ADMIN_ACCESS_LOG=/dev/stdout&quot; \\ -e &quot;KONG_PROXY_ERROR_LOG=/dev/stderr&quot; \\ -e &quot;KONG_ADMIN_ERROR_LOG=/dev/stderr&quot; \\ -e &quot;KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl&quot; \\ -p 8446:8000 \\ -p 8447:8443 \\ -p 8448:8001 \\ -p 8449:8444 \\ kong:latest Â¶å®‰è£…ä¸¤å°nginxä»£ç† kong é»˜è®¤çš„ç®¡ç†ç«¯æ˜¯å£8001ï¼Œå¯¹å¤–çš„ç«¯å£æ˜¯8000å’Œ8443ï¼Œè¿™é‡Œä½¿ç”¨ä¸€å°nginxä»£ç†è½¬å‘åˆ°ç®¡ç†ç«¯å£,ä¸€å°è½¬å‘åˆ°å¯¹å¤–çš„è®¿é—®ç«¯å£. docker run --name nginx-node1 -p 8085:80 -d nginx docker run --name nginx-node2 -p 8086:80 -d nginx ä¿®æ”¹nginx-node1çš„location 1234567891011location / &#123; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Bitz_Client_IP $remote_addr; proxy_set_header X-Forwarded-For $remote_addr; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &quot;upgrade&quot;; proxy_ignore_client_abort on; proxy_pass http://henry;&#125; henry.conf 1234567upstream henry &#123; server 10.0.208.62:8001; //admin port server 10.0.208.62:8448; //admin port #check interval=3000 rise=2 fall=5 timeout=1000 type=http; #check_http_send &quot;HEAD /op/status HTTP/1.0\\r\\n\\r\\n&quot;; #check_http_expect_alive http_2xx http_3xx;&#125; ä¿®æ”¹nginx-node2çš„location 1234567891011location / &#123; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Bitz_Client_IP $remote_addr; proxy_set_header X-Forwarded-For $remote_addr; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &quot;upgrade&quot;; proxy_ignore_client_abort on; proxy_pass http://proxy_for_api;&#125; proxy_for_api.conf 1234567upstream proxy_for_api &#123; server 10.0.208.62:8000; server 10.0.208.62:8446; #check interval=3000 rise=2 fall=5 timeout=1000 type=http; #check_http_send &quot;HEAD /op/status HTTP/1.0\\r\\n\\r\\n&quot;; #check_http_expect_alive http_2xx http_3xx;&#125; Â¶ç¼“å­˜ Â¶æ‰©å±• admin api Â¶æŸ¥çœ‹å®¹å™¨çŠ¶æ€ 12345678910docker container list -adocker logs d402e041de4fdocker restart d402e041de4fdocker cp ./http_headers.lua d402e041de4f:/usr/local/openresty/lualib/resty/docker cp d402e041de4f:/usr/local/share/lua/5.1/kong/constants.lua ./","raw":null,"content":null,"categories":[{"name":"OpenResty","slug":"OpenResty","permalink":"http://blog.nicexiangcun.com/categories/OpenResty/"}],"tags":[]},{"title":"OpenRestyçš„å¤šçº§ç¼“å­˜åº“","slug":"openrestyå¤šçº§ç¼“å­˜","date":"2020-01-07T13:52:10.000Z","updated":"2020-11-20T13:06:15.514Z","comments":true,"path":"2020/01/07/openrestyå¤šçº§ç¼“å­˜/","link":"","permalink":"http://blog.nicexiangcun.com/2020/01/07/openresty%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98/","excerpt":"","text":"Â¶lua-resty-mlcache è¿™ä¸ªåº“å¯ä»¥ä½œä¸º key/valueå­˜å‚¨æ¥å¤„ç†ï¼Œä½†æ˜¯å¯ä»¥ç¼“å­˜Luaç±»å‹å’Œè¡¨ï¼Œä½†æ˜¯æ„å»ºåœ¨lua_shared_dictï¼Œlua-resty-lrucacheä¸Š ï¼Œè¿™ç§ç»„åˆå¯ä»¥å®ç°é«˜æ€§èƒ½å’Œçµæ´»çš„ç¼“å­˜ã€‚ åŠŸèƒ½ï¼š ä½¿ç”¨TTLç¼“å­˜å’Œè´Ÿç¼“å­˜ï¼Œ é€šè¿‡lua-resty-lockæ„å»ºäº’æ–¥ä½“ï¼Œä»¥é˜²æ­¢åœ¨ç¼“å­˜å¤±è´¥æ—¶å°†ç‹—å †å½±å“åˆ°æ•°æ®åº“/åç«¯ï¼Œ å†…ç½®workeré€šä¿¡ï¼Œä¼ æ’­ç¼“å­˜å¤±æ•ˆï¼Œå¹¶å…è®¸workeræ›´æ–°ä»–ä»¬çš„L1 (lua-resty-lrucache )ç¼“å­˜çš„æ›´æ”¹(set()ï¼Œdelete() )ï¼Œ å¯ä»¥åˆ›å»ºå¤šä¸ªç‹¬ç«‹å®ä¾‹æ¥ä¿å­˜å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶ä¾èµ–åŒä¸€lua_shared_dict L2ç¼“å­˜ï¼Œ æ­¤åº“ä¸­å†…ç½®çš„å„ç§ç¼“å­˜çº§åˆ«çš„è¯´æ˜ï¼š ç¼“å­˜çº§åˆ«å±‚æ¬¡ç»“æ„ä¸ºï¼š L1 ï¼šä½¿ç”¨Least-Recently-Used landç¼“å­˜lua-resty-lrucache ï¼Œåœ¨å¡«å……æ—¶æä¾›æœ€å¿«çš„æŸ¥æ‰¾ï¼Œå¹¶é¿å…è€—å°½workerçš„Luaè™šæ‹Ÿæœºå†…å­˜ï¼Œ L2 ï¼šæ‰€æœ‰å‘˜å·¥å…±äº«çš„lua_shared_dictå†…å­˜åŒºåŸŸï¼Œåªæœ‰L1æœªå‘½ä¸­æ—¶æ‰èƒ½è®¿é—®æ­¤çº§åˆ«ï¼Œå¹¶é˜²æ­¢å·¥ä½œäººå‘˜è¯·æ±‚L3ç¼“å­˜ï¼Œ L3 ï¼šè‡ªå®šä¹‰å‡½æ•°ï¼Œåªç”±å•ä¸ªworkerè¿è¡Œï¼Œä»¥é¿å…æ•°æ®åº“/åç«¯(é€šè¿‡lua-resty-lock )ä¸Šçš„ç‹—å †æ•ˆåº”ï¼Œé€šè¿‡L3è·å–çš„å€¼å°†è¢«è®¾ç½®ä¸ºL2ç¼“å­˜ï¼Œä¾›å…¶ä»–å‘˜å·¥è®¿é—®ï¼Œ","raw":null,"content":null,"categories":[{"name":"OpenResty","slug":"OpenResty","permalink":"http://blog.nicexiangcun.com/categories/OpenResty/"}],"tags":[]},{"title":"å“ˆå¸Œè¡¨","slug":"å“ˆå¸Œè¡¨","date":"2020-01-03T01:34:15.000Z","updated":"2020-11-20T13:06:15.520Z","comments":true,"path":"2020/01/03/å“ˆå¸Œè¡¨/","link":"","permalink":"http://blog.nicexiangcun.com/2020/01/03/%E5%93%88%E5%B8%8C%E8%A1%A8/","excerpt":"\n\thashtableæ˜¯ç”±æ•°ç»„å’Œåˆ—è¡¨ä¸¤ç§æ•°æ®ç»“æ„ç»„åˆè€Œæˆçš„ï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹éœ€è¦æŒæ¡ï¼Œä¸€ä¸ªæ˜¯å¦‚ä½•å¯¹å“ˆå¸Œè¡¨è¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œç¬¬äºŒä¸ªå¦‚ä½•å·§å¦™çš„è®¾è®¡ä¸€ä¸ªæ•£åˆ—æ€§å’Œæ€§èƒ½éƒ½éå¸¸å¥½çš„æ•£åˆ—å‡½æ•°ã€‚\n","text":"hashtableæ˜¯ç”±æ•°ç»„å’Œåˆ—è¡¨ä¸¤ç§æ•°æ®ç»“æ„ç»„åˆè€Œæˆçš„ï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹éœ€è¦æŒæ¡ï¼Œä¸€ä¸ªæ˜¯å¦‚ä½•å¯¹å“ˆå¸Œè¡¨è¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œç¬¬äºŒä¸ªå¦‚ä½•å·§å¦™çš„è®¾è®¡ä¸€ä¸ªæ•£åˆ—æ€§å’Œæ€§èƒ½éƒ½éå¸¸å¥½çš„æ•£åˆ—å‡½æ•°ã€‚ Â¶æ•°ç»„çš„åŠ¨æ€æ‰©å®¹ç­–ç•¥ å·²javaçš„ hashmapä¸ºä¾‹ï¼Œå®ƒçš„åˆå§‹é•¿åº¦æ˜¯16ï¼Œé»˜è®¤é˜€å€¼ä¸º0.75ï¼Œå½“å­˜å‚¨é•¿åº¦è¾¾åˆ°äº†é•¿åº¦çš„3/4æ—¶ï¼Œå°±ä¼šè§¦å‘æ‰©å®¹åŠ¨ä½œï¼Œæ‰©å®¹çš„é•¿åº¦ä¸º2çš„æ•´æ•°æ¬¡å¹‚ï¼Œè¿™æ˜¯å› ä¸º2çš„æ•´æ•°æ¬¡å¹‚çš„æ•°æ®å‡1è½¬ä¸ºäºŒè¿›åˆ¶ï¼Œä½ä½éƒ½æ˜¯1ï¼Œåœ¨ä¸hashcodeéšæœºå‡ºæ¥çš„æ•°è½¬ä¸ºäºŒè¿›åˆ¶åšä¸è¿ç®—ï¼Œå…¶ç»“æœèŒƒå›´ä¸€å®šæ˜¯0-hashcodeä¹‹é—´çš„èŒƒå›´ï¼Œä¸ä¼šè¶Šç•Œã€‚ 123456bucketIndex = indexFor(hash, table.length);static int indexFor(int h, int length) &#123; return h &amp; (length-1);&#125; Â¶æ•£åˆ—å‡½æ•° å¥½çš„æ•£åˆ—å‡½æ•°ä¸ä½†è¦ä¿è¯è®¡ç®—é€Ÿåº¦å¿«ï¼Œè¿˜è¦ä¿è¯æ•£åˆ—æ€§å¥½ï¼Œé¿å…è¿‡å¤šçš„ç¢°æ’ï¼Œæ‰°åŠ¨å‡½æ•°çš„é€»è¾‘æ˜¯å°†äºŒè¿›åˆ¶æ•°æ®å³ä½ç§»16ä½ï¼Œæ­£å¥½æ˜¯32bitçš„ä¸€åŠï¼Œç„¶åè‡ªå·±çš„é«˜åŠåŒºå’Œä½åŠåŒºåšå¼‚æˆ–ï¼Œå°±æ˜¯ä¸ºäº†æ··åˆåŸå§‹å“ˆå¸Œç çš„é«˜ä½å’Œä½ä½ï¼Œä»¥æ­¤æ¥åŠ å¤§ä½ä½çš„éšæœºæ€§ã€‚è€Œä¸”æ··åˆåçš„ä½ä½æºæ‚äº†é«˜ä½çš„éƒ¨åˆ†ç‰¹å¾ï¼Œè¿™æ ·é«˜ä½çš„ä¿¡æ¯ä¹Ÿè¢«å˜ç›¸ä¿ç•™ä¸‹æ¥ã€‚","raw":null,"content":null,"categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://blog.nicexiangcun.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[]},{"title":"redis ä¸»ä»é…ç½®","slug":"redis-replication","date":"2020-01-01T14:12:34.000Z","updated":"2020-11-20T13:06:15.517Z","comments":true,"path":"2020/01/01/redis-replication/","link":"","permalink":"http://blog.nicexiangcun.com/2020/01/01/redis-replication/","excerpt":"","text":"docker pull redis å¯åŠ¨masterå¹¶æ‰“å¼€redisæŒä¹…åŒ–é…ç½® docker run -p 6379:6379 -v $PWD/redis:/data -d redis redis-server --appendonly yes æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ docker inspect d7c20d48d35c | grep IPAddress å†…ç½‘IPï¼š 172.17.0.2 å¯åŠ¨slave1 docker run --name redis-6380 -p 6380:6379 -v $PWD/redis:/data -d redis redis-server å†…ç½‘IPï¼š 172.17.0.3 å¯åŠ¨slave2 docker run --name redis-6381 -p 6381:6379 -v $PWD/redis:/data -d redis redis-server å†…ç½‘IPï¼š 172.17.0.4 è¿›å…¥2ä¸ªä»èŠ‚ç‚¹ï¼Œä¿®æ”¹é…ç½®ã€‚ docker exec -it c19b7c8c6ed1 /bin/bash 123info replication #æŸ¥çœ‹è§’è‰²SLAVEOF 172.17.0.2 6379 #è®¾ç½®master Â¶é…ç½®Sentinel åˆ†åˆ«è¿›å…¥3ä¸ªå®¹å™¨é…ç½® åˆ›å»º sentinel.conf 1sentinel monitor mymaster 172.17.0.2 6379 1 æ¯ä¸ªèŠ‚ç‚¹å¯åŠ¨ redis-sentinel ./sentinel.conf é¦–å…ˆæŸ¥çœ‹å“¨å…µç›‘æ§æƒ…å†µ,ç„¶åå°è¯•å…³é—­ä¸»å®¹å™¨,å†æŸ¥çœ‹å‰©ä½™2ä¸ªä»æœºï¼Œè¿™é‡Œä¼šè‡ªåŠ¨é€‰ä¸¾äº§ç”Ÿæ–°çš„ä¸»æœºï¼Œç„¶åï¼Œæˆ‘ä»¬å†æ¬¡å°†åˆšæ‰åœæ­¢çš„ä¸»æœºå¯åŠ¨èµ·æ¥ï¼Œå‘ç°å¯åŠ¨åå…¶è‡ªåŠ¨æˆä¸ºä»æœºã€‚","raw":null,"content":null,"categories":[],"tags":[{"name":"redis","slug":"redis","permalink":"http://blog.nicexiangcun.com/tags/redis/"}]},{"title":"OpenResty æ­å»º Api Gateway","slug":"gateway","date":"2019-12-30T13:52:10.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2019/12/30/gateway/","link":"","permalink":"http://blog.nicexiangcun.com/2019/12/30/gateway/","excerpt":"Â¶What\n\n\nåŸºäºNginxå’Œluaçš„é«˜æ€§èƒ½Webå¹³å°ï¼Œå†…éƒ¨é›†æˆäº†å¤§é‡ç²¾è‰¯çš„luaåº“ï¼Œç¬¬ä¸‰æ–¹æ¨¡å—ä»¥åŠå¤§å¤šæ•°ä¾èµ–é¡¹ï¼Œæ–¹ä¾¿æ­å»ºå¤„ç†é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€webåº”ç”¨ã€webæœåŠ¡ï¼ŒåŠ¨æ€ç½‘å…³ã€‚\n\n\næ‰©å±•äº†Nginxçš„èƒ½åŠ›ï¼Œå°†Nginxæœ‰æ•ˆçš„å˜æˆäº†ä¸€ä¸ªå¼ºå¤§çš„webåº”ç”¨å¹³å°ï¼Œwebå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨luaè„šæœ¬è°ƒåŠ¨nginxæ”¯æŒçš„å„ç§cä»¥åŠluaæ¨¡å—ã€‚å¿«é€Ÿæ„å»ºå‡ºè¶³ä»¥èƒœä»»c10kä¹ƒè‡³c100kä»¥ä¸Šçš„å•æœºå¹¶å‘è¿æ¥çš„åŠŸæ€§èƒ½webåº”ç”¨ç³»ç»Ÿã€‚\n\n\nå……åˆ†åˆ©ç”¨äº†Nginxçš„éé˜»å¡çš„I/Oæ¨¡å‹ï¼Œä¸ä»…å¯¹HTTPè¯·æ±‚ï¼Œç”šè‡³å¯¹äºè¿œç¨‹åç«¯è¯¸å¦‚Mysqlã€PostgreSQL,Redisç­‰éƒ½è¿›è¡Œäº†ä¸€è‡´é«˜æ€§èƒ½ç›¸åº”ã€‚\n\n\nÂ¶ä½¿ç”¨åœºæ™¯\n\nç½‘å…³&amp;webé˜²ç«å¢™ï¼šå¦‚æ•°æ®å‰ç½®æ ¡éªŒï¼Œç¼“å­˜å‰ç½®ï¼Œæ•°æ®è¿‡æ»¤ï¼ŒAPIè¯·æ±‚èšåˆï¼ŒABtest,é™çº§ï¼Œç›‘æ§ç­‰ï¼Œå¯ä»¥è¿›è¡Œ IP/URL/UserAgent/Referer é»‘åå•ï¼Œé™æµç­‰ã€‚\n\nç«™å†…åº”ç”¨æ¡ˆä¾‹ï¼š\n","text":"Â¶What åŸºäºNginxå’Œluaçš„é«˜æ€§èƒ½Webå¹³å°ï¼Œå†…éƒ¨é›†æˆäº†å¤§é‡ç²¾è‰¯çš„luaåº“ï¼Œç¬¬ä¸‰æ–¹æ¨¡å—ä»¥åŠå¤§å¤šæ•°ä¾èµ–é¡¹ï¼Œæ–¹ä¾¿æ­å»ºå¤„ç†é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€webåº”ç”¨ã€webæœåŠ¡ï¼ŒåŠ¨æ€ç½‘å…³ã€‚ æ‰©å±•äº†Nginxçš„èƒ½åŠ›ï¼Œå°†Nginxæœ‰æ•ˆçš„å˜æˆäº†ä¸€ä¸ªå¼ºå¤§çš„webåº”ç”¨å¹³å°ï¼Œwebå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨luaè„šæœ¬è°ƒåŠ¨nginxæ”¯æŒçš„å„ç§cä»¥åŠluaæ¨¡å—ã€‚å¿«é€Ÿæ„å»ºå‡ºè¶³ä»¥èƒœä»»c10kä¹ƒè‡³c100kä»¥ä¸Šçš„å•æœºå¹¶å‘è¿æ¥çš„åŠŸæ€§èƒ½webåº”ç”¨ç³»ç»Ÿã€‚ å……åˆ†åˆ©ç”¨äº†Nginxçš„éé˜»å¡çš„I/Oæ¨¡å‹ï¼Œä¸ä»…å¯¹HTTPè¯·æ±‚ï¼Œç”šè‡³å¯¹äºè¿œç¨‹åç«¯è¯¸å¦‚Mysqlã€PostgreSQL,Redisç­‰éƒ½è¿›è¡Œäº†ä¸€è‡´é«˜æ€§èƒ½ç›¸åº”ã€‚ Â¶ä½¿ç”¨åœºæ™¯ ç½‘å…³&amp;webé˜²ç«å¢™ï¼šå¦‚æ•°æ®å‰ç½®æ ¡éªŒï¼Œç¼“å­˜å‰ç½®ï¼Œæ•°æ®è¿‡æ»¤ï¼ŒAPIè¯·æ±‚èšåˆï¼ŒABtest,é™çº§ï¼Œç›‘æ§ç­‰ï¼Œå¯ä»¥è¿›è¡Œ IP/URL/UserAgent/Referer é»‘åå•ï¼Œé™æµç­‰ã€‚ ç«™å†…åº”ç”¨æ¡ˆä¾‹ï¼š å›¾ä¸­golangæ³¨å†Œä¸­å¿ƒæœåŠ¡è´Ÿè´£å°†åå°æäº¤çš„è§„åˆ™ä¿¡æ¯ä»¥æ’ä»¶åŒ–çš„å½¢å¼è¿›è¡Œæ‰“åŒ…å¤„ç†åæäº¤è‡³gatewayç®¡ç†ä¸­å¿ƒï¼ŒgatewayåŠ è½½æ’ä»¶å¤„ç†æµé‡ã€‚ webåº”ç”¨ï¼šä¼šè¿›è¡Œä¸€äº›ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œä¸€èˆ¬æµç¨‹ mysql/redis/httpè·å–æ•°æ®è¿”å›å‰ç«¯ï¼Œå¦‚äº¬ä¸œå•†å“è¯¦æƒ…é¡µã€‚ åˆ©ç”¨OpenRestyå¯¹äºåç«¯çš„è¿œç¨‹å­˜å‚¨å¯ä»¥è¿›è¡Œé«˜æ€§èƒ½ç›¸åº”ï¼Œå¯ä»¥ä»£æ›¿ç±»ä¼¼äºphp-fpmå¯¹åç«¯è¿œç¨‹å­˜å‚¨è®¿é—®ç“¶é¢ˆçš„é™åˆ¶ï¼Œè½¬ä¸ºç”±OpenRestyè¯·æ±‚ï¼Œè·å–ç»“æœåé€šçŸ¥ç»™åº”ç”¨åç«¯æœåŠ¡ã€‚ 12docker pull redis:latestdocker run -p 6379:6379 --name redis -v $PWD/redis.conf:/root/redis/redis.conf -v $PWD/data:/root/redis/data -d redis redis-server 123456789101112131415161718 location /lua &#123; content_by_lua_block &#123; local redis = require &quot;resty.redis&quot; local red = redis:new() red:set_timeout(1000) local ok, err = red:connect(&quot;127.0.0.1&quot;, 6379) if not ok then ngx.say(&quot;failed to connect: &quot;, err) return end ok, err = red:set(&quot;color&quot;, &quot;red&quot;) if not ok then ngx.say(&quot;failed to set dog: &quot;, err) return end ngx.say(red:get(&quot;color&quot;)) &#125;&#125; ç¼“å­˜ï¼šå¯ä»¥å¯¹ç›¸åº”å†…å®¹è¿›è¡Œç¼“å­˜ï¼Œå‡å°‘åç«¯è¯·æ±‚ï¼Œä»¥åŠè§„åˆ™ä¸‹å‘ã€‚ OpenResty æä¾›äº†lruå’Œsharedçº¯å†…å­˜ç¼“å­˜æœåŠ¡ã€‚ 12345678910111213141516lua_shared_dict books 1m;location /book &#123; content_by_lua_block &#123; local cache = ngx.shared.books local len, err = cache:lpush(&quot;foo&quot;, &quot;bar&quot;) if len then ngx.say(&quot;push success&quot;) else ngx.say(&quot;push err: &quot;, err) end cache:set(&quot;lua&quot;, &quot;lua&quot;) ngx.print(cache:get(&quot;lua&quot;)) cache:set(&quot;kind&quot;, require(&quot;cjson&quot;).encode(&#123;php=7&#125;)) ngx.print(require(&quot;cjson&quot;).decode(cache:get(&quot;kind&quot;)).php) &#125;&#125; 12345678910location /lru &#123; content_by_lua_block &#123; local lrucache = require &quot;resty.lrucache&quot; local cache, err = lrucache.new(200) cache:set(&quot;dog&quot;, 32, 0.03) ngx.sleep(0.02) local data, stale_data = cache:get(&quot;dog&quot;) ngx.print(stale_data) &#125;&#125; 123OpenResty -s quit -p `pwd`/ -c conf/nginx.confOpenResty -p `pwd`/ -c conf/nginx.conf","raw":null,"content":null,"categories":[{"name":"OpenResty","slug":"OpenResty","permalink":"http://blog.nicexiangcun.com/categories/OpenResty/"}],"tags":[]},{"title":"æ•°ç»„å’Œé“¾è¡¨","slug":"æ•°ç»„å’Œé“¾è¡¨","date":"2019-12-26T01:34:15.000Z","updated":"2020-11-20T13:06:15.521Z","comments":true,"path":"2019/12/26/æ•°ç»„å’Œé“¾è¡¨/","link":"","permalink":"http://blog.nicexiangcun.com/2019/12/26/%E6%95%B0%E7%BB%84%E5%92%8C%E9%93%BE%E8%A1%A8/","excerpt":"æ•°ç»„çš„ç‰¹ç‚¹æ˜¯åœ¨å†…å­˜ä¸­åœ°å€æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥åœ¨éšæœºè®¿é—®ä¸€ä¸ªæ•°ç»„ä¸­çš„åœ°å€çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1),å¯»å€å…¬å¼å¤§æ¦‚æ˜¯ï¼š\n123456789\tint a[3] = &#123;1,2,3&#125;;a[i]_address = begin_address + i * data_type_sizeint a[3][2] = &#123;&#123;1,2&#125;,&#123;6,7&#125;,&#123;3,5&#125;&#125;;address = begin_address + ( i * n + j) * data_type_size\næ•°ç»„ç”±äºå¯¹å†…å­˜çš„è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼Œå¸¦æ¥çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä½æ•ˆçš„â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€ï¼Œåœ¨åšæ•°æ®çš„æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™è¦é¢‘ç¹çš„è¿›è¡Œæ•°æ®çš„è¿ç§»ã€‚å¯¹äºæ•°ç»„çš„åŠ¨æ€æ‰©å®¹ç­–ç•¥çš„å®ç°å¯ä»¥å‚è€ƒredisçš„å­—ç¬¦ä¸²åº•å±‚å®ç°åŸç†æˆ–è€…javaä¸­çš„arrayList&lt;&gt;.","text":"æ•°ç»„çš„ç‰¹ç‚¹æ˜¯åœ¨å†…å­˜ä¸­åœ°å€æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥åœ¨éšæœºè®¿é—®ä¸€ä¸ªæ•°ç»„ä¸­çš„åœ°å€çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1),å¯»å€å…¬å¼å¤§æ¦‚æ˜¯ï¼š 123456789 int a[3] = &#123;1,2,3&#125;;a[i]_address = begin_address + i * data_type_sizeint a[3][2] = &#123;&#123;1,2&#125;,&#123;6,7&#125;,&#123;3,5&#125;&#125;;address = begin_address + ( i * n + j) * data_type_size æ•°ç»„ç”±äºå¯¹å†…å­˜çš„è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼Œå¸¦æ¥çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä½æ•ˆçš„â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€ï¼Œåœ¨åšæ•°æ®çš„æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™è¦é¢‘ç¹çš„è¿›è¡Œæ•°æ®çš„è¿ç§»ã€‚å¯¹äºæ•°ç»„çš„åŠ¨æ€æ‰©å®¹ç­–ç•¥çš„å®ç°å¯ä»¥å‚è€ƒredisçš„å­—ç¬¦ä¸²åº•å±‚å®ç°åŸç†æˆ–è€…javaä¸­çš„arrayList&lt;&gt;. ä½¿ç”¨åœºæ™¯æ³¨æ„ï¼š æ“ä½œçš„æ•°æ®ä¸å®œè¿‡å¤§ã€‚ é“¾è¡¨çš„åˆ†ç±»ï¼š å•é“¾è¡¨ï¼š åç»§æŒ‡é’ˆæŒ‡nextå‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„heacï¼ˆèŠ‚ç‚¹åŒ…å«å¤´éƒ¨ï¼Œæ•°æ®dataå’ŒæŒ‡é’ˆnextï¼‰ åŒå‘é“¾è¡¨ï¼š åç»§æŒ‡é’ˆnextæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„prev (èŠ‚ç‚¹åŒ…æ‹¬å‰é©±æŒ‡é’ˆprev,æ•°æ®data,åç»§æŒ‡é’ˆnext) å¾ªç¯é“¾è¡¨ï¼š å°¾ç»“ç‚¹æŒ‡é’ˆæŒ‡å‘å¤´èŠ‚ç‚¹ é“¾è¡¨å°±æ˜¯ç”¨æŒ‡é’ˆå°†èŠ‚ç‚¹è¿æ¥èµ·æ¥ï¼Œå®ƒå¯¹å†…å­˜çš„è¦æ±‚æ²¡æœ‰æ•°ç»„é‚£ä¹ˆè‹›åˆ»ï¼Œæ‰€ä»¥é“¾è¡¨åœ¨â€œæ’å…¥â€å’Œâ€œåˆ é™¤â€çš„åŠ¨ä½œä¸Šçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1),ä½†æ˜¯ç”±äºé“¾è¡¨å†…å­˜ä¸æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ä¸èƒ½éšæœºè®¿é—®æŸä¸ªå…ƒç´ ï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ã€‚ å•é“¾è¡¨çš„ä½¿ç”¨ç»å…¸æ¡ˆä¾‹å¦‚ï¼šLRUç¼“å­˜æ·˜æ±°ç­–ç•¥ åŒå‘é“¾è¡¨ï¼šjavaä¸­çš„LinkedHashMapå®ç°ï¼ŒåŒå‘é“¾è¡¨æ¯”å•é“¾è¡¨ä¼šå ç”¨æ›´å¤šçš„å†…å­˜ï¼Œä½†æ˜¯åœ¨æŸ¥æ‰¾å…ƒç´ çš„é€Ÿåº¦ä¸Šä¼šæ¯”å•é“¾è¡¨æ€§èƒ½æ›´é«˜ï¼Œå› ä¸ºåŒå‘é“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šæ—¢æœ‰å‰é©±æŒ‡é’ˆï¼Œåˆæœ‰åç»§æŒ‡é’ˆï¼Œå½“æˆ‘ä»¬çŸ¥é“å…·ä½“æŸä¸€ä¸ªnodeçš„æ—¶å€™é‚£ä¹ˆå®ƒçš„å‰é©±å’Œåç»§æŒ‡é’ˆæˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œæ‰€ä»¥å®ƒåœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­å¯ä»¥åˆ¤æ–­æ˜¯å¿˜å‰èµ°è¿˜æ˜¯å¾€åèµ°ï¼Œä½“ç°äº†ç”¨ç©ºé—´æ¢æ—¶é—´çš„è®¾è®¡æ€æƒ³ã€‚ é“¾è¡¨çš„å¦ä¸€ç§ä½¿ç”¨åœºæ™¯ç»å¸¸ä¼šé…åˆæ•£åˆ—è¡¨ä½¿ç”¨ï¼Œé…åˆhashtableä½¿ç”¨çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†è§£å†³é“¾è¡¨åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­æ—¶é—´å¤æ‚åº¦O(N)çš„é—®é¢˜ã€‚åšæ³•æ˜¯å°†å•é“¾è¡¨æˆ–è€…åŒé“¾è¡¨ä¸­çš„èŠ‚ç‚¹é€šè¿‡hashå‡½æ•°æ•£åˆ—åˆ°æ•°ç»„çš„æ§½(æ¡¶)ä¸Šï¼Œç”¨ä¸€ä¸ªæ–°çš„æŒ‡é’ˆé€šè¿‡æ‹‰é“¾çš„æ–¹å¼å°†å†²çªçš„èŠ‚ç‚¹è¿æ¥ä¸Šã€‚è¿™æ ·åœ¨æŸ¥æ‰¾æŸä¸€ä¸ªnodeçš„æ—¶å€™ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯æ¥è¿‘O(1)çš„ã€‚","raw":null,"content":null,"categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://blog.nicexiangcun.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[]},{"title":"linuxä¸­å†…å­˜å­—èŠ‚å¯¹é½","slug":"å†…å­˜å­—èŠ‚å¯¹é½","date":"2019-12-25T13:34:15.000Z","updated":"2020-11-20T13:06:15.520Z","comments":true,"path":"2019/12/25/å†…å­˜å­—èŠ‚å¯¹é½/","link":"","permalink":"http://blog.nicexiangcun.com/2019/12/25/%E5%86%85%E5%AD%98%E5%AD%97%E8%8A%82%E5%AF%B9%E9%BD%90/","excerpt":"ğŸ’ linuxä¸‹é»˜è®¤å­—èŠ‚å¯¹é½æ˜¯ä»¥intç±»å‹å˜é‡æ‰€å å­—èŠ‚æ•°å¯¹é½ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šç”³è¯·è¢«4æ•´é™¤çš„å†…å­˜åœ°å€å†™å…¥intç±»å‹ï¼Œæ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬æ¯æ¬¡çœ‹intç±»å‹çš„åœ°å€ä¸ä¼šçœ‹åˆ°æœ‰å¥‡æ•°çš„ã€‚\nÂ¶ä»€ä¹ˆå«å¯¹é½\nè®¡ç®—æœºä¸­å†…å­˜ç©ºé—´éƒ½æ˜¯æŒ‰ç…§byteåˆ’åˆ†çš„ï¼Œä»ç†è®ºä¸Šè®²ä¼¼ä¹å¯¹ä»»ä½•ç±»å‹çš„å˜é‡çš„è®¿é—®å¯ä»¥ä»ä»»ä½•åœ°å€å¼€å§‹ï¼Œä½†å®é™…æƒ…å†µæ˜¯åœ¨è®¿é—®ç‰¹å®šç±»å‹å˜é‡çš„æ—¶å€™ç»å¸¸åœ¨ç‰¹ å®šçš„å†…å­˜åœ°å€è®¿é—®ï¼Œè¿™å°±éœ€è¦å„ç§ç±»å‹æ•°æ®æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åœ¨ç©ºé—´ä¸Šæ’åˆ—ï¼Œè€Œä¸æ˜¯é¡ºåºçš„ä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ’æ”¾ï¼Œè¿™å°±æ˜¯å¯¹é½ã€‚\nÂ¶ä¸ºä»€ä¹ˆè¦è¿›è¡Œå¯¹é½\nå„ä¸ªç¡¬ä»¶å¹³å°å¯¹å­˜å‚¨ç©ºé—´çš„å¤„ç†ä¸Šæœ‰å¾ˆå¤§çš„ä¸åŒã€‚ä¸€äº›å¹³å°å¯¹æŸäº›ç‰¹å®šç±»å‹çš„æ•°æ®åªèƒ½ä»æŸäº›ç‰¹å®šåœ°å€å¼€å§‹å­˜å–ã€‚æ¯”å¦‚æœ‰äº›æ¶æ„çš„CPUåœ¨è®¿é—®ä¸€ä¸ªæ²¡æœ‰è¿›è¡Œå¯¹é½çš„å˜é‡çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯,é‚£ä¹ˆåœ¨è¿™ç§æ¶æ„ä¸‹ç¼–ç¨‹å¿…é¡»ä¿è¯å­—èŠ‚å¯¹é½.å…¶ä»–å¹³å°å¯èƒ½æ²¡æœ‰è¿™ç§æƒ…å†µï¼Œä½†æ˜¯æœ€å¸¸è§çš„æ˜¯å¦‚æœä¸æŒ‰ç…§é€‚åˆå…¶å¹³å°è¦æ±‚å¯¹ æ•°æ®å­˜æ”¾è¿›è¡Œå¯¹é½ï¼Œä¼šåœ¨å­˜å–æ•ˆç‡ä¸Šå¸¦æ¥æŸå¤±ã€‚æ¯”å¦‚æœ‰äº›å¹³å°æ¯æ¬¡è¯»éƒ½æ˜¯ä»å¶åœ°å€å¼€å§‹ï¼Œå¦‚æœä¸€ä¸ªintå‹ï¼ˆå‡è®¾ä¸º32ä½ç³»ç»Ÿï¼‰å¦‚æœå­˜æ”¾åœ¨å¶åœ°å€å¼€å§‹çš„åœ°æ–¹ï¼Œé‚£ä¹ˆä¸€ä¸ªè¯»å‘¨æœŸå°±å¯ä»¥è¯»å‡ºè¿™32bitï¼Œè€Œå¦‚æœå­˜æ”¾åœ¨å¥‡åœ°å€å¼€å§‹çš„åœ°æ–¹ï¼Œå°±éœ€è¦2ä¸ªè¯»å‘¨æœŸï¼Œå¹¶å¯¹ä¸¤æ¬¡è¯»å‡ºçš„ç»“æœçš„é«˜ä½å­—èŠ‚è¿›è¡Œæ‹¼å‡‘æ‰èƒ½å¾—åˆ°è¯¥32bitæ•°æ®ï¼ˆlinuxä¸­ï¼šåœ¨å†…å­˜ä¸­æ˜¯ä½ä½åœ¨å…ˆï¼Œé«˜ä½åœ¨åï¼‰ã€‚æ˜¾ç„¶åœ¨è¯»å–æ•ˆç‡ä¸Šä¸‹é™å¾ˆå¤šã€‚\nä¾‹1ç¨‹åºåˆ†é…çš„å†…å­˜åœ°å€å¦‚ä¸‹å›¾ï¼š","text":"ğŸ’ linuxä¸‹é»˜è®¤å­—èŠ‚å¯¹é½æ˜¯ä»¥intç±»å‹å˜é‡æ‰€å å­—èŠ‚æ•°å¯¹é½ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šç”³è¯·è¢«4æ•´é™¤çš„å†…å­˜åœ°å€å†™å…¥intç±»å‹ï¼Œæ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬æ¯æ¬¡çœ‹intç±»å‹çš„åœ°å€ä¸ä¼šçœ‹åˆ°æœ‰å¥‡æ•°çš„ã€‚ Â¶ä»€ä¹ˆå«å¯¹é½ è®¡ç®—æœºä¸­å†…å­˜ç©ºé—´éƒ½æ˜¯æŒ‰ç…§byteåˆ’åˆ†çš„ï¼Œä»ç†è®ºä¸Šè®²ä¼¼ä¹å¯¹ä»»ä½•ç±»å‹çš„å˜é‡çš„è®¿é—®å¯ä»¥ä»ä»»ä½•åœ°å€å¼€å§‹ï¼Œä½†å®é™…æƒ…å†µæ˜¯åœ¨è®¿é—®ç‰¹å®šç±»å‹å˜é‡çš„æ—¶å€™ç»å¸¸åœ¨ç‰¹ å®šçš„å†…å­˜åœ°å€è®¿é—®ï¼Œè¿™å°±éœ€è¦å„ç§ç±»å‹æ•°æ®æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åœ¨ç©ºé—´ä¸Šæ’åˆ—ï¼Œè€Œä¸æ˜¯é¡ºåºçš„ä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ’æ”¾ï¼Œè¿™å°±æ˜¯å¯¹é½ã€‚ Â¶ä¸ºä»€ä¹ˆè¦è¿›è¡Œå¯¹é½ å„ä¸ªç¡¬ä»¶å¹³å°å¯¹å­˜å‚¨ç©ºé—´çš„å¤„ç†ä¸Šæœ‰å¾ˆå¤§çš„ä¸åŒã€‚ä¸€äº›å¹³å°å¯¹æŸäº›ç‰¹å®šç±»å‹çš„æ•°æ®åªèƒ½ä»æŸäº›ç‰¹å®šåœ°å€å¼€å§‹å­˜å–ã€‚æ¯”å¦‚æœ‰äº›æ¶æ„çš„CPUåœ¨è®¿é—®ä¸€ä¸ªæ²¡æœ‰è¿›è¡Œå¯¹é½çš„å˜é‡çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯,é‚£ä¹ˆåœ¨è¿™ç§æ¶æ„ä¸‹ç¼–ç¨‹å¿…é¡»ä¿è¯å­—èŠ‚å¯¹é½.å…¶ä»–å¹³å°å¯èƒ½æ²¡æœ‰è¿™ç§æƒ…å†µï¼Œä½†æ˜¯æœ€å¸¸è§çš„æ˜¯å¦‚æœä¸æŒ‰ç…§é€‚åˆå…¶å¹³å°è¦æ±‚å¯¹ æ•°æ®å­˜æ”¾è¿›è¡Œå¯¹é½ï¼Œä¼šåœ¨å­˜å–æ•ˆç‡ä¸Šå¸¦æ¥æŸå¤±ã€‚æ¯”å¦‚æœ‰äº›å¹³å°æ¯æ¬¡è¯»éƒ½æ˜¯ä»å¶åœ°å€å¼€å§‹ï¼Œå¦‚æœä¸€ä¸ªintå‹ï¼ˆå‡è®¾ä¸º32ä½ç³»ç»Ÿï¼‰å¦‚æœå­˜æ”¾åœ¨å¶åœ°å€å¼€å§‹çš„åœ°æ–¹ï¼Œé‚£ä¹ˆä¸€ä¸ªè¯»å‘¨æœŸå°±å¯ä»¥è¯»å‡ºè¿™32bitï¼Œè€Œå¦‚æœå­˜æ”¾åœ¨å¥‡åœ°å€å¼€å§‹çš„åœ°æ–¹ï¼Œå°±éœ€è¦2ä¸ªè¯»å‘¨æœŸï¼Œå¹¶å¯¹ä¸¤æ¬¡è¯»å‡ºçš„ç»“æœçš„é«˜ä½å­—èŠ‚è¿›è¡Œæ‹¼å‡‘æ‰èƒ½å¾—åˆ°è¯¥32bitæ•°æ®ï¼ˆlinuxä¸­ï¼šåœ¨å†…å­˜ä¸­æ˜¯ä½ä½åœ¨å…ˆï¼Œé«˜ä½åœ¨åï¼‰ã€‚æ˜¾ç„¶åœ¨è¯»å–æ•ˆç‡ä¸Šä¸‹é™å¾ˆå¤šã€‚ ä¾‹1ç¨‹åºåˆ†é…çš„å†…å­˜åœ°å€å¦‚ä¸‹å›¾ï¼š 12345678910#include&lt;stdio.h&gt; int main()&#123; double a = 9.99; char b = &#x27;1&#x27;; int c = 1; printf(&quot;%p,sizeof(a):%lu\\n&quot;,&amp;a,sizeof(a)); printf(&quot;%p,sizeof(b):%lu\\n&quot;,&amp;b,sizeof(b)); printf(&quot;%p,sizeof(c):%lu\\n&quot;,&amp;c,sizeof(c)); &#125; ä¾‹2ç¨‹åºåˆ†é…çš„å†…å­˜åœ°å€å¦‚ä¸‹å›¾ï¼š 1234567891011#include&lt;stdio.h&gt;int main()&#123; char a = &#x27;1&#x27;; double b = 9.99; char c = &#x27;1&#x27;; int d = 1; printf(&quot;%p,sizeof(a):%lu\\n&quot;,&amp;a,sizeof(a)); printf(&quot;%p,sizeof(b):%lu\\n&quot;,&amp;b,sizeof(b)); printf(&quot;%p,sizeof(c):%lu\\n&quot;,&amp;c,sizeof(c)); printf(&quot;%p,sizeof(d):%lu\\n&quot;,&amp;d,sizeof(d));&#125;","raw":null,"content":null,"categories":[{"name":"linux","slug":"linux","permalink":"http://blog.nicexiangcun.com/categories/linux/"}],"tags":[]},{"title":"ä»£ç æ•´æ´ä¹‹é“ä¹‹æŠ€å·§æ€»ç»“","slug":"code-summarize","date":"2019-11-30T14:48:12.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2019/11/30/code-summarize/","link":"","permalink":"http://blog.nicexiangcun.com/2019/11/30/code-summarize/","excerpt":"\nä¼˜é›…çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„\n\nèƒ½å¤Ÿæ»¡è¶³å½“å‰çš„éœ€æ±‚ï¼ˆåŠŸèƒ½ï¼Œç¨³å®šæ€§ï¼Œè´Ÿè½½èƒ½åŠ›ç­‰ï¼‰ã€‚\nå¯¹æœªæ¥çš„éœ€æ±‚ï¼Œèƒ½å¤Ÿå¿«é€Ÿçš„æ‰©å±•ï¼Œä¿®æ”¹ã€‚\nå‡ºç°é—®é¢˜èƒ½å¤Ÿå¿«é€Ÿçš„å®šä½é—®é¢˜æ–¹ä¾¿ä¿®æ”¹é—®é¢˜ã€‚\nå°½é‡é¿å…é‡å¤ï¼Œæœ€å¤§ç¨‹åº¦å¤ç”¨ã€‚\n\né’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œæ•´ç†å‡ºä¸€äº›è‡ªå·±å¯¹äºè®¾è®¡æ¨¡å¼çš„ç†è§£ï¼Œå…¶å®è®¾è®¡æ¨¡å¼å°±æ˜¯åˆ«äººèµ°è¿‡çš„è·¯ï¼Œè¸©è¿‡çš„å‘ï¼Œæ€»ç»“å‡ºæ¥çš„ä¼˜ç§€ç»éªŒã€‚æ€»ç»“çš„ä»£ç æ•´æ´ä¹‹é“å°±æ˜¯å¦‚ä½•å¤ç”¨è¿™äº›ç»éªŒã€‚\nä¸‹é¢æ˜¯ä»£ç æ•´æ´ä¹‹é“ç¬¬ä¸€ç¯‡ï¼šæŠ€å·§æ€»ç»“ ğŸ™","text":"ä¼˜é›…çš„ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ èƒ½å¤Ÿæ»¡è¶³å½“å‰çš„éœ€æ±‚ï¼ˆåŠŸèƒ½ï¼Œç¨³å®šæ€§ï¼Œè´Ÿè½½èƒ½åŠ›ç­‰ï¼‰ã€‚ å¯¹æœªæ¥çš„éœ€æ±‚ï¼Œèƒ½å¤Ÿå¿«é€Ÿçš„æ‰©å±•ï¼Œä¿®æ”¹ã€‚ å‡ºç°é—®é¢˜èƒ½å¤Ÿå¿«é€Ÿçš„å®šä½é—®é¢˜æ–¹ä¾¿ä¿®æ”¹é—®é¢˜ã€‚ å°½é‡é¿å…é‡å¤ï¼Œæœ€å¤§ç¨‹åº¦å¤ç”¨ã€‚ é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œæ•´ç†å‡ºä¸€äº›è‡ªå·±å¯¹äºè®¾è®¡æ¨¡å¼çš„ç†è§£ï¼Œå…¶å®è®¾è®¡æ¨¡å¼å°±æ˜¯åˆ«äººèµ°è¿‡çš„è·¯ï¼Œè¸©è¿‡çš„å‘ï¼Œæ€»ç»“å‡ºæ¥çš„ä¼˜ç§€ç»éªŒã€‚æ€»ç»“çš„ä»£ç æ•´æ´ä¹‹é“å°±æ˜¯å¦‚ä½•å¤ç”¨è¿™äº›ç»éªŒã€‚ ä¸‹é¢æ˜¯ä»£ç æ•´æ´ä¹‹é“ç¬¬ä¸€ç¯‡ï¼šæŠ€å·§æ€»ç»“ ğŸ™ 1.å‘½åéå¸¸é‡è¦ï¼Œå°±ä¸ºäº†å¯è¯»æ€§æ›´å¥½ã€‚ 2.é€‚å½“çš„ä½¿ç”¨æ³¨é‡Šï¼Œå¼€å‘æ–°åŠŸèƒ½ï¼Œä¿®æ”¹åˆ«äººçš„bug,å…³é”®ä¸šåŠ¡é€»è¾‘ï¼Œè¦åˆç†çš„ä½¿ç”¨æ³¨é‡Š 3.å˜é‡éœ€è¦åˆå§‹åŒ– 4.1==$a å’Œå¸¸é‡æ¯”è¾ƒå¸¸é‡åœ¨å‰,é˜²å¾¡ç¼–ç¨‹ï¼Œé¿å…è¯¯å†™å‡º$a=1 5.é˜²å¾¡å¼ç¼–ç¨‹å’Œå¥‘çº¦ç¼–ç¨‹ é»˜è®¤ä¸ä¿¡ä»»ä»»ä½•å¤–éƒ¨è°ƒç”¨å’Œæ–¹æ³•ï¼Œé»˜è®¤åŒæ–¹éµå®ˆå¥‘çº¦ï¼Œä»»æ„ä¸€æ–¹æ’•æ¯å¥‘çº¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå»ºè®®åœ¨UIåŠåº”ç”¨å±‚å€¾å‘äºé˜²å¾¡å¼ç¼–ç¨‹ä¿è¯å‹å¥½åŠä½“éªŒï¼Œåœ¨é€»è¾‘å±‚å€¾å‘äºå¥‘çº¦å¼ç¼–ç¨‹å°½æ—©æš´éœ²éšæ‚£ 6.å¯æ§çš„ç¯å¢ƒå‚æ•° ğŸ› ä»£ç ä¸å—ç¯å¢ƒçš„å½±å“ï¼Œå„ç§é­”æœ¯å¸¸äº®ï¼Œå£°æ˜å­—ç¬¦é›†ï¼Œå®šä¹‰åŒ…å«çš„ç»å¯¹è·¯å¾„ï¼Œé”™è¯¯çº§åˆ«7ï¼Œè‡ªå·±å¼€å‘çš„æµ‹è¯•ï¼Œå‡†ç”Ÿäº§ï¼Œç”Ÿäº§ç¯å¢ƒåˆ‡å¥½ç­‰ ğŸ•·ï¸ 7.PHPç»“æŸæ ‡è®° çº¯phpè¯­å¥ä¸è¦ç»“æŸæ ‡è®° 8.ifçš„ä½¿ç”¨æŠ€å·§ä¹‹â€œç»™å®šåˆå§‹å€¼â€ 9.ifçš„ä½¿ç”¨æŠ€å·§ä¹‹â€œç”¨&quot;&amp;&amp;&quot; æ›¿æ¢ ifâ€ 1234567if($rand&gt;3)&#123; $long=5;&#125;$rand&gt;3 &amp;&amp; $long=5; 10.ifçš„ä½¿ç”¨æŠ€å·§ä¹‹â€œç”¨ä¸‰å…ƒè¿ç®—ç¬¦æ›¿æ¢ifâ€ 11.ifçš„ä½¿ç”¨æŠ€å·§ä¹‹â€œå»æ‰å¤šæ­¤ä¸€ä¸¾çš„ifâ€ 123456789if(1==$a)&#123; return true;&#125;else&#123; return false;&#125;return (1==$a); 12.è¡¨é©±åŠ¨æ³• map åœ¨phpä¸­æ•°ç»„ä½¿ç”¨çš„æ˜¯hashtableï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(1),è¿è¡Œé€Ÿåº¦è¿œè¿œé«˜äºä»¥ä¸Šä¸¤ç§ï¼Œå¦å¤–ä¹¦å†™èµ·æ¥ä¹Ÿæ›´ç®€ä¾¿çš„å¤šã€‚å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯å¼€å§‹æœªå®šä¹‰çš„ä¹Ÿä¸ä¼šè¿è¡ŒæŸ¥æ‰¾æµªè´¹å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚ 13.ä½¿ç”¨æ›´ç²¾æ‚çŸ­å°çš„ä»£ç  å‡½æ•°çš„æœ€ä½³æœ€å¤§é•¿åº¦æ˜¯150è¡Œä»£ç ï¼Œè¿™æ ·çš„ä»£ç æ¯”è¾ƒä¾¿äºç»´æŠ¤ï¼Œä¹Ÿæ–¹ä¾¿ä¿®æ”¹ï¼Œå¯¹äºæŸäº›è¿‡äºé›†ä¸­çš„ç®—æ³•å‡½æ•°ï¼Œå¯èƒ½é•¿åº¦ä¼šå¤§äºè¿™ä¸ªé•¿åº¦ã€‚ä¸è¿‡å°½é‡è¿˜æ˜¯ä¸è¦è¶…è¿‡ï¼ŒçŸ­å°çš„æ‰æ˜¯ç¾å¥½çš„ï¼ŒçŸ­å°çš„ä¾¿äºç†è§£ä¹Ÿä¾¿äºä¿®æ”¹ï¼Œè€ŒåŠŸèƒ½ç›¸å¯¹å•ä¸€çš„ä»£ç ä¹Ÿå°±æ„å‘³ç€å¯ä»¥å¤ç”¨å®ƒçš„åœ°æ–¹ä¼šæ›´å¤šï¼Œæœ‰æ›´å¥½çš„å¤ç”¨æ€§ï¼Œå¦å¤–å½“ç¨‹åºå‡ºé—®é¢˜çš„æ—¶å€™ï¼Œæµ‹è¯•èµ·æ¥ä¹Ÿä¼šç›¸å¯¹ç®€å•å¥½å®šä½ï¼Œä¾¿äºç»´æŠ¤ä¿®æ”¹ã€‚ 14.é¿å…ä½¿ç”¨å¹»æ•° ,å¹»æ•°ï¼Œç®€å•æ¥è¯´æ—¢æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ç¡¬ç¼–ç . 15.ä¸­é—´ç»“æœèµ‹å€¼ç»™å˜é‡ å½“ä¸€ä¸ªè¡¨è¾¾å¼ä¸­åµŒå¥—å±‚æ•°è¿‡å¤šï¼Œé€»è¾‘è¿‡äºå¤æ‚çš„æ—¶å€™ï¼Œå°†å…¶æ‹†åˆ†æˆä¸€å—å—çš„ï¼Œå°†å…¶æ¯ä¸€å—çš„ç»“æœèµ‹å€¼ç»™ä¸­é—´å˜é‡ï¼Œè¿™æ ·å¯ä»¥é™ä½ç¨‹åºçš„é˜…è¯»éš¾åº¦å’Œæé«˜å¯ç»´æŠ¤æ€§ã€‚ 16.å¤æ‚çš„é€»è¾‘è¡¨è¾¾å¼åšæˆå¸ƒå°”å‡½æ•° å½“æŸä¸€ä¸ªåˆ¤æ–­æ¯”è¾ƒå¤æ‚çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘å°†å…¶åšæˆä¸€ä¸ªå¸ƒå°”å‡½æ•°ï¼Œä¸è¦æ€•è¿™ä¸ªå‡½æ•°é‡Œé¢çš„ä»£ç å°‘ï¼Œå¾ˆå¤šæ—¶å€™è¿™æ ·å†™å¯ä»¥ä½¿ä½ çš„é€»è¾‘æ›´å®¹æ˜“ç»´æŠ¤ï¼Œå¦å¤–ç¢°åˆ°ç›¸åŒé€»è¾‘åˆ¤å®šçš„åœ°ç‚¹è¿˜å¯ä»¥ç›´æ¥å¤ç”¨ï¼Œä¸éœ€è¦ä¸€å¤„ä¿®æ”¹å¤„å¤„ä¿®æ”¹ã€‚ 17.æ°¸è¿œä¸è¦å¤åˆ¶ç²˜è´´é›·åŒçš„ä»£ç  å¤§æ®µç›¸åŒçš„ä»£ç å®ç°ç±»ä¼¼çš„ä½†æ˜¯ç•¥æœ‰ä¸åŒçš„ç¨‹åºåŠŸèƒ½çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å›è¿›è¡Œå¤åˆ¶å®Œåä¿®æ”¹ï¼Œå…¶å®è¿™ç§åšæ³•ä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜. 18.å¤‡ä»½æºä»£ç æ–‡ä»¶","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"ä»£ç æ•´æ´ä¹‹é“ä¹‹å¯¹è±¡é—´çš„å‘å¸ƒè®¢é˜…","slug":"code-summarize-three","date":"2019-11-30T14:19:37.000Z","updated":"2020-11-20T13:06:15.510Z","comments":true,"path":"2019/11/30/code-summarize-three/","link":"","permalink":"http://blog.nicexiangcun.com/2019/11/30/code-summarize-three/","excerpt":"å®ç°laravelä¸­ Observeræ¨¡å¼ä¸‰ç§æ–¹å¼ï¼š\n\næ¡†æ¶æœ¬åœ°çš„Eventsäº‹ä»¶æœºåˆ¶\nPHPå®šä¹‰äº†ä¸¤ä¸ªæ¥å£ï¼šSplObserverå’ŒSplSubject\nè‡ªå®šä¹‰Observer å’Œ Subject\n\nä¸ç®¡é‡‡ç”¨å“ªç§æ–¹å¼å…¶ç›®çš„æ˜¯ï¼šå¯¹è±¡æ›´æ”¹å…¶çŠ¶æ€æ—¶ï¼Œå°†é€šçŸ¥é™„åŠ çš„â€œè§‚å¯Ÿè€…â€ã€‚å®ƒç”¨äºç¼©çŸ­è€¦åˆå¯¹è±¡çš„æ•°é‡ï¼Œå¹¶ä½¿ç”¨æ¾è€¦åˆã€‚\nä¸¾ä¸ªç¼“å­˜ä¾èµ–ä¾‹å­ï¼šğŸ¶","text":"å®ç°laravelä¸­ Observeræ¨¡å¼ä¸‰ç§æ–¹å¼ï¼š æ¡†æ¶æœ¬åœ°çš„Eventsäº‹ä»¶æœºåˆ¶ PHPå®šä¹‰äº†ä¸¤ä¸ªæ¥å£ï¼šSplObserverå’ŒSplSubject è‡ªå®šä¹‰Observer å’Œ Subject ä¸ç®¡é‡‡ç”¨å“ªç§æ–¹å¼å…¶ç›®çš„æ˜¯ï¼šå¯¹è±¡æ›´æ”¹å…¶çŠ¶æ€æ—¶ï¼Œå°†é€šçŸ¥é™„åŠ çš„â€œè§‚å¯Ÿè€…â€ã€‚å®ƒç”¨äºç¼©çŸ­è€¦åˆå¯¹è±¡çš„æ•°é‡ï¼Œå¹¶ä½¿ç”¨æ¾è€¦åˆã€‚ ä¸¾ä¸ªç¼“å­˜ä¾èµ–ä¾‹å­ï¼šğŸ¶ 12345678910111213//å¦‚æœæ•°æ®æºå‘ç”Ÿå˜åŒ–æ ¹æ®cacheTypeæ¸…ç©ºä¸åŒæ•°æ®ç¼“å­˜class CacheRepository implements Cache &#123; protected $catenation; public function __construct($db) &#123; $this-&gt;catenation = $db; &#125; public function cacheClear($cacheType) &#123; // &#125;&#125; 123456789101112131415161718//mem è§‚å¯Ÿå‘˜class MemcacheObserver implements \\SplObserver&#123; public function update(Cache $cache) &#123; $cache-&gt;clean(&#x27;mem&#x27;); &#125; /** * @return List[] */ public function getArticles(): array &#123; return $this-&gt;getArticles; &#125;&#125; 12345678910//mon è§‚å¯Ÿå‘˜class MongodbObserver implements \\SplObserver&#123; public function update(Cache $cache) &#123; $cache-&gt;clean(&#x27;mon&#x27;); &#125;&#125; 123456789101112131415161718192021222324252627282930313233//ç¼“å­˜å¯¹è±¡class CacheSubject implements \\SplSubject&#123; /** * @var \\SplObjectStorage */ private $observers; public function __construct() &#123; $this-&gt;observers = new \\SplObjectStorage(); &#125; public function attach(\\SplObserver $observer) &#123; $this-&gt;observers-&gt;attach($observer); &#125; public function detach(\\SplObserver $observer) &#123; $this-&gt;observers-&gt;detach($observer); &#125; public function notify(Cache $cache) &#123; /** @var \\SplObserver $observer */ foreach ($this-&gt;observers as $observer) &#123; $observer-&gt;update($cache); &#125; &#125;&#125; 12345678910111213141516171819202122232425//æ›´æ–°æ•°æ®æºclass ArticleController &#123; private $memcache; private $mongodb; private $cacheSub; public function __construct(CacheSubject $cacheSub ) &#123; $this-&gt;cacheSub = $cacheSub; &#125; public function postUpdate($id) &#123; //æ·»åŠ è®¢é˜…å¯¹è±¡ï¼Œæ­¤å¤„æ˜¯ä¸»åŠ¨æ·»åŠ è§‚å¯Ÿè€…ï¼Œç†æƒ³çŠ¶æ€åº”è¯¥æ˜¯è§‚å¯Ÿè€…ä¸»åŠ¨æ¥è®¢é˜…ï¼Œåšæˆäº‹ä»¶é…ç½®ï¼Œnotifyå»è¯»å–é…ç½® $this-&gt;cacheSub-&gt;attach(MemcacheObserver $this-&gt;memcache); $this-&gt;cacheSub-&gt;attach(MongodbObserver $this-&gt;mongodb); //æ›´æ–°æ•°æ®æº self::update([&#x27;id&#x27;=&gt;$id]); //é€šçŸ¥è®¢é˜…è€… $this-&gt;cacheSub-&gt;notify(Cache $cache); &#125;&#125;","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"How do you understand yield in php","slug":"yield","date":"2019-11-30T13:43:35.000Z","updated":"2020-11-20T13:06:15.520Z","comments":true,"path":"2019/11/30/yield/","link":"","permalink":"http://blog.nicexiangcun.com/2019/11/30/yield/","excerpt":"yield è¿­ä»£å™¨ åç¨‹  ğŸ’¤\næˆ‘ä»¬çŸ¥é“cpuæ˜¯æŒ‰ç…§æ—¶é—´ç‰‡æ®µæ‰§è¡Œçš„ç¨‹åºçš„ï¼Œphpä¸­å½“çº¿ç¨‹é‡åˆ°yieldçš„æ—¶å€™ï¼Œå¯ä»¥è®©å‡ºcpuå»æ‰§è¡Œå¦å¤–ä¸€æ®µç¨‹åºï¼Œæ˜¯è¡¨ç¤ºåç¨‹æœ€åˆå§‹çš„ä¸€ç§å½¢æ€ã€‚çœŸæ­£æ„ä¹‰ä¸Šçš„åç¨‹è¦å¤æ‚çš„å¤šï¼Œæ¯”å¦‚é€šå¸¸ä¼šåœ¨å½±å“æ€§èƒ½çš„ç½‘ç»œioç¯èŠ‚å®ç°åç¨‹å¤„ç†ï¼Œæ˜¯åº”ç”¨ç¨‹åºåœ¨å¤„ç†ç½‘ç»œioçš„æ—¶å€™è®©å‡ºcpuå»å¤„ç†å…¶ä»–äº‹æƒ…ã€‚\nÂ¶ä»ç³»ç»Ÿå†…å­˜ç­‰èµ„æºå¼€é”€è§’åº¦è€ƒè™‘å…¶ä½¿ç”¨åœºæ™¯\nå¤§æ–‡ä»¶è¯»å–ï¼Œä¸€æ¬¡æ€§å–å‡ºå¤§çš„æ•°æ®é›† ğŸŒ±\nyield çš„ä¼˜åŠ¿åœ¨äºæ¯æ¬¡è¿­ä»£åªæ˜¯åˆ°å½“å‰çš„yieldå°±è¿”å›äº†ï¼Œä¸‹æ¬¡è¿­ä»£åœ¨ä»å®ƒè®°å½•çš„ä½ç½®åœ¨å¾€ä¸‹æ‰§è¡Œã€‚ä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„ç³»ç»Ÿèµ„æºã€‚å› ä¸ºåç¨‹æ˜¯ç¨‹åºä¹‹é—´ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ï¼Œè¦æ¯”çº¿ç¨‹ä¹‹é—´åˆ‡æ¢å¸¦æ¥ç³»ç»Ÿå¼€é”€å°ã€‚","text":"yield è¿­ä»£å™¨ åç¨‹ ğŸ’¤ æˆ‘ä»¬çŸ¥é“cpuæ˜¯æŒ‰ç…§æ—¶é—´ç‰‡æ®µæ‰§è¡Œçš„ç¨‹åºçš„ï¼Œphpä¸­å½“çº¿ç¨‹é‡åˆ°yieldçš„æ—¶å€™ï¼Œå¯ä»¥è®©å‡ºcpuå»æ‰§è¡Œå¦å¤–ä¸€æ®µç¨‹åºï¼Œæ˜¯è¡¨ç¤ºåç¨‹æœ€åˆå§‹çš„ä¸€ç§å½¢æ€ã€‚çœŸæ­£æ„ä¹‰ä¸Šçš„åç¨‹è¦å¤æ‚çš„å¤šï¼Œæ¯”å¦‚é€šå¸¸ä¼šåœ¨å½±å“æ€§èƒ½çš„ç½‘ç»œioç¯èŠ‚å®ç°åç¨‹å¤„ç†ï¼Œæ˜¯åº”ç”¨ç¨‹åºåœ¨å¤„ç†ç½‘ç»œioçš„æ—¶å€™è®©å‡ºcpuå»å¤„ç†å…¶ä»–äº‹æƒ…ã€‚ Â¶ä»ç³»ç»Ÿå†…å­˜ç­‰èµ„æºå¼€é”€è§’åº¦è€ƒè™‘å…¶ä½¿ç”¨åœºæ™¯ å¤§æ–‡ä»¶è¯»å–ï¼Œä¸€æ¬¡æ€§å–å‡ºå¤§çš„æ•°æ®é›† ğŸŒ± yield çš„ä¼˜åŠ¿åœ¨äºæ¯æ¬¡è¿­ä»£åªæ˜¯åˆ°å½“å‰çš„yieldå°±è¿”å›äº†ï¼Œä¸‹æ¬¡è¿­ä»£åœ¨ä»å®ƒè®°å½•çš„ä½ç½®åœ¨å¾€ä¸‹æ‰§è¡Œã€‚ä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„ç³»ç»Ÿèµ„æºã€‚å› ä¸ºåç¨‹æ˜¯ç¨‹åºä¹‹é—´ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ï¼Œè¦æ¯”çº¿ç¨‹ä¹‹é—´åˆ‡æ¢å¸¦æ¥ç³»ç»Ÿå¼€é”€å°ã€‚ 1234567891011121314151617public function nowExcute(Request $request)&#123; foreach($this-&gt;fib() as $mobile)&#123; echo $mobile.PHP_EOL ; &#125;&#125;public function fib()&#123; $handle = fopen(&#x27;http://uc.dev/Jbh-JKFKLSJFKL4394.txt&#x27;, &quot;r&quot;); while (!feof ($handle)) &#123; $buffer = fgets($handle); yield trim($buffer); &#125; fclose ($handle);&#125; Â¶ä»ç®—æ³•è®¾è®¡è§’åº¦è€ƒè™‘å…¶ä½¿ç”¨åœºæ™¯ æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å®ç° â˜„ï¸ 123456789101112131415 foreach($this-&gt;fib(10) as $n)&#123; echo $n.PHP_EOL;&#125;public function fib($num)&#123; $n = 0 ; $a = 0 ; $b=1; while($n &lt; $num)&#123; yield $b ; $t = $a ; $a = $b; $b = $b+$t; $n++; &#125;&#125; 123456def fin(num): n,a,b = 0,0,1 while n&lt;num: yield b a,b = b,a+b Â¶ä»ç¨‹åºåŠŸèƒ½è®¾è®¡è§’åº¦è€ƒè™‘çš„ä½¿ç”¨åœºæ™¯ ç®¡é“æ¨¡å¼çš„å®ç° 1234567(begin) ----------------&gt; function() -----------------&gt; (end) ^ ^ ^ ^ ^ ^ | | | | | | | | +------- M1() ------+ | | | +----------- ... ----------+ | +--------------- Mn() --------------+ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253function middleware($handlers,$arguments = [])&#123; //å‡½æ•°æ ˆ $stack = []; $result = null; foreach ($handlers as $handler) &#123; // æ¯æ¬¡å¾ªç¯ä¹‹å‰é‡ç½®ï¼Œåªèƒ½ä¿å­˜æœ€åä¸€ä¸ªå¤„ç†ç¨‹åºçš„è¿”å›å€¼ $result = null; $generator = call_user_func_array($handler, $arguments); if ($generator instanceof \\Generator) &#123; //å°†åç¨‹å‡½æ•°å…¥æ ˆ,ä¸ºé‡å…¥åšå‡†å¤‡ $stack[] = $generator; //è·å–åç¨‹è¿”å›å‚æ•°,åˆ°ç¬¬ä¸€ä¸ªyieldåœ°æ–¹è¿”å›ï¼Œyieldä»¥ä¸‹çš„ç¨‹åºåœ¨æ ˆé‡Œå–å‡ºåœ¨æ‰§è¡Œ $yieldValue = $generator-&gt;current(); //æ£€æŸ¥æ˜¯å¦é‡å…¥å‡½æ•°æ ˆ if ($yieldValue === false) &#123; break; &#125; &#125; elseif ($generator !== null) &#123; //ä¸å±äºè¿­ä»£å™¨çš„function,è·å–functionçš„è¿”å›å€¼ $result = $generator; &#125; &#125; $return = ($result !== null); //å°†åç¨‹å‡½æ•°å‡ºæ ˆ while ($generator = array_pop($stack)) &#123; if ($return) &#123; $generator-&gt;send($result); &#125; else &#123; $generator-&gt;next(); &#125; &#125; &#125; $logMiddleware = function()&#123; echo &quot;æ—¥å¿—ä¸­é—´ä»¶ï¼šè¿›å‚è®°å½•æ—¥å¿— \\n&quot;; yield; echo &quot;æ—¥å¿—ä¸­é—´ä»¶ï¼šå‡ºå‚è®°å½•æ—¥å¿— \\n&quot;; &#125;; $validatorMiddleware = function ()&#123; echo &quot;éªŒè¯å™¨ä¸­é—´ä»¶ï¼šå‰ç½®éªŒè¯å™¨ä¸­é—´ä»¶ \\n&quot;; $returnParms = yield; print_r($returnParms).&quot;\\n&quot;; echo &quot;éªŒè¯å™¨ä¸­é—´ä»¶ï¼šåç½®éªŒè¯å™¨ä¸­é—´ä»¶ \\n&quot;; &#125;; $handle = function ()&#123; return [&#x27;your English name&#x27;=&gt;&#x27;Henry&#x27;]; &#125;; middleware([$logMiddleware,$validatorMiddleware,$handle]); è¾“å‡ºå¦‚ä¸‹ï¼š 1234567æ—¥å¿—ä¸­é—´ä»¶ï¼šè¿›å‚è®°å½•æ—¥å¿—éªŒè¯å™¨ä¸­é—´ä»¶ï¼šå‰ç½®éªŒè¯å™¨ä¸­é—´ä»¶array(&#x27;your English name&#x27;=&gt;&#x27;Henry&#x27;)éªŒè¯å™¨ä¸­é—´ä»¶ï¼šåç½®éªŒè¯å™¨ä¸­é—´ä»¶æ—¥å¿—ä¸­é—´ä»¶ï¼šå‡ºå‚è®°å½•æ—¥å¿—","raw":null,"content":null,"categories":[],"tags":[{"name":"åç¨‹","slug":"åç¨‹","permalink":"http://blog.nicexiangcun.com/tags/%E5%8D%8F%E7%A8%8B/"}]},{"title":"ä»£ç æ•´æ´ä¹‹é“ä¹‹ä¼˜åŒ–åµŒå¥—ä»£ç ","slug":"code-summarize-two","date":"2019-11-30T12:44:30.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2019/11/30/code-summarize-two/","link":"","permalink":"http://blog.nicexiangcun.com/2019/11/30/code-summarize-two/","excerpt":"â˜˜ï¸ if else å’Œ switch case ä¼˜åŒ–æ–¹æ¡ˆ\n1 å¦‚æœåµŒå¥—é€»è¾‘æ˜¯ è¿”å›å€¼æˆ–è€…è¾“å‡ºç­‰ç®€å•çš„ä¸€å¥è¯ä»£ç ï¼Œåˆ™ä½¿ç”¨è¡¨é©±åŠ¨æ–¹æ¡ˆã€‚\n2 å¦‚æœæ˜¯é€»è¾‘å¤„ç†æˆ–è€…å‡½æ•°è°ƒç”¨ï¼Œåˆ™é‡‡ç”¨ç­–ç•¥å’Œå¤šæ€æ¨¡å¼ã€‚\nä¸¾ä¸ªä¾‹å­ï¼š\n123456789101112$type = $data[&#x27;type&#x27;]; //1-ç»‘å¡ 2-å……å€¼switch ($type) &#123;    case 1:        $res = (new AccountPermission())-&gt;bindCard($account);        break;    case 2:        $res = (new AccountPermission())-&gt;recharge($account);        break;&#125;","text":"â˜˜ï¸ if else å’Œ switch case ä¼˜åŒ–æ–¹æ¡ˆ 1 å¦‚æœåµŒå¥—é€»è¾‘æ˜¯ è¿”å›å€¼æˆ–è€…è¾“å‡ºç­‰ç®€å•çš„ä¸€å¥è¯ä»£ç ï¼Œåˆ™ä½¿ç”¨è¡¨é©±åŠ¨æ–¹æ¡ˆã€‚ 2 å¦‚æœæ˜¯é€»è¾‘å¤„ç†æˆ–è€…å‡½æ•°è°ƒç”¨ï¼Œåˆ™é‡‡ç”¨ç­–ç•¥å’Œå¤šæ€æ¨¡å¼ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112$type = $data[&#x27;type&#x27;]; //1-ç»‘å¡ 2-å……å€¼switch ($type) &#123; case 1: $res = (new AccountPermission())-&gt;bindCard($account); break; case 2: $res = (new AccountPermission())-&gt;recharge($account); break;&#125; ä»¥ä¸Šè¿™ä¸ªä¾‹å­é€»è¾‘å¤§æ¦‚å°±æ˜¯æ ¹æ®å®¢æˆ·ç«¯ä¼ é€’çš„typeå»è°ƒç”¨ä¸åŒçš„éªŒè¯æ–¹æ³•ï¼Œè¿™æ ·å†™è¿èƒŒäº†è®¾è®¡åŸåˆ™ä¹‹ä¸­çš„é’ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œä¿®æ”¹å…³é—­åŸåˆ™ï¼Œå¦‚æœæœ‰æ–°å¢typeç±»å‹é‚£ä¹ˆå¿…é¡»è¦ä¿®æ”¹æ­¤æ–‡ä»¶å’ŒAccountPermissionæ–‡ä»¶ï¼Œå¦å¤–å‡½æ•°çš„å°è£…è¦å°½å¯èƒ½çš„çŸ­å°ç²¾æ‚ï¼Œä»£ç é€»è¾‘ç›´æˆªäº†å½“å¹¶å°½å¯èƒ½çš„å‡å°‘ä¾èµ–å…³ç³»ï¼Œè¿™æ ·æ‰èƒ½ä½“ç°å‡ºåªåšå¥½ä¸€ä»¶äº‹æƒ…ã€‚é‚£ä¹ˆé’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œä»¥ä¸Šçš„ä»£ç ä¼˜åŒ–æ€è·¯æ˜¯è¿™æ ·çš„ï¼š 1 å®šä¹‰æŠ½è±¡ç±»æˆ–è€…æ¥å£ AbstractPermission 1234abstract class AbstractPermission&#123; abstract public function validator(...$data);&#125; 2 åˆ›å»ºä¸åŒçš„éªŒè¯å®ä½“å»å®ç°æˆ–è€…ç»§æ‰¿AbstractPermission 1234567//BindCardçš„éªŒè¯å®ä½“class BindCardPermission extends AbstractPermission&#123; public function validator(...$parms)&#123; //todo &#125;&#125; 1234567//Rechargeçš„éªŒè¯å®ä½“class RechargePermission extends AbstractPermission&#123; public function validator(...$parms)&#123; //todo &#125;&#125; 3 åˆ›å»ºå·¥å‚å°†åˆ›å»ºå®ä½“çš„è¿‡ç¨‹å°è£…èµ·æ¥ï¼Œåœ¨ä¸šåŠ¡å±‚é€šè¿‡ç­–ç•¥æ¥åŠ¨æ€è·å–å®ä¾‹å¯¹è±¡ 1234567891011//å½“ç„¶æ­¤å¤„çš„å·¥å‚å®ä¾‹æœ€å¥½ä¹Ÿè¦å»ç»§æ‰¿æˆ–è€…å®ç°ä¸€ä¸ªæŠ½è±¡å·¥å‚class FactoryPermission&#123; const PERMISSION = &#x27;Permission&#x27;; public static function permission($permission,$parms)&#123; $class = $permission. constant(__CLASS__ . &quot;::PERMISSION&quot;); $permissionObj = &quot;App\\\\&#123;$class&#125;&quot;; return call_user_func_array( [new $permissionObj(),&#x27;validator&#x27;], [$parms]); &#125;&#125; 4 å¦‚ä½•ä½¿ç”¨ï¼Œè¿™é‡Œå°±è¦å»è®¾è®¡ä¸€å¥—ç­–ç•¥äº†ï¼Œå¯ä»¥ç»“åˆåˆ›å»ºå·¥å‚çš„æ­¥éª¤è®¾è®¡å…·ä½“çš„ç­–ç•¥ 1234// type ä¼ é€’ BindCard Recharge ....$type = $data[&#x27;type&#x27;];$parms = $data[&#x27;parms&#x27;];$res = FactoryPermission::permission($type,$parms) æ€»ç»“ï¼šå°†èŒè´£å•ä¸€ï¼Œå‡å°‘ä¾èµ–ï¼Œé’ˆå¯¹æ‰©å±•å¼€æ”¾ä¿®æ”¹å…³é—­ï¼Œè¿™æ ·ä»¥åæœ‰æ–°å¢typeåªéœ€è¦æ‰©å±•æ–°å¢çš„permissionå®ä½“ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•å…¶ä»–æ–‡ä»¶ã€‚","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"awk","slug":"awk","date":"2019-11-29T13:58:51.000Z","updated":"2020-11-20T13:06:15.510Z","comments":true,"path":"2019/11/29/awk/","link":"","permalink":"http://blog.nicexiangcun.com/2019/11/29/awk/","excerpt":"Referenceï¼šhttps://www.gnu.org/software/gawk/manual/gawk.html#Running-gawk\n1234567891011Amelia       555-5553     amelia.zodiacusque@gmail.com    FAnthony      555-3412     anthony.asserturo@hotmail.com   ABecky        555-7685     becky.algebrarum@gmail.com      ABill         555-1675     bill.drowning@hotmail.com       ABroderick    555-0542     broderick.aliquotiens@yahoo.com RCamilla      555-2912     camilla.infusarum@skynet.be     RFabius       555-1234     fabius.undevicesimus@ucb.edu    FJulie        555-6699     julie.perscrutabor@skeeve.com   FMartin       555-6480     martin.codicibus@hotmail.com    ASamuel       555-3430     samuel.lanceolis@shu.edu        AJean-Paul    555-2127     jeanpaul.campanorum@nyu.edu     R\nÂ¶æŒ‰ $0 æŸ¥æ‰¾åŒ¹é…å…ƒç´ \n12345awk &#x27;/li/ &#123;print $0&#125;&#x27; 2017.log &lt;=&gt;grep li 2017.log//ä¸åŒçš„æ˜¯ â€˜/â€™ is called a regular expression,","text":"Referenceï¼šhttps://www.gnu.org/software/gawk/manual/gawk.html#Running-gawk 1234567891011Amelia 555-5553 amelia.zodiacusque@gmail.com FAnthony 555-3412 anthony.asserturo@hotmail.com ABecky 555-7685 becky.algebrarum@gmail.com ABill 555-1675 bill.drowning@hotmail.com ABroderick 555-0542 broderick.aliquotiens@yahoo.com RCamilla 555-2912 camilla.infusarum@skynet.be RFabius 555-1234 fabius.undevicesimus@ucb.edu FJulie 555-6699 julie.perscrutabor@skeeve.com FMartin 555-6480 martin.codicibus@hotmail.com ASamuel 555-3430 samuel.lanceolis@shu.edu AJean-Paul 555-2127 jeanpaul.campanorum@nyu.edu R Â¶æŒ‰ $0 æŸ¥æ‰¾åŒ¹é…å…ƒç´  12345awk &#x27;/li/ &#123;print $0&#125;&#x27; 2017.log &lt;=&gt;grep li 2017.log//ä¸åŒçš„æ˜¯ â€˜/â€™ is called a regular expression, Â¶åˆ‡å‰² slice uuidd:x:107:111::/run/uuidd:/bin/false å¦‚æœæ¯è¡Œä¸²éƒ½æœ‰æŸä¸ªç‰¹æ®Šå­—ç¬¦å¯ä»¥æŒ‰ç…§ç‰¹æ®Šå­—ç¬¦åˆ‡å‰²å­—ç¬¦ä¸²ã€‚ 12345awk -F &#x27;:&#x27; &#x27; /redis/ &#123; print $1 &#125;&#x27; /etc/passwdawk -F &#x27;:&#x27; &#x27;/redis/ &#123; print $1 &#125;&#x27; /etc/passwd | wc -lawk -F &#x27;:&#x27; &#x27; &#123; print $1 &#125;&#x27; /etc/passwd | sort Â¶COUNT THIS FILE ç»Ÿè®¡æ–‡ä»¶æœ‰å¤šå°‘åˆ— awk 'END &#123; print NF &#125;' 2017.log ç»Ÿè®¡æ–‡ä»¶æœ‰å¤šå°‘è¡Œ awk 'END &#123; print NR &#125;' 2017.log","raw":null,"content":null,"categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"http://blog.nicexiangcun.com/tags/Linux/"}]},{"title":"Best practice for feature switch of devops","slug":"devops-featur-switch","date":"2019-11-28T13:55:47.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2019/11/28/devops-featur-switch/","link":"","permalink":"http://blog.nicexiangcun.com/2019/11/28/devops-featur-switch/","excerpt":"Â¶ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç‰¹æ€§å¼€å…³?\n\nä¸Šçº¿å‘¨æœŸçŸ­ï¼Œå±è”½åœ¨å•ä¸€ä¸Šçº¿å‘¨æœŸå†…å·²å¼€å‘ä½†æœªå®Œæˆçš„ç‰¹æ€§ï¼ˆä¾‹å¦‚æ¯å‘¨ä¸¤æ¬¡ä¸Šçº¿ï¼Œä½†â€œäº§å“åˆ—è¡¨â€åŠŸèƒ½éœ€è¦ä¸‰å‘¨æ‰èƒ½å¼€å‘å®Œæˆï¼‰\nå¯¹æ¯”åœ¨ä¸åŒ UI ä¸‹çš„ç”¨æˆ·è¡Œä¸ºå’Œè½¬åŒ–ç‡ï¼ˆA/B Testingï¼‰\néƒ¨ç½²ä¸å‘å¸ƒåˆ†ç¦»ï¼ŒæŒç»­é¢‘ç¹éƒ¨ç½²ï¼Œä¸šåŠ¡éšæ—¶å¯å‘å¸ƒ\néƒ¨ç½²ï¼šä»£ç éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ\nå‘å¸ƒï¼šç‰¹æ€§ä¸Šçº¿ï¼Œäº¤ä»˜ç»™æœ€ç»ˆç”¨æˆ·ä½¿ç”¨,éƒ¨ç½²ä¸å‘å¸ƒåˆ†ç¦»ï¼Œå¼€å‘å›¢é˜Ÿé¢‘ç¹æŒç»­è¿›è¡Œéƒ¨ç½²ï¼Œè€Œä¸šåŠ¡äººå‘˜ï¼ˆéœ€æ±‚æ–¹ï¼‰å†³å®šç‰¹æ€§ä½•æ—¶å‘å¸ƒã€‚\n\n","text":"Â¶ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç‰¹æ€§å¼€å…³? ä¸Šçº¿å‘¨æœŸçŸ­ï¼Œå±è”½åœ¨å•ä¸€ä¸Šçº¿å‘¨æœŸå†…å·²å¼€å‘ä½†æœªå®Œæˆçš„ç‰¹æ€§ï¼ˆä¾‹å¦‚æ¯å‘¨ä¸¤æ¬¡ä¸Šçº¿ï¼Œä½†â€œäº§å“åˆ—è¡¨â€åŠŸèƒ½éœ€è¦ä¸‰å‘¨æ‰èƒ½å¼€å‘å®Œæˆï¼‰ å¯¹æ¯”åœ¨ä¸åŒ UI ä¸‹çš„ç”¨æˆ·è¡Œä¸ºå’Œè½¬åŒ–ç‡ï¼ˆA/B Testingï¼‰ éƒ¨ç½²ä¸å‘å¸ƒåˆ†ç¦»ï¼ŒæŒç»­é¢‘ç¹éƒ¨ç½²ï¼Œä¸šåŠ¡éšæ—¶å¯å‘å¸ƒ éƒ¨ç½²ï¼šä»£ç éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ å‘å¸ƒï¼šç‰¹æ€§ä¸Šçº¿ï¼Œäº¤ä»˜ç»™æœ€ç»ˆç”¨æˆ·ä½¿ç”¨,éƒ¨ç½²ä¸å‘å¸ƒåˆ†ç¦»ï¼Œå¼€å‘å›¢é˜Ÿé¢‘ç¹æŒç»­è¿›è¡Œéƒ¨ç½²ï¼Œè€Œä¸šåŠ¡äººå‘˜ï¼ˆéœ€æ±‚æ–¹ï¼‰å†³å®šç‰¹æ€§ä½•æ—¶å‘å¸ƒã€‚ Â¶ä¸ºä»€ä¹ˆä¸ç»§ç»­ä½¿ç”¨æ—§åšæ³•ï¼ˆæŒ‘ä»£ç ï¼‰ï¼Ÿ æ—§åšæ³•ï¼šæ¯æ¬¡å‘å¸ƒå‰ï¼Œä»ä»£ç ä»“åº“ä¸­ï¼Œç”±å¼€å‘ç»„é•¿ä»æœ€è¿‘çš„è‹¥å¹²æäº¤ä¸­ï¼Œæ‰‹å·¥æŒ‘é€‰å‡ºéœ€è¦ä¸Šçº¿çš„è‹¥å¹²ä¸ªæäº¤ï¼Œæµ‹è¯•äººå‘˜è¿›è¡Œæµ‹è¯•å¹¶å‘å¸ƒã€‚ è¿™ç§åšæ³•ï¼š ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ä¸»å¹²ä»£ç ä¸ä¸€è‡´ï¼Œè¿èƒŒäº†å•ä¸€ä¸»å¹²ä»£ç çš„ç­–ç•¥ï¼Œé€ æˆä»£ç åº“ç‰ˆæœ¬ç¢ç‰‡åŒ– ä¸æŒç»­é›†æˆç†å¿µèƒŒé“è€Œé©°ï¼ˆä¸èƒ½æ—©æœŸé›†æˆã€æ—©æœŸæµ‹è¯•ã€æä¾›å¿«é€Ÿåé¦ˆï¼‰ Â¶ä¸ºä»€ä¹ˆä¸ç”¨ Git Branchï¼Ÿ Long-lived feature branchæ˜¯ä¸€ä¸ªå¸¸è§çš„æŒç»­äº¤ä»˜åæ¨¡å¼ã€‚è¿™æ˜¯å› ä¸ºï¼šå¦‚æœé¡¹ç›®æ‹¥æœ‰å¤šä¸ªé•¿æœŸå½¼æ­¤ç‹¬ç«‹æ¼”è¿›çš„åˆ†æ”¯ï¼Œå¾€å¾€éœ€è¦ç­‰åˆ°æœ€åå‘å¸ƒæ—¶æ‰åˆå¹¶ä»£ç ï¼Œè¿™ä¸æŒç»­é›†æˆçš„æœ€ä½³å®è·µèƒŒé“è€Œé©°ã€‚ å¯å‚è§ ThoughtWorksæŠ€æœ¯é›·è¾¾ç›¸å…³ä»‹ç»ï¼šhttps://www.thoughtworks.com/radar/techniques/long-lived-branches-with-gitflow Â¶ç‰¹æ€§å¼€å…³æ˜¯è§£å†³é—®é¢˜çš„æœ€åæ‰‹æ®µ ä¸ºäº†éšè—æœªå®Œæˆçš„ç‰¹æ€§è¿›å…¥ç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬åº”éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š é¦–å…ˆè€ƒè™‘å°†å¤§çš„ä¸šåŠ¡ç‰¹æ€§åˆ†è§£ï¼Œåˆ†æ‰¹æ¬¡å°æ­¥å¼•å…¥æ–°çš„ç‰¹æ€§ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å‡å°‘ä¸Šçº¿é£é™©ï¼Œå¹¶æ”¶é›†ç”¨æˆ·å¯¹äºæ–°ç‰¹æ€§çš„çœŸå®ä½¿ç”¨åé¦ˆï¼Œä¾¿äºæŒç»­æ”¹è¿›è¯¥ç‰¹æ€§ã€‚ å…¶æ¬¡ï¼Œå¯ä»¥è€ƒè™‘æ–°ç‰¹æ€§UIçš„å…¥å£åœ°å€ä¸å·²æœ‰UIåˆ†ç¦»ï¼Œç»™æ–°ç‰¹æ€§èµ‹äºˆä¸€ä¸ªå…¨æ–°çš„URLï¼Œä½†ä¸æš´éœ²è¯¥åœ°å€ç»™çœŸå®ç”¨æˆ·ï¼Œå³å¯éšè—æœªå®Œæˆçš„ç‰¹æ€§ã€‚æœ€åæ‰è€ƒè™‘ç‰¹æ€§å¼€å…³ï¼Œä½œä¸ºè§£å†³é—®é¢˜çš„æœ€åæ‰‹æ®µã€‚ Â¶ä½¿ç”¨ç‰¹æ€§å¼€å…³çš„æ³¨æ„äº‹é¡¹ ä½¿ç”¨ç‰¹æ€§å¼€å…³åŒ…è£¹æŸä¸€ç‰¹æ€§æ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„ä¸è¦é—æ¼æŸäº›ç‰¹æ€§ä»£ç åœ¨å¼€å…³èŒƒå›´ä¹‹å¤–ã€‚ ä½¿ç”¨äº†ç‰¹æ€§å¼€å…³åï¼Œæµ‹è¯•äººå‘˜çš„æµ‹è¯•ç­–ç•¥ - é€šå¸¸è¯´æ¥åªéœ€æµ‹è¯•ä¸‹åˆ—ä¸¤ç§æƒ…å†µï¼š å¯ç”¨æ‰€æœ‰ä¸‹ä¸€æ¬¡ä¸Šçº¿å‘å¸ƒæ—¶éœ€è¦çš„åŠŸèƒ½çš„æƒ…å†µ å¯ç”¨æ‰€æœ‰åŠŸèƒ½çš„æƒ…å†µ ç”±ç‰¹æ€§å¼€å…³æ§åˆ¶çš„åŠŸèƒ½æ­£å¼ä¸Šçº¿å¹¶ç¨³å®šåï¼ŒåŠ¡å¿…è¦å»æ‰ç‰¹æ€§å¼€å…³ä»£ç ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ä¸­ç‰¹æ€§å¼€å…³å˜é‡ä»¥åŠæ‰€æœ‰ä½¿ç”¨ç‰¹æ€§å¼€å…³çš„ä»£ç ã€‚ ç‰¹æ€§å¼€å…³æ•°é‡ä¸èƒ½å¤ªå¤šï¼Œä¸€æ—¦è¶…è¿‡é™å®šæ•°é‡ï¼ŒåŠ¡å¿…æ¸…ç†å·²æœ‰ç‰¹æ€§å¼€å…³","raw":null,"content":null,"categories":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/categories/devops/"}],"tags":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/tags/devops/"}]},{"title":"å¥½å¿ƒä¿®æ”¹åˆ«äººçš„ä»£ç å´å¸¦æ¥æ–°çš„bug","slug":"bug-with-auther","date":"2019-02-24T13:50:13.000Z","updated":"2020-11-20T13:06:15.510Z","comments":true,"path":"2019/02/24/bug-with-auther/","link":"","permalink":"http://blog.nicexiangcun.com/2019/02/24/bug-with-auther/","excerpt":"","text":"æœ‰æ—¶å€™éå¸¸ä¸¥é‡çš„é—®é¢˜ï¼Œå°±æ˜¯ä½ å¸¸å¸¸å¿½ç•¥çš„å°ä¸ç‚¹ã€‚ å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™ä¼šé‡åˆ°è¦ä¿®æ”¹åˆ«äººçš„ä»£ç ï¼Œé‚£ä¹ˆæ€ä¹ˆç¡®ä¿ä¸ä¼šå¸¦å‡ºæ–°çš„é—®é¢˜å‡ºæ¥å‘¢ğŸ™æˆ‘ä»¬çš„é¹é£è€å¤§ç»™å‡ºäº†å‡ æ¡å»ºè®®ğŸ’¯ã€‚ UnitTestï¼Œä»”ç»†æƒ³äº†æƒ³ï¼Œå•å…ƒæµ‹è¯•çœŸçš„æ˜¯å¤ªæœ‰å¿…è¦äº†ã€‚ ä»£ç èµ°æŸ¥ï¼Œä¼˜ç§€çš„æŠ€æœ¯å›¢é˜Ÿé€šå¸¸éƒ½ä¼šæœ‰ï¼Œèµ°æŸ¥å’Œåˆ†äº«çš„ç¯èŠ‚ã€‚ å¼€å‘çºªå¾‹ä¸Šä»¥ä¸‹ä¸ŠåŸè¯ ä»£ç å—æ³¨é‡Šï¼šæ ‡æ˜ä½œè€…ã€æ—¶é—´ã€æè¿° åŸåˆ™ä¸Šä¸å…è®¸æ“…è‡ªä¿®æ”¹ä»–äººä»£ç ï¼šå¦‚éœ€ä¿®æ”¹éœ€é€šçŸ¥ä½œè€…é…åˆä¿®æ”¹ï¼Œå¦‚æ— æ³•é€šçŸ¥ä½œè€…åˆ™å¿…é¡»æ…é‡ä¿®æ”¹ä¸”é¡»æœ‰æµ‹è¯•ä¿éšœ é˜²å¾¡å¼ç¼–ç¨‹ä¸å¥‘çº¦å¼ç¼–ç¨‹ï¼šé»˜è®¤ä¸ä¿¡ä»»ä»»ä½•å¤–éƒ¨è°ƒç”¨å’Œæ–¹æ³•ï¼Œé»˜è®¤åŒæ–¹éµå®ˆå¥‘çº¦ï¼Œä»»æ„ä¸€æ–¹æ’•æ¯å¥‘çº¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå»ºè®®åœ¨UIåŠåº”ç”¨å±‚å€¾å‘äºé˜²å¾¡å¼ç¼–ç¨‹ä¿è¯å‹å¥½åŠä½“éªŒï¼Œåœ¨é€»è¾‘å±‚å€¾å‘äºå¥‘çº¦å¼ç¼–ç¨‹å°½æ—©æš´éœ²éšæ‚£","raw":null,"content":null,"categories":[{"name":"bug","slug":"bug","permalink":"http://blog.nicexiangcun.com/categories/bug/"}],"tags":[{"name":"bug","slug":"bug","permalink":"http://blog.nicexiangcun.com/tags/bug/"}]},{"title":"Never forget why you started, and your mission can be accomplished.","slug":"today-idea-20171021","date":"2017-10-21T11:17:12.000Z","updated":"2020-11-20T13:06:15.518Z","comments":true,"path":"2017/10/21/today-idea-20171021/","link":"","permalink":"http://blog.nicexiangcun.com/2017/10/21/today-idea-20171021/","excerpt":"","text":"","raw":null,"content":null,"categories":[],"tags":[]},{"title":"About swoole questions","slug":"swoole","date":"2017-09-21T15:01:21.000Z","updated":"2020-11-20T13:06:15.518Z","comments":true,"path":"2017/09/21/swoole/","link":"","permalink":"http://blog.nicexiangcun.com/2017/09/21/swoole/","excerpt":"","text":"12345678/*** fpm only can use Synchronous client*/public function fpm()&#123; $parms = &#x27;parms&#x27;; $this-&gt;tcpClient($parms);// throw a error Swoole\\Client is must cli&#125; 1234567891011121314151617181920212223242526272829303132public function serv() &#123; /** * Swoole has three mode pattern maybe refence: https://wiki.swoole.com/wiki/page/353.html * have a question at here but i don&#x27;t know , if not use SWOOLE_BASE there is a error about epoll */ $serv = new \\Swoole\\Http\\Server(&quot;0,0,0,0&quot;, 9508,SWOOLE_BASE, SWOOLE_SOCK_TCP); $serv-&gt;on(&#x27;Request&#x27;, function($request, $response) &#123; $arrParms = [ &#x27;channel&#x27;=&gt; isset($request-&gt;get[&#x27;channel&#x27;]) ? $request-&gt;get[&#x27;channel&#x27;] : &#x27;&#x27;, &#x27;uid&#x27; =&gt; isset($request-&gt;get[&#x27;uid&#x27;]) ? $request-&gt;get[&#x27;uid&#x27;] : &#x27;&#x27;, ]; $class = &#x27;BindCard&#x27;. constant(__CLASS__ . &quot;::PERM&quot;); $obj = &quot;App\\\\Http\\\\Controllers\\\\&#123;$class&#125;&quot;; call_user_func_array(array(new $obj(),&#x27;bandCard&#x27;), [$arrParms]); $response-&gt;cookie(&quot;User&quot;, &quot;Swoole&quot;); $response-&gt;cookie(&quot;english_name&quot;, &quot;Henry&quot;); $response-&gt;cookie(&quot;channel&quot;, $arrParms[&#x27;channel&#x27;]); $response-&gt;header(&quot;X-Server&quot;, &quot;Swoole&quot;); $json = json_encode([ &#x27;uid&#x27;=&gt;$arrParms[&#x27;uid&#x27;], &#x27;chanle&#x27;=&gt;$arrParms[&#x27;channel&#x27;], ]); $response-&gt;end(&quot;&lt;h1&gt;Hello Swoole!&lt;/h1&gt;&quot;.$json); &#125;); $serv-&gt;start(); &#125; 123456789101112131415161718192021222324252627282930313233class BindCardRepository&#123; public function bandCard($parms) &#123; $parms +=[ &#x27;data&#x27;=&gt;&#x27;&#x27; ]; $this-&gt;tcpClient($parms); &#125; public function tcpClient($parms) &#123; $client = new \\Swoole\\Client(SWOOLE_SOCK_TCP, SWOOLE_SOCK_ASYNC); //è®¾ç½®äº‹ä»¶å›è°ƒå‡½æ•° $client-&gt;on(&quot;connect&quot;, function($cli) use ($parms)&#123; //log $cli-&gt;send(serialize($parms)); &#125;); $client-&gt;on(&quot;receive&quot;, function($cli, $data)&#123; // when reveived data do somethings print_r(unserialize($data)); &#125;); $client-&gt;on(&quot;error&quot;, function($cli)&#123; echo &quot;Connect failed\\n&quot;; &#125;); $client-&gt;on(&quot;close&quot;, function($cli)&#123; echo &quot;Connection close\\n&quot;; &#125;); //å‘èµ·ç½‘ç»œè¿æ¥ $client-&gt;connect(&#x27;192.168.10.10&#x27;, 9503, 0.5); &#125;&#125; 12345678910111213141516171819202122public function tcpServer() &#123; $serv = new \\Swoole\\Server(&quot;192.168.10.10&quot;, 9503,SWOOLE_BASE, SWOOLE_SOCK_TCP); $serv-&gt;set(array( &#x27;daemonize&#x27; =&gt; false, &#x27;reactor_num&#x27; =&gt; 2, &#x27;worker_num&#x27; =&gt; 4 )); $serv-&gt;on(&#x27;connect&#x27;, function ($serv, $fd)&#123; echo &quot;This Tcp Server is Connected.\\n&quot;; &#125;); $serv-&gt;on(&#x27;receive&#x27;, function ($serv, $fd, $from_id, $data) &#123; // do log and do somethings. $hanleData = unserialize($data); $serv-&gt;send($fd, $data); $serv-&gt;close($fd); &#125;); $serv-&gt;on(&#x27;close&#x27;, function ($serv, $fd) &#123; echo &quot;Tcp Client: Close.\\n&quot;; &#125;); $serv-&gt;start(); &#125;","raw":null,"content":null,"categories":[],"tags":[{"name":"swoole","slug":"swoole","permalink":"http://blog.nicexiangcun.com/tags/swoole/"}]},{"title":"Here are some thing about redis","slug":"build-redis","date":"2017-09-21T14:50:41.000Z","updated":"2020-11-20T13:06:15.510Z","comments":true,"path":"2017/09/21/build-redis/","link":"","permalink":"http://blog.nicexiangcun.com/2017/09/21/build-redis/","excerpt":"","text":"123456789101112# check redis statusps -aux | grep redis# list statusredis 950 0.1 0.3 40436 8124 ? Ssl 02:11 0:24 /usr/bin/redis-server 127.0.0.1:6379vagrant 4688 0.0 0.0 14520 1092 pts/0 S+ 06:13 0:00 grep--color=auto redis# into serverredis-cli -h 127.0.0.1 -p 6379# show all keykeys *# check key&#x27;s typetype your key 12345678910111213141516171819use App\\Http\\Controllers\\Controller;use App\\Jobs\\ThisIsTestJob;use Illuminate\\Foundation\\Bus\\DispatchesJobs;class ThisIsTestBuHenryController extends Controller&#123; use DispatchesJobs; public function fire() &#123; // reference http://www.cnblogs.com/z1298703836/p/5346728.html // If use delay i don&#x27;t know is there any problem in redis it is zset // php artisan queue:work redis : yourself can run this command // php artisan queue:work redis --queue=emails : yourself can run this command that only specify queue name $this-&gt;dispatch((new ThisIsTestJob())-&gt;onQueue((&#x27;register&#x27;))); //$this-&gt;dispatch((new ThisIsTestJob())-&gt;delay(60)-&gt;onQueue((&#x27;emails&#x27;))); //$this-&gt;dispatch((new ThisIsTestJob())); dd(&#x27;hello world&#x27;); &#125;&#125; Â¶Supervisor 12345678910111213141516171819202122[program:artisan]command = /usr/bin/php /home/vagrant/Code/jbh-oauth/artisan queue:work --sleep=3 --tries=3 --queue=register --daemondirectory = /home/vagrant/Code/jbh-oauthautostart = trueautorestart = truestdout_logfile = /home/logs/supervisor/supervisor_queue.logstdout_logfile_maxbytes = 10MBstderr_logfile = /home/logs/supervisor/supervisor_queue.logstderr_logfile_maxbytes = 10MB# check sudo supervisorctl reloadsudo supervisorctl restart artisansudo supervisorctl stop artisansudo supervisorctl start artisansudo supervisorctl status all","raw":null,"content":null,"categories":[],"tags":[{"name":"redis","slug":"redis","permalink":"http://blog.nicexiangcun.com/tags/redis/"}]},{"title":"positive energy","slug":"powerful","date":"2017-08-22T14:26:14.000Z","updated":"2020-11-20T13:06:15.516Z","comments":true,"path":"2017/08/22/powerful/","link":"","permalink":"http://blog.nicexiangcun.com/2017/08/22/powerful/","excerpt":"","text":"Your opponents are reading. Your dushman are burnishing knief. Your bestie are Reducing weight. Next door Lao Wang is exercising waist. we must keep learning ,if not we will be overtaken by rivals.","raw":null,"content":null,"categories":[],"tags":[{"name":"powerful","slug":"powerful","permalink":"http://blog.nicexiangcun.com/tags/powerful/"}]},{"title":"About Python bit operation","slug":"python-ä½è¿ç®—","date":"2017-07-26T15:17:38.000Z","updated":"2020-11-20T13:06:15.517Z","comments":true,"path":"2017/07/26/python-ä½è¿ç®—/","link":"","permalink":"http://blog.nicexiangcun.com/2017/07/26/python-%E4%BD%8D%E8%BF%90%E7%AE%97/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031#!/usr/bin/env python3# -*- coding: utf-8 -*-&quot;&quot;&quot;Python bit operation,when use bit operation case&quot;&quot;&quot;RECHARGE = 2&gt;&gt;1WITHRAW = 2&lt;&lt;0INVENT = 2&lt;&lt;1BANDCARD = 2&lt;&lt;2&quot;&quot;&quot;If somebody will going to check recharge and bandcard,like this.&quot;&quot;&quot;this_user = RECHARGE | BANDCARD &quot;&quot;&quot;How can check user like this.&quot;&quot;&quot;if this_user &amp; RECHARGE: print(&#x27;recharge is ok&#x27;)if this_user &amp; WITHRAW: print(&#x27;withraw is ok&#x27;)if this_user &amp; BANDCARD: print(&#x27;bandcard is ok&#x27;)if this_user &amp; INVENT: print(&#x27;invent is ok&#x27;)","raw":null,"content":null,"categories":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/tags/python/"}]},{"title":"About Python Decorator","slug":"python-è£…é¥°å™¨","date":"2017-07-26T15:07:28.000Z","updated":"2020-11-20T13:06:15.517Z","comments":true,"path":"2017/07/26/python-è£…é¥°å™¨/","link":"","permalink":"http://blog.nicexiangcun.com/2017/07/26/python-%E8%A3%85%E9%A5%B0%E5%99%A8/","excerpt":"Decorator ä¸€ä¸ªå‡½æ•°åŸæœ‰åŠŸèƒ½ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¢å¼ºè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ï¼Œè¿™ä¸ªå°±æ˜¯è£…é¥°å™¨ã€‚\ncase: when you difined a function , then you want to add some functions in it,but you donâ€™t want modify this function.\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#!/usr/bin/env python3# -*- coding: utf-8 -*-&quot;&quot;&quot;This is a test decorator,it useful is going to print messages or bring function at a function&#x27;s front and end.&quot;&quot;&quot;def at_front_end_print(fun):    def byfun(*arg,**keyarg):        print(&#x27;At %s function\\&#x27;s front print:&#x27; %(fun.__name__))        fun(*arg,**keyarg)        print(&#x27;At %s function\\&#x27;s end print:&#x27; %(fun.__name__))    return byfun&quot;&quot;&quot;This is a test function,it test decorator at_front_end_print&quot;&quot;&quot;@at_front_end_printdef get_user_info(uid):    print(&#x27;This user id is %d :&#x27; %uid )&quot;&quot;&quot;This is a test function,it test decorator at_front_end_print&quot;&quot;&quot;@at_front_end_printdef check_user_bank_card(user , type=1):    print(&#x27;Do check %s user\\&#x27;s status, for %d&#x27; %(user,type))get_user_info(100)check_user_bank_card(101,8)&quot;&quot;&quot;This follow Decorator may pass args for example: decorator&#x27;s function do sign , like this it need three floors deep.&quot;&quot;&quot;def base_sign(sign_key):    def decorator(fun):        def byfun(*arg , **keyargs):            print(&#x27;This sector handle sign for %s :&#x27; % fun.__name__,&#x27;it\\&#x27;s sign key is %s&#x27; %sign_key)            fun(*arg , **keyargs)        return byfun    return decorator&quot;&quot;&quot;This is a open user api&quot;&quot;&quot;@base_sign(sign_key=&#x27;abc&#x27;)def open_user(uid):    print(&#x27;This sector is handle user open %d:&#x27; %uid)&quot;&quot;&quot;This is a bank user api&quot;&quot;&quot;@base_sign(&#x27;def&#x27;)def bank_user(uid):    print(&#x27;This sector is handle user bank %d:&#x27; %uid)open_user(200)bank_user(201)","text":"Decorator ä¸€ä¸ªå‡½æ•°åŸæœ‰åŠŸèƒ½ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¢å¼ºè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ï¼Œè¿™ä¸ªå°±æ˜¯è£…é¥°å™¨ã€‚ case: when you difined a function , then you want to add some functions in it,but you donâ€™t want modify this function. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#!/usr/bin/env python3# -*- coding: utf-8 -*-&quot;&quot;&quot;This is a test decorator,it useful is going to print messages or bring function at a function&#x27;s front and end.&quot;&quot;&quot;def at_front_end_print(fun): def byfun(*arg,**keyarg): print(&#x27;At %s function\\&#x27;s front print:&#x27; %(fun.__name__)) fun(*arg,**keyarg) print(&#x27;At %s function\\&#x27;s end print:&#x27; %(fun.__name__)) return byfun&quot;&quot;&quot;This is a test function,it test decorator at_front_end_print&quot;&quot;&quot;@at_front_end_printdef get_user_info(uid): print(&#x27;This user id is %d :&#x27; %uid )&quot;&quot;&quot;This is a test function,it test decorator at_front_end_print&quot;&quot;&quot;@at_front_end_printdef check_user_bank_card(user , type=1): print(&#x27;Do check %s user\\&#x27;s status, for %d&#x27; %(user,type))get_user_info(100)check_user_bank_card(101,8)&quot;&quot;&quot;This follow Decorator may pass args for example: decorator&#x27;s function do sign , like this it need three floors deep.&quot;&quot;&quot;def base_sign(sign_key): def decorator(fun): def byfun(*arg , **keyargs): print(&#x27;This sector handle sign for %s :&#x27; % fun.__name__,&#x27;it\\&#x27;s sign key is %s&#x27; %sign_key) fun(*arg , **keyargs) return byfun return decorator&quot;&quot;&quot;This is a open user api&quot;&quot;&quot;@base_sign(sign_key=&#x27;abc&#x27;)def open_user(uid): print(&#x27;This sector is handle user open %d:&#x27; %uid)&quot;&quot;&quot;This is a bank user api&quot;&quot;&quot;@base_sign(&#x27;def&#x27;)def bank_user(uid): print(&#x27;This sector is handle user bank %d:&#x27; %uid)open_user(200)bank_user(201) è£…é¥°å™¨ä½œç”¨: ç®€åŒ–ä»£ç ï¼Œé¿å…functioné‡å¤ä»£ç  æ‰“å°æ—¥å¿—ï¼š@log , å¸¦å‚æ•°@log(â€˜DEBUGâ€™) @log(â€˜INFOâ€™) æ£€æµ‹æ€§èƒ½ï¼š@performance æ•°æ®åº“äº‹åŠ¡ï¼š@transaction Urlè·¯ç”±ï¼š@post(â€˜/registerâ€™)","raw":null,"content":null,"categories":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/tags/python/"}]},{"title":"Python é«˜é˜¶å‡½æ•°","slug":"python-é«˜é˜¶å‡½æ•°","date":"2017-07-24T14:04:09.000Z","updated":"2020-11-20T13:06:15.517Z","comments":true,"path":"2017/07/24/python-é«˜é˜¶å‡½æ•°/","link":"","permalink":"http://blog.nicexiangcun.com/2017/07/24/python-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/","excerpt":"Â¶reference:  http://book.pythontips.com/en/latest/\nLetâ€™s going to understand Pythonâ€™s map , reduce , filter.","text":"Â¶reference: http://book.pythontips.com/en/latest/ Letâ€™s going to understand Pythonâ€™s map , reduce , filter. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#!/usr/bin/env python3# -*- coding: utf-8 -*-from functools import reduce# use input,like Php readline extinput = input(&quot;please input:&quot;)print(list(map(int , input.split(&#x27;,&#x27;))))str = &#x27;dd,wer, &#x27;print(str.lstrip(&#x27;d&#x27;))# use MapfruitList = [&quot;apple&quot;,&quot;orange&quot;,&quot;banana&quot;]# this map returns is an iterable object. so i don&#x27;t understand how can i retrieve or take out i want elementsiterter = map(lambda item: item+&quot;s&quot; , fruitList)for value in iterter: print(value)# list is may any data type even object or function for example# if you invest 10000 yuan and you need to know each manth&#x27;s replay plan,then i hope define 12 manth handle to give map listsdef getJan(money): return &#x27;this is Jan\\&#x27;s repaly plan&#x27;def getFeb(money): return &#x27;this is Feb\\&#x27;s replay plan&#x27;def getMar(money): return &#x27;this is Mar\\&#x27;s replay plan&#x27;money = 10000rep = map(lambda getRepaly : getRepaly(money) , [getJan,getFeb,getMar])for value in rep: print(value)#filter : as the name suggests , it return a list elements for which a function returns true.prepareFilter = [&#x27;php&#x27;,&#x27;java&#x27;,&#x27;python&#x27;];for value in filter(lambda language: language != &#x27;php&#x27; , prepareFilter): print(value)# reduce It applies a rolling computation to sequential pairs of values in a list.# Notice : If you want to use reduce need to from functools import reducepoints = [1,2,3,4,5];print(reduce(lambda x ,y: x+y ,points))","raw":null,"content":null,"categories":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/tags/python/"}]},{"title":"Python AES and PHP AES","slug":"python-aes","date":"2017-07-24T13:53:25.000Z","updated":"2020-11-20T13:06:15.516Z","comments":true,"path":"2017/07/24/python-aes/","link":"","permalink":"http://blog.nicexiangcun.com/2017/07/24/python-aes/","excerpt":"When i try use Pythonâ€™s package of json.dumps,I find the result is difference PHP, There is a question about Pythonâ€™s json.dumps. It can behand : add a place.(å®ƒä¼šåœ¨ â€˜:â€™ åæ”¾ç½®ä¸€ä¸ªç©ºæ ¼ï¼Œè€ŒåƒPHPè¿™æ ·çš„è¯­è¨€æ˜¯æ²¡æœ‰è¿™æ ·çš„hash.è¿™æ ·å¯¼è‡´ä¸¤ç§è¯­è¨€çš„AESç»“æœä¸ä¸€è‡´).","text":"When i try use Pythonâ€™s package of json.dumps,I find the result is difference PHP, There is a question about Pythonâ€™s json.dumps. It can behand : add a place.(å®ƒä¼šåœ¨ â€˜:â€™ åæ”¾ç½®ä¸€ä¸ªç©ºæ ¼ï¼Œè€ŒåƒPHPè¿™æ ·çš„è¯­è¨€æ˜¯æ²¡æœ‰è¿™æ ·çš„hash.è¿™æ ·å¯¼è‡´ä¸¤ç§è¯­è¨€çš„AESç»“æœä¸ä¸€è‡´). 12345678910111213141516171819202122232425262728293031323334353637383940414243#!/usr/bin/env python3# -*- coding: utf-8 -*-from Crypto.Cipher import AESimport jsonimport base64import hashlibkey= &#x27;LJl:*DOOUV8(&#123;t11&#x27;;iv = &#x27;OK~aAEHi&#123;yxfXDf4&#x27;;#è¿™é‡Œå¯†é’¥key é•¿åº¦å¿…é¡»ä¸º16ï¼ˆAES-128ï¼‰,#24ï¼ˆAES-192ï¼‰,æˆ–è€…32 ï¼ˆAES-256ï¼‰Bytes é•¿åº¦#ç›®å‰AES-128 è¶³å¤Ÿç›®å‰ä½¿ç”¨BS = 16#pad = lambda s: s + (BS - len(s) % BS) * &#x27;\\0&#x27;pad = lambda s: s + (BS - len(s) % BS) * chr(0)Aesdata = &#123;&#x27;uid&#x27;:&#x27;361503611&#x27;&#125;#text = json.dumps(Aesdata, sort_keys=True, indent=4, separators=(&#x27;,&#x27;, &#x27;:&#x27;))text = json.dumps(Aesdata,separators=(&#x27;,&#x27;, &#x27;:&#x27;))cryptor = AES.new(key,AES.MODE_CBC,iv)# do AESciphertext = cryptor.encrypt(pad(text))#å› ä¸ºAESåŠ å¯†æ—¶å€™å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸ä¸€å®šæ˜¯asciiå­—ç¬¦é›†çš„ï¼Œè¾“å‡ºåˆ°ç»ˆç«¯æˆ–è€…ä¿å­˜æ—¶å€™å¯èƒ½å­˜åœ¨é—®é¢˜#æ‰€ä»¥è¿™é‡Œç»Ÿä¸€æŠŠåŠ å¯†åçš„å­—ç¬¦ä¸²è½¬åŒ–ä¸º base64 æˆ–è€… 16è¿›åˆ¶å­—ç¬¦ä¸²rew = base64.b64encode(ciphertext)# md5md = hashlib.md5()sign = &#x27;H*a1CsCDFIJIL*Ib&#x27;+rew.decode()+&#x27;bim09e0d656374f46228c5205fe66f06ba7&#x27;md.update(sign.encode(&#x27;UTF-8&#x27;))print(md.hexdigest()) æˆ‘å¤§PHP very easier 12345678910static function encrypt($data,$key,$iv)&#123; $cipher = MCRYPT_RIJNDAEL_128; $mode = MCRYPT_MODE_CBC; $data=json_encode($data); $encrypt_data = mcrypt_encrypt($cipher, $key, $data, $mode, $iv); $data= base64_encode($encrypt_data); return $data;&#125;","raw":null,"content":null,"categories":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/tags/python/"}]},{"title":"javaï¼åŸºç¡€æ•´æ•°è¿ç®—","slug":"java-æ•´æ•°è¿ç®—","date":"2017-07-23T15:11:03.000Z","updated":"2020-11-20T13:06:15.512Z","comments":true,"path":"2017/07/23/java-æ•´æ•°è¿ç®—/","link":"","permalink":"http://blog.nicexiangcun.com/2017/07/23/java-%E6%95%B4%E6%95%B0%E8%BF%90%E7%AE%97/","excerpt":"Â¶æ•´æ•°è¿ç®—\næ•´æ•°é™¤æ³•ä»ç„¶æ˜¯æ•´æ•°ï¼Œ%å¯ä»¥å–ä½™ã€‚\nè‡ªå¢å’Œè‡ªå‡è¿ç®—ï¼š++å’Œ--ï¼Œæ³¨æ„æ˜¯å…ˆå¼•ç”¨åœ¨è‡ªå¢ï¼Œè¿˜æ˜¯å…ˆè‡ªå¢åœ¨å¼•ç”¨çš„å·®åˆ«ã€‚\nç®€å†™çš„+=å’Œ-=\nè®¡ç®—ç»“æœæº¢å‡ºä¸æŠ¥é”™ï¼Œä½†ç»“æœæ˜¯é”™è¯¯çš„ã€‚ åœ¨è®¡ç®—è¿‡ç¨‹ä¸­æˆ‘ä»¬æ²¡æœ‰å¿…è¦ä¸ºäº†å‡å°‘å†…å­˜ï¼Œé‡‡ç”¨byte,shortç­‰çŸ­ç±»å‹è¿›è¡Œè®¡ç®—ã€‚\nÂ¶ç§»ä½è¿ç®—\nå·¦ç§»ï¼š&lt;&lt;\nå³ç§»ï¼š&gt;&gt;\næ— æ¡ä»¶å³ç§»ï¼š&gt;&gt;&gt;\nbyte å’Œ short ä¼šå…ˆè½¬æ¢ä¸ºintåœ¨ç§»ä½\næ³¨æ„ç§»ä½å¦‚æœè¶…å‡ºäº†èŒƒå›´åˆ™ç›´æ¥è¢«ä¸¢å¼ƒã€‚For explame 5120 &gt;&gt; 11ä½\n\nint ç±»å‹å¦‚ä¸Šå›¾åœ¨å†…å­˜ä¸­å 32ä½å­˜å‚¨ç©ºé—´å…¶ä¸­æœ€é«˜ä½æ˜¯ç¬¦å·ä½ã€‚åœ¨å³ç§»è¿‡ç¨‹ä¸­å¯ä»¥ç”¨&gt;&gt;&gt;å¼ºåˆ¶å³ç§»ï¼Œå°†ç›´æ¥ç§»åŠ¨æœ€é«˜ä½çš„äºŒè¿›åˆ¶æ•°ã€‚\n","text":"Â¶æ•´æ•°è¿ç®— æ•´æ•°é™¤æ³•ä»ç„¶æ˜¯æ•´æ•°ï¼Œ%å¯ä»¥å–ä½™ã€‚ è‡ªå¢å’Œè‡ªå‡è¿ç®—ï¼š++å’Œ--ï¼Œæ³¨æ„æ˜¯å…ˆå¼•ç”¨åœ¨è‡ªå¢ï¼Œè¿˜æ˜¯å…ˆè‡ªå¢åœ¨å¼•ç”¨çš„å·®åˆ«ã€‚ ç®€å†™çš„+=å’Œ-= è®¡ç®—ç»“æœæº¢å‡ºä¸æŠ¥é”™ï¼Œä½†ç»“æœæ˜¯é”™è¯¯çš„ã€‚ åœ¨è®¡ç®—è¿‡ç¨‹ä¸­æˆ‘ä»¬æ²¡æœ‰å¿…è¦ä¸ºäº†å‡å°‘å†…å­˜ï¼Œé‡‡ç”¨byte,shortç­‰çŸ­ç±»å‹è¿›è¡Œè®¡ç®—ã€‚ Â¶ç§»ä½è¿ç®— å·¦ç§»ï¼š&lt;&lt; å³ç§»ï¼š&gt;&gt; æ— æ¡ä»¶å³ç§»ï¼š&gt;&gt;&gt; byte å’Œ short ä¼šå…ˆè½¬æ¢ä¸ºintåœ¨ç§»ä½ æ³¨æ„ç§»ä½å¦‚æœè¶…å‡ºäº†èŒƒå›´åˆ™ç›´æ¥è¢«ä¸¢å¼ƒã€‚For explame 5120 &gt;&gt; 11ä½ int ç±»å‹å¦‚ä¸Šå›¾åœ¨å†…å­˜ä¸­å 32ä½å­˜å‚¨ç©ºé—´å…¶ä¸­æœ€é«˜ä½æ˜¯ç¬¦å·ä½ã€‚åœ¨å³ç§»è¿‡ç¨‹ä¸­å¯ä»¥ç”¨&gt;&gt;&gt;å¼ºåˆ¶å³ç§»ï¼Œå°†ç›´æ¥ç§»åŠ¨æœ€é«˜ä½çš„äºŒè¿›åˆ¶æ•°ã€‚ Â¶ä½è¿ç®— ä½è¿ç®—è¿‡ç¨‹ä¸­ä¼šå…ˆæŒ‰ä½å¯¹é½ï¼Œç„¶åä¸€æ¬¡æŒ‰ä½è¿›è¡Œä¸è¿ç®—æˆ–è€…æˆ–è¿ç®—For example: Â¶å¼‚æˆ–è¿ç®— Â¶è¿ç®—è¿‡ç¨‹ä¸­ç±»å‹çš„è‡ªåŠ¨æå‡ Notice: ä¸èƒ½å°†è¾ƒå¤§çš„ç±»å‹å‚ä¸è¿›å…¥ä¸€ä¸ªè¾ƒå°ç±»å‹çš„è¿ç®—å½“ä¸­ã€‚","raw":null,"content":null,"categories":[{"name":"Java","slug":"Java","permalink":"http://blog.nicexiangcun.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://blog.nicexiangcun.com/tags/Java/"}]},{"title":"ä»£ç æ•´æ´ä¹‹ç”¨è´£ä»»é“¾æ¡é‡æ„ä½ çš„if else","slug":"è´£ä»»é“¾","date":"2017-05-30T12:31:42.000Z","updated":"2020-11-20T13:06:15.522Z","comments":true,"path":"2017/05/30/è´£ä»»é“¾/","link":"","permalink":"http://blog.nicexiangcun.com/2017/05/30/%E8%B4%A3%E4%BB%BB%E9%93%BE/","excerpt":"\nèŒè´£é“¾æ¨¡å¼æ˜¯ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚\n\næ„é€ è´£ä»»é“¾æ¡chainçš„ä¸¤ç§æ–¹å¼ï¼š\n1 é€šè¿‡å‡½æ•°æ–¹æ³•å±æ€§æ„é€  eg :\n12345678910111213abstract class  RepaymentCalculateAbstract&#123;    protected $next ;    public function setNextCalculate(RepaymentCalculateAbstract $nextCalculate)    &#123;        $this-&gt;next = $nextCalculate;    &#125;       abstract public function calculate($parms) ;    &#125;","text":"èŒè´£é“¾æ¨¡å¼æ˜¯ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ æ„é€ è´£ä»»é“¾æ¡chainçš„ä¸¤ç§æ–¹å¼ï¼š 1 é€šè¿‡å‡½æ•°æ–¹æ³•å±æ€§æ„é€  eg : 12345678910111213abstract class RepaymentCalculateAbstract&#123; protected $next ; public function setNextCalculate(RepaymentCalculateAbstract $nextCalculate) &#123; $this-&gt;next = $nextCalculate; &#125; abstract public function calculate($parms) ; &#125; 1234567891011class JanuaryRepayment extends RepaymentCalculateAbstract&#123; public function calculate($parms) &#123; //pass echo &#x27;Jan-&#x27;.$parms ; $this-&gt;next-&gt;calculate($parms); &#125;&#125; 12345678910class FebruaryRepayment extends RepaymentCalculateAbstract&#123; public function calculate($parms) &#123; //pass $parms = 100 + $parms ; echo &#x27;Feb&#x27;.$parms ; $this-&gt;next-&gt;calculate($parms); &#125;&#125; 12345678910class MarchRepayment extends RepaymentCalculateAbstract&#123; public function calculate($parms) &#123; //pass $parms = 100 + $parms; echo &#x27;Mar&#x27;.$parms ; //$this-&gt;next-&gt;calculate($parms); &#125;&#125; 123456789class AppRepaymentCalculate extends RestAbstractController&#123; public function calculate(Request $request , FebruaryRepayment $Feb , JanuaryRepayment $Jan ,MarchRepayment $Mar) &#123; $Jan-&gt;setNextCalculate($Feb) ; $Feb-&gt;setNextCalculate($Mar); $Jan-&gt;calculate(&#x27;100&#x27;) ; &#125;&#125; 2 æ„é€ æ³¨å…¥é“¾æ¡ï¼Œé€šè¿‡åœ¨çˆ¶ç±»åšåˆ‡é¢ä»£ç†è°ƒç”¨å­ç±»çš„ processing ï¼š eg 12345678910111213141516171819202122232425262728293031abstract class Handler&#123; /** * @var Handler|null */ private $successor = null; public function __construct(Handler $handler = null) &#123; $this-&gt;successor = $handler; &#125; /** * This approach by using a template method pattern ensures you that * each subclass will not forget to call the successor * * @param RequestInterface $request * * @return string|null */ final public function handle(RequestInterface $request) &#123; $processed = $this-&gt;processing($request); if ($processed === null) &#123; // the request has not been processed by this handler =&gt; see the next if ($this-&gt;successor !== null) &#123; $processed = $this-&gt;successor-&gt;handle($request); &#125; &#125; return $processed; &#125; abstract protected function processing(RequestInterface $request); 12345678910111213141516171819202122232425262728293031323334class HttpInMemoryCacheHandler extends Handler&#123; /** * @var array */ private $data; /** * @param array $data * @param Handler|null $successor */ public function __construct(array $data, Handler $successor = null) &#123; parent::__construct($successor); $this-&gt;data = $data; &#125; /** * @param RequestInterface $request * * @return string|null */ protected function processing(RequestInterface $request) &#123; $key = sprintf( &#x27;%s?%s&#x27;, $request-&gt;getUri()-&gt;getPath(), $request-&gt;getUri()-&gt;getQuery() ); if ($request-&gt;getMethod() == &#x27;GET&#x27; &amp;&amp; isset($this-&gt;data[$key])) &#123; return $this-&gt;data[$key]; &#125; return null; &#125;&#125; 12345678910111213class SlowDatabaseHandler extends Handler&#123; /** * @param RequestInterface $request * * @return string|null */ protected function processing(RequestInterface $request) &#123; // this is a mockup, in production code you would ask a slow (compared to in-memory) DB for the results return &#x27;Hello World!&#x27;; &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637class ChainTest extends TestCase&#123; /** * @var Handler */ private $chain; protected function setUp() &#123; $this-&gt;chain = new HttpInMemoryCacheHandler( [&#x27;/foo/bar?index=1&#x27; =&gt; &#x27;Hello In Memory!&#x27;], new SlowDatabaseHandler() ); &#125; public function testCanRequestKeyInFastStorage() &#123; $uri = $this-&gt;createMock(&#x27;Psr\\Http\\Message\\UriInterface&#x27;); $uri-&gt;method(&#x27;getPath&#x27;)-&gt;willReturn(&#x27;/foo/bar&#x27;); $uri-&gt;method(&#x27;getQuery&#x27;)-&gt;willReturn(&#x27;index=1&#x27;); $request = $this-&gt;createMock(&#x27;Psr\\Http\\Message\\RequestInterface&#x27;); $request-&gt;method(&#x27;getMethod&#x27;) -&gt;willReturn(&#x27;GET&#x27;); $request-&gt;method(&#x27;getUri&#x27;)-&gt;willReturn($uri); $this-&gt;assertEquals(&#x27;Hello In Memory!&#x27;, $this-&gt;chain-&gt;handle($request)); &#125; public function testCanRequestKeyInSlowStorage() &#123; $uri = $this-&gt;createMock(&#x27;Psr\\Http\\Message\\UriInterface&#x27;); $uri-&gt;method(&#x27;getPath&#x27;)-&gt;willReturn(&#x27;/foo/baz&#x27;); $uri-&gt;method(&#x27;getQuery&#x27;)-&gt;willReturn(&#x27;&#x27;); $request = $this-&gt;createMock(&#x27;Psr\\Http\\Message\\RequestInterface&#x27;); $request-&gt;method(&#x27;getMethod&#x27;) -&gt;willReturn(&#x27;GET&#x27;); $request-&gt;method(&#x27;getUri&#x27;)-&gt;willReturn($uri); $this-&gt;assertEquals(&#x27;Hello World!&#x27;, $this-&gt;chain-&gt;handle($request)); &#125;&#125;","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"Practice of devops thinking","slug":"devops-thinking","date":"2017-05-14T13:47:58.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2017/05/14/devops-thinking/","link":"","permalink":"http://blog.nicexiangcun.com/2017/05/14/devops-thinking/","excerpt":"Â¶ç²¾ç›Šæ€æƒ³ï¼šæ¶ˆé™¤æµªè´¹\n\nä»¥è¶Šæ¥è¶Šå°‘çš„æŠ•å…¥â€”â€”è¾ƒå°‘çš„äººåŠ›ã€è¾ƒå°‘çš„è®¾å¤‡ã€è¾ƒçŸ­çš„æ—¶é—´å’Œè¾ƒå°çš„åœºåœ°åˆ›é€ å‡ºå°½å¯èƒ½å¤šçš„ä»·å€¼ï¼›\nè¶Šæ¥è¶Šæ¥è¿‘ç”¨æˆ·ï¼Œæä¾›ä»–ä»¬ç¡®å®è¦çš„ä¸œè¥¿ï¼Œç²¾ç¡®åœ°å®šä¹‰ä»·å€¼\nç¡®å®šæ¯ä¸ªäº§å“çš„å…¨éƒ¨ä»·å€¼æµï¼›\nä½¿ä¿ç•™ä¸‹æ¥çš„ã€åˆ›é€ ä»·å€¼çš„å„ä¸ªæ­¥éª¤æµåŠ¨èµ·æ¥ï¼Œç¼©çŸ­å‘¨æœŸ\nåŠæ—¶è·Ÿä¸Šä¸æ–­å˜åŒ–ç€çš„é¡¾å®¢éœ€æ±‚\nç²¾ç›Šæ€æƒ³åŒ…æ‹¬ç²¾ç›Šç”Ÿäº§ã€ç²¾ç›Šç®¡ç†ã€ç²¾ç›Šè®¾è®¡å’Œç²¾ç›Šä¾›åº”ç­‰ä¸€ç³»åˆ—æ€æƒ³ï¼Œå…¶æ ¸å¿ƒæ˜¯é€šè¿‡åŠæ—¶é€‚é‡ã€é›¶åº“å­˜ã€ä¼ ç¥¨å¡ç­‰ç°åœºç®¡ç†æ‰‹æ®µå®ç°è®¢è´§ç”Ÿäº§ï¼Œä»è€Œç¡®ä¿äº§å“è´¨é‡å¹¶é™ä½æˆæœ¬ã€‚â€œç²¾â€ä½“ç°åœ¨è´¨é‡ä¸Šï¼Œè¿½æ±‚å°½å–„å°½ç¾ã€ç²¾ç›Šæ±‚ç²¾ï¼›â€œç›Šâ€ä½“ç°åœ¨æˆæœ¬ä¸Šï¼Œåªæœ‰æˆæœ¬ä½äºè¡Œä¸šå¹³å‡æˆæœ¬çš„ä¼ä¸šæ‰èƒ½è·å¾—æ”¶ç›Šã€‚å› è€Œï¼Œç²¾ç›Šæ€æƒ³ä¸å•çº¯è¿½æ±‚æˆæœ¬æœ€ä½ã€ä¼ä¸šçœ¼ä¸­çš„è´¨é‡æœ€ä¼˜ï¼Œè€Œæ˜¯è¿½æ±‚ç”¨æˆ·å’Œä¼ä¸šéƒ½æ»¡æ„çš„è´¨é‡ã€è¿½æ±‚æˆæœ¬ä¸è´¨é‡çš„æœ€ä½³é…ç½®ã€è¿½æ±‚äº§å“æ€§èƒ½ä»·æ ¼çš„æœ€ä¼˜æ¯”ã€‚\n\nÂ¶æ•æ·é€‰å‹ï¼šSCRUM\n","text":"Â¶ç²¾ç›Šæ€æƒ³ï¼šæ¶ˆé™¤æµªè´¹ ä»¥è¶Šæ¥è¶Šå°‘çš„æŠ•å…¥â€”â€”è¾ƒå°‘çš„äººåŠ›ã€è¾ƒå°‘çš„è®¾å¤‡ã€è¾ƒçŸ­çš„æ—¶é—´å’Œè¾ƒå°çš„åœºåœ°åˆ›é€ å‡ºå°½å¯èƒ½å¤šçš„ä»·å€¼ï¼› è¶Šæ¥è¶Šæ¥è¿‘ç”¨æˆ·ï¼Œæä¾›ä»–ä»¬ç¡®å®è¦çš„ä¸œè¥¿ï¼Œç²¾ç¡®åœ°å®šä¹‰ä»·å€¼ ç¡®å®šæ¯ä¸ªäº§å“çš„å…¨éƒ¨ä»·å€¼æµï¼› ä½¿ä¿ç•™ä¸‹æ¥çš„ã€åˆ›é€ ä»·å€¼çš„å„ä¸ªæ­¥éª¤æµåŠ¨èµ·æ¥ï¼Œç¼©çŸ­å‘¨æœŸ åŠæ—¶è·Ÿä¸Šä¸æ–­å˜åŒ–ç€çš„é¡¾å®¢éœ€æ±‚ ç²¾ç›Šæ€æƒ³åŒ…æ‹¬ç²¾ç›Šç”Ÿäº§ã€ç²¾ç›Šç®¡ç†ã€ç²¾ç›Šè®¾è®¡å’Œç²¾ç›Šä¾›åº”ç­‰ä¸€ç³»åˆ—æ€æƒ³ï¼Œå…¶æ ¸å¿ƒæ˜¯é€šè¿‡åŠæ—¶é€‚é‡ã€é›¶åº“å­˜ã€ä¼ ç¥¨å¡ç­‰ç°åœºç®¡ç†æ‰‹æ®µå®ç°è®¢è´§ç”Ÿäº§ï¼Œä»è€Œç¡®ä¿äº§å“è´¨é‡å¹¶é™ä½æˆæœ¬ã€‚â€œç²¾â€ä½“ç°åœ¨è´¨é‡ä¸Šï¼Œè¿½æ±‚å°½å–„å°½ç¾ã€ç²¾ç›Šæ±‚ç²¾ï¼›â€œç›Šâ€ä½“ç°åœ¨æˆæœ¬ä¸Šï¼Œåªæœ‰æˆæœ¬ä½äºè¡Œä¸šå¹³å‡æˆæœ¬çš„ä¼ä¸šæ‰èƒ½è·å¾—æ”¶ç›Šã€‚å› è€Œï¼Œç²¾ç›Šæ€æƒ³ä¸å•çº¯è¿½æ±‚æˆæœ¬æœ€ä½ã€ä¼ä¸šçœ¼ä¸­çš„è´¨é‡æœ€ä¼˜ï¼Œè€Œæ˜¯è¿½æ±‚ç”¨æˆ·å’Œä¼ä¸šéƒ½æ»¡æ„çš„è´¨é‡ã€è¿½æ±‚æˆæœ¬ä¸è´¨é‡çš„æœ€ä½³é…ç½®ã€è¿½æ±‚äº§å“æ€§èƒ½ä»·æ ¼çš„æœ€ä¼˜æ¯”ã€‚ Â¶æ•æ·é€‰å‹ï¼šSCRUM è§’è‰²ï¼šäº§å“è´Ÿè´£äººï¼ˆPOï¼‰â€”â€” æ•æ·æ•™ç»ƒï¼ˆSMï¼‰â€”â€” è‡ªç»„ç»‡å¼€å‘å›¢é˜Ÿï¼ˆDTï¼‰ Scrumè¿‡ç¨‹æ¡†æ¶çš„åŸºçŸ³ï¼š é€æ˜æ€§ï¼šçœ‹æ¿ç®¡ç†ï¼ˆProduct Backlogã€SPRINT BACKLOGã€BURN-DOWN CHARTï¼‰ ä¸ºäº†å¢å¼ºé¢å¯¹é¢æ²Ÿé€šï¼Œå‰ä¸‰ä¸ªæœˆå»ºè®®ä½¿ç”¨ç™½æ¿è¿›è¡Œï¼Œä¹‹åå¯ä»¥ä½¿ç”¨ JIRA ç­‰çœ‹æ¿ç³»ç»Ÿ æ£€éªŒå’Œé€‚åº”ï¼šäº§å“å¾…åŠäº‹é¡¹åˆ—è¡¨æ¢³ç†ã€Sprintè®¡åˆ’ä¼šè®®ã€æ¯æ—¥ç«™ä¼šã€Sprintè¯„å®¡ã€Sprintå›é¡¾ä¼šè®® æ¯æ—¥ç«™ä¼šï¼š 15åˆ†é’Ÿä»¥å†…å®Œæˆï¼Œæ¯ä¸ªäººå›ç­”ä¸‰ä¸ªé—®é¢˜ æˆ‘æ˜¨å¤©å®Œæˆäº†ä»€ä¹ˆä»»åŠ¡ï¼Ÿ æˆ‘ä»Šå¤©æ‰“ç®—åšä»€ä¹ˆä»»åŠ¡ï¼Ÿ æˆ‘é‡åˆ°äº†å“ªäº›éšœç¢æˆ–å›°éš¾ï¼Ÿ Â¶æŒç»­äº¤ä»˜æ¨¡å‹ï¼šæ•æ·å¼€å‘ + ç‰ˆæœ¬ç®¡ç† +å•å…ƒæµ‹è¯• + ä»£ç å®¡æŸ¥ + é›†æˆæ„å»º + è‡ªåŠ¨åŒ–æµ‹è¯• æŒç»­äº¤ä»˜å·¥å…·é“¾ï¼š intelliJ -&gt; gitlab -&gt; sonar -&gt; jenkins -&gt; SIT ç»Ÿä¸€çš„ä»£ç ç®¡ç†ï¼šgitlab åˆ†æ”¯ç­–ç•¥ï¼š devï¼ˆSITï¼‰ releaseï¼ˆUATï¼‰ masterï¼ˆPROï¼‰æ³¨æ„äº‹é¡¹ï¼šæ¯ä¸ªäººæ¯å¤©éƒ½è¦å‘ä»£ç åº“ä¸»å¹²æäº¤ä»£ç  ä¸¥æ ¼çš„ä»£ç å®¡æŸ¥æœºåˆ¶ï¼šsonar è§„åˆ™ï¼šNew bugs &lt;= 0 , New Vulnerabilities &lt;= 0 ,æ³¨æ„äº‹é¡¹ï¼šåªæœ‰é€šè¿‡ä»£ç å®¡æŸ¥çš„ä»£ç æ‰èƒ½è¿›è¡Œæ„å»º é›†æˆæ„å»ºï¼šjenkins , æµç¨‹æ¨¡æ¿ï¼šä»£ç æ›´æ–°,å•å…ƒæµ‹è¯•,ä»£ç æ£€æŸ¥,éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ,æ¥å£æµ‹è¯• éƒ¨ç½²ç­–ç•¥ï¼š devåˆ†æ”¯-&gt; SITç¯å¢ƒ,releaseåˆ†æ”¯ -&gt; UATç¯å¢ƒ -&gt; PROç¯å¢ƒ,PROç¯å¢ƒ -&gt; masteråˆ†æ”¯ æ³¨æ„äº‹é¡¹ï¼š æ¯æ—¥è‡³å°‘æ„å»ºä¸€æ¬¡,è¿‡ç¨‹ä¸ä¸èƒ½å­˜åœ¨äººå·¥å¹²é¢„,ä¿®å¤å¤±è´¥çš„æ„å»ºæ˜¯ä¼˜å…ˆçº§æœ€é«˜çš„äº‹æƒ… summarize ï¼š DevOps = ç²¾ç›Šæ€æƒ³ + æ•æ·å¼€å‘ + æŒç»­äº¤ä»˜","raw":null,"content":null,"categories":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/categories/devops/"}],"tags":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/tags/devops/"}]},{"title":"Best Practice Of Jenkins","slug":"jenkins","date":"2017-05-11T14:57:34.000Z","updated":"2020-11-20T13:06:15.512Z","comments":true,"path":"2017/05/11/jenkins/","link":"","permalink":"http://blog.nicexiangcun.com/2017/05/11/jenkins/","excerpt":"Â¶Jenkinsäº¤ä»˜æµæ°´\nDevOpså’Œäº§å“å›¢é˜Ÿéœ€è¦ç†Ÿæ‚‰çš„JenkinsæŠ€èƒ½\n\næŒç»­é›†æˆ\n\n\næŒç»­é›†æˆæ¦‚å¿µç®€ä»‹\né¡¹ç›®äº¤ä»˜æµæ°´çº¿ï¼šæŒç»­é›†æˆçš„è¡¨ç°å½¢å¼\nWebå’ŒMobileé¡¹ç›®çš„å…¸å‹äº¤ä»˜æµæ°´çº¿\n\n\nJenkinsæŒç»­é›†æˆç³»ç»Ÿ\n\n\nJenkinsçš„ç‰¹ç‚¹\nç†è§£æµæ°´çº¿å³ä»£ç ï¼ˆPipeline as Codeï¼‰\n\n\nJenkinsçš„ä½¿ç”¨\n\n\næµæ°´çº¿çš„ç›®å½•å±‚çº§è§„åˆ’\nåœ¨Jenkinsä¸­åˆ›å»ºæµæ°´çº¿\n\n\né…ç½®å®šæ—¶æ£€æŸ¥ä»£ç æ›´æ–°\né…ç½®å¸¦è¾“å…¥å‚æ•°çš„æµæ°´çº¿\næ·»åŠ æµæ°´çº¿å†…å®¹\n\n\nJenkinsfileçš„ä½¿ç”¨\n\n\nJenkinsfileçš„ç®¡ç†ï¼šé¡¹ç›®ä¸­çš„pipelineç›®å½•\næ ‡å‡†æµæ°´çº¿çš„å¸¸è§æ­¥éª¤\nå¸¸ç”¨çš„Jenkinsfileè¯­æ³•\nJenkinsä¸­çš„Pipeline Syntaxå·¥å…·\n\n","text":"Â¶Jenkinsäº¤ä»˜æµæ°´ DevOpså’Œäº§å“å›¢é˜Ÿéœ€è¦ç†Ÿæ‚‰çš„JenkinsæŠ€èƒ½ æŒç»­é›†æˆ æŒç»­é›†æˆæ¦‚å¿µç®€ä»‹ é¡¹ç›®äº¤ä»˜æµæ°´çº¿ï¼šæŒç»­é›†æˆçš„è¡¨ç°å½¢å¼ Webå’ŒMobileé¡¹ç›®çš„å…¸å‹äº¤ä»˜æµæ°´çº¿ JenkinsæŒç»­é›†æˆç³»ç»Ÿ Jenkinsçš„ç‰¹ç‚¹ ç†è§£æµæ°´çº¿å³ä»£ç ï¼ˆPipeline as Codeï¼‰ Jenkinsçš„ä½¿ç”¨ æµæ°´çº¿çš„ç›®å½•å±‚çº§è§„åˆ’ åœ¨Jenkinsä¸­åˆ›å»ºæµæ°´çº¿ é…ç½®å®šæ—¶æ£€æŸ¥ä»£ç æ›´æ–° é…ç½®å¸¦è¾“å…¥å‚æ•°çš„æµæ°´çº¿ æ·»åŠ æµæ°´çº¿å†…å®¹ Jenkinsfileçš„ä½¿ç”¨ Jenkinsfileçš„ç®¡ç†ï¼šé¡¹ç›®ä¸­çš„pipelineç›®å½• æ ‡å‡†æµæ°´çº¿çš„å¸¸è§æ­¥éª¤ å¸¸ç”¨çš„Jenkinsfileè¯­æ³• Jenkinsä¸­çš„Pipeline Syntaxå·¥å…· Â¶å»ºè®®é˜…è¯»ææ–™ Jenkins Pipelineå®˜æ–¹æ•™ç¨‹ï¼š https://github.com/jenkinsci/pipeline-plugin/blob/master/TUTORIAL.md Jenkins Pipelineçš„10ä¸ªæœ€ä½³å®è·µï¼š http://www.cnblogs.com/itech/p/5678643.html Jenkinsfileå®˜æ–¹ç¤ºä¾‹ï¼š https://github.com/jenkinsci/pipeline-examples Â¶æŒç»­é›†æˆåŸºç¡€æ¦‚å¿µ æŒç»­é›†æˆï¼ŒContinuous integration ï¼Œç®€ç§°CIã€‚ éšç€è½¯ä»¶å¼€å‘å¤æ‚åº¦çš„ä¸æ–­æé«˜ï¼Œå›¢é˜Ÿå¼€å‘æˆå‘˜é—´å¦‚ä½•æ›´å¥½åœ°ååŒå·¥ä½œä»¥ç¡®ä¿è½¯ä»¶å¼€å‘çš„è´¨é‡å·²ç»æ…¢æ…¢æˆä¸ºå¼€å‘è¿‡ç¨‹ä¸­ä¸å¯å›é¿çš„é—®é¢˜ã€‚å°¤å…¶æ˜¯è¿‘äº›å¹´æ¥ï¼Œæ•æ·ï¼ˆAgileï¼‰ åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸè¶Šæ¥è¶Šçº¢ç«ï¼Œå¦‚ä½•èƒ½å†ä¸æ–­å˜åŒ–çš„éœ€æ±‚ä¸­å¿«é€Ÿé€‚åº”å’Œä¿è¯è½¯ä»¶çš„è´¨é‡ä¹Ÿæ˜¾å¾—å°¤å…¶çš„é‡è¦ã€‚ æŒç»­é›†æˆæ­£æ˜¯é’ˆå¯¹è¿™ä¸€ç±»é—®é¢˜çš„ä¸€ç§è½¯ä»¶å¼€å‘å®è·µã€‚å®ƒå€¡å¯¼å›¢é˜Ÿå¼€å‘æˆå‘˜å¿…é¡»ç»å¸¸é›†æˆä»–ä»¬çš„å·¥ä½œï¼Œç”šè‡³æ¯å¤©éƒ½å¯èƒ½å‘ç”Ÿå¤šæ¬¡é›†æˆã€‚è€Œæ¯æ¬¡çš„é›†æˆéƒ½æ˜¯é€šè¿‡è‡ªåŠ¨åŒ–çš„æ„å»ºæ¥éªŒè¯ï¼ŒåŒ…æ‹¬è‡ªåŠ¨ç¼–è¯‘ã€å‘å¸ƒå’Œæµ‹è¯•ï¼Œä»è€Œå°½å¿«åœ°å‘ç°é›†æˆé”™è¯¯ï¼Œè®©å›¢é˜Ÿèƒ½å¤Ÿæ›´å¿«çš„å¼€å‘å†…èšçš„è½¯ä»¶ã€‚ ä»¥ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„å¤§å‹ITé¡¹ç›®ä¸ºä¾‹ã€‚ é¦–å…ˆï¼Œè§£é‡Šä¸‹é›†æˆã€‚æˆ‘ä»¬æ‰€æœ‰é¡¹ç›®çš„ä»£ç éƒ½æ˜¯æ‰˜ç®¡åœ¨GitæœåŠ¡å™¨ä¸Šã€‚æ¯ä¸ªé¡¹ç›®éƒ½è¦æœ‰è‹¥å¹²ä¸ªå•å…ƒæµ‹è¯•ï¼Œåªæœ‰åœ¨æœ¬åœ°ç”µè„‘ä¸Šé€šè¿‡äº†å•å…ƒæµ‹è¯•çš„ä»£ç æ‰èƒ½ä¸Šä¼ åˆ°GitæœåŠ¡å™¨ä¸Šï¼Œä¿è¯ä¸Šä¼ çš„ä»£ç æ²¡æœ‰é—®é¢˜ã€‚ä»£ç è¿›å…¥æµæ°´çº¿ä»¥åä¼šç»å†ä¸€ç³»åˆ—çš„é¢„å®šè¿‡ç¨‹ï¼Œæ¯”å¦‚ç¡®è®¤å•å…ƒæµ‹è¯•é€šè¿‡ï¼Œä»£ç é™æ€æ£€æŸ¥å’Œæµ‹è¯•ç¯å¢ƒçš„éƒ¨ç½²ç­‰ï¼Œç„¶åä¼šè¿›å…¥é›†æˆæµ‹è¯•é˜¶æ®µã€‚é›†æˆæµ‹è¯•æ˜¯æŒ‡å°†å¤šä¸ªè½¯ä»¶ç»„ä»¶è¿æ¥åï¼Œé€šè¿‡è‡ªåŠ¨åŒ–çš„æ‰‹æ®µæ£€æŸ¥ç»„ä»¶ç›´æ¥çš„é€šä¿¡æ˜¯å¦è¢«ç ´åï¼Œå› æ­¤è¿™é‡Œçš„â€œé›†æˆâ€æŒ‡å°±æ˜¯æŒ‡çš„é›†æˆæµ‹è¯•ã€‚ å†è¯´æŒç»­ã€‚ä¸è¨€è€Œå–»ï¼Œå°±æ˜¯æŒ‡é•¿æœŸçš„å¯¹é¡¹ç›®ä»£ç è¿›è¡Œé›†æˆæµ‹è¯•ã€‚æ—¢ç„¶æ˜¯é•¿æœŸï¼Œé‚£è‚¯å®šæ˜¯è‡ªåŠ¨æ‰§è¡Œçš„ï¼Œå¦åˆ™ï¼Œäººå·¥æ‰§è¡Œåˆ™æ²¡æœ‰ä¿è¯ï¼Œè€Œä¸”è€—äººåŠ›ã€‚å¯¹æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸€å°æœåŠ¡å™¨ï¼Œå®ƒä¼šæ£€æŸ¥Gitä»“åº“çš„ä»£ç å˜æ›´ï¼Œå½“ä»£ç ä»“åº“å†…å®¹å‘ç”Ÿå˜åŒ–ä»¥åï¼Œå®ƒéœ€è¦æ›´æ–°æœ¬åœ°ä»£ç ï¼Œé‡æ–°ç¼–è¯‘ï¼Œç„¶åè·‘é›†æˆæµ‹è¯•ã€‚æ¯æ¬¡é›†æˆæµ‹è¯•ç»“æœéƒ½ä¼šè®°å½•åœ¨æ¡ˆã€‚å®Œæˆè¿™æ–¹é¢å·¥ä½œçš„å°±æ˜¯Jenkinsè½¯ä»¶ï¼Œå½“ç„¶ï¼Œå®ƒçš„åŠŸèƒ½è¿œä¸æ­¢è¿™äº›ã€‚ æŒç»­é›†æˆçš„ç‰¹ç‚¹ï¼š å®ƒæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å‘¨æœŸæ€§çš„é›†æˆæµ‹è¯•è¿‡ç¨‹ï¼Œä»æ£€å‡ºä»£ç ã€ç¼–è¯‘æ„å»ºã€è¿è¡Œæµ‹è¯•ã€ç»“æœè®°å½•ã€æµ‹è¯•ç»Ÿè®¡ç­‰éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œæ— éœ€äººå·¥å¹²é¢„ï¼› éœ€è¦æœ‰ä¸“é—¨çš„é›†æˆæœåŠ¡å™¨æ¥æ‰§è¡Œé›†æˆæ„å»ºï¼› éœ€è¦æœ‰ä»£ç æ‰˜ç®¡å·¥å…·æ”¯æŒï¼› æŒç»­é›†æˆçš„ä½œç”¨ï¼š ä¿è¯å›¢é˜Ÿå¼€å‘äººå‘˜æäº¤ä»£ç çš„è´¨é‡ï¼Œå‡è½»äº†è½¯ä»¶å‘å¸ƒæ—¶çš„å‹åŠ› æŒç»­é›†æˆä¸­çš„ä»»ä½•ä¸€ä¸ªç¯èŠ‚éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œæ— éœ€å¤ªå¤šçš„äººå·¥å¹²é¢„ï¼Œæœ‰åˆ©äºå‡å°‘é‡å¤è¿‡ç¨‹ä»¥èŠ‚çœæ—¶é—´ã€è´¹ç”¨å’Œå·¥ä½œé‡ï¼› Â¶Jenkinså®‰è£…ä¸é…ç½® Jenkinsæ˜¯ä¸€ä¸ªå¼€æºçš„å®ç°æŒç»­é›†æˆçš„è½¯ä»¶å·¥å…·ã€‚å®ƒèƒ½å®æ—¶ç›‘æ§é›†æˆä¸­å­˜åœ¨çš„é”™è¯¯ï¼Œæä¾›è¯¦ç»†çš„æ—¥å¿—æ–‡ä»¶å’Œæé†’åŠŸèƒ½ï¼Œè¿˜èƒ½ç”¨å›¾è¡¨çš„å½¢å¼å½¢è±¡åœ°å±•ç¤ºé¡¹ç›®æ„å»ºçš„è¶‹åŠ¿å’Œç¨³å®šæ€§ã€‚ å®˜æ–¹ç½‘ç«™ï¼šhttp://jenkins.io Jenkinsçš„ç‰¹ç‚¹ï¼š æ˜“å®‰è£…ï¼šä»…ä»…ä¸€ä¸ª java -jar jenkins.warï¼Œä»å®˜ç½‘ä¸‹è½½è¯¥æ–‡ä»¶åï¼Œç›´æ¥è¿è¡Œï¼Œæ— éœ€é¢å¤–çš„å®‰è£…ï¼Œæ›´æ— éœ€å®‰è£…æ•°æ®åº“ï¼› æ˜“é…ç½®ï¼šæä¾›å‹å¥½çš„GUIé…ç½®ç•Œé¢ï¼› å˜æ›´æ”¯æŒï¼šJenkinsèƒ½ä»ä»£ç ä»“åº“ï¼ˆSvn/Gitï¼‰ä¸­è·å–å¹¶äº§ç”Ÿä»£ç æ›´æ–°åˆ—è¡¨å¹¶æ˜¾ç¤ºåˆ°æµæ°´çº¿ä¿¡æ¯ä¸­ï¼› æ”¯æŒæ°¸ä¹…é“¾æ¥ï¼šç”¨æˆ·æ˜¯é€šè¿‡webæ¥è®¿é—®Jenkinsçš„ï¼Œè€Œè¿™äº›webé¡µé¢çš„é“¾æ¥åœ°å€éƒ½æ˜¯æ°¸ä¹…é“¾æ¥åœ°å€ï¼Œå› æ­¤ï¼Œä½ å¯ä»¥åœ¨å„ç§æ–‡æ¡£ä¸­ç›´æ¥ä½¿ç”¨è¯¥é“¾æ¥ï¼› é›†æˆE-Mail/RSS/IMï¼šå½“å®Œæˆä¸€æ¬¡é›†æˆå®Œæˆæ—¶ï¼Œå¯é€šè¿‡è¿™äº›å·¥å…·å®æ—¶å‘Šè¯‰ä½ é›†æˆç»“æœï¼ˆé›†æˆæµ‹è¯•é€šå¸¸éœ€è¦èŠ±è´¹ä¸€å®šæ—¶é—´ï¼Œæœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œå°±å¯ä»¥åœ¨ç­‰å¾…ç»“æœè¿‡ç¨‹ä¸­ï¼Œå¹²åˆ«çš„äº‹æƒ…ï¼‰ï¼› JUnit/TestNGæµ‹è¯•æŠ¥å‘Šï¼šä¹Ÿå°±æ˜¯ç”¨ä»¥å›¾è¡¨ç­‰å½¢å¼æä¾›è¯¦ç»†çš„æµ‹è¯•æŠ¥è¡¨åŠŸèƒ½ï¼› æ”¯æŒåˆ†å¸ƒå¼æ„å»ºï¼šJenkinså¯ä»¥æŠŠé›†æˆæ„å»ºç­‰å·¥ä½œåˆ†å‘åˆ°å¤šå°è®¡ç®—æœºä¸­å®Œæˆï¼› æ–‡ä»¶æŒ‡çº¹ä¿¡æ¯ï¼šJenkinsä¼šä¿å­˜å“ªæ¬¡é›†æˆæ„å»ºäº§ç”Ÿäº†å“ªäº›äº§ç‰©æ–‡ä»¶ï¼Œå“ªä¸€æ¬¡é›†æˆæµ‹è¯•çš„ç¯å¢ƒæ˜¯å“ªä¸ªç‰ˆæœ¬éƒ¨ç½²çš„ç­‰è®°å½• æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶ï¼šä½¿å¾—Jenkins å˜å¾—è¶Šæ¥è¶Šå¼ºå¤§ï¼› Â¶éƒ¨ç½²JenkinsæœåŠ¡ å®‰è£…ç¯å¢ƒä»‹ç» ç³»ç»Ÿï¼šCentOS6.5_x64 Jenkinsï¼š2.19.3ï¼Œè·¯å¾„ä¸º /opt/soft/jenkins JDKï¼šjdk1.8.0_51ï¼Œè·¯å¾„ä¸º /opt/jdk1.8.0_51 æœºå™¨ IPï¼š10.70.71.235 å®‰è£… Jenkins æ–°å»º /opt/soft/jenkins ç›®å½• jenkins å®˜ç½‘ä¸‹è½½ war åŒ… å°† jenkins.war æ‹·è´åˆ°æ­¤ç›®å½•ä¸‹ åˆå§‹åŒ–è¿è¡Œï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé»˜è®¤ä»¥ç®¡ç†å‘˜èº«ä»½å¯åŠ¨è¿è¡Œ 123456cd /opt/soft/jenkins;export JAVA_HOME=/opt/jdk1.8.0_51;export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH;export JENKINS_HOME=/opt/soft/jenkins/workdir/;java -jar /opt/soft/jenkins/jenkins.war --httpPort=80//åœ¨æµè§ˆå™¨é‡Œè¾“å…¥ 10.70.71.235ï¼Œå¯ä»¥è¿›å…¥ Jenkins é…ç½® Jenkins ä»å·¦ä¾§é¢æ¿çš„â€œç³»ç»Ÿç®¡ç†â€æŒ‰é’®è¿›å…¥é…ç½®ç®¡ç†é¡µé¢ é¦–å…ˆç‚¹å‡»â€œç®¡ç†æ’ä»¶â€é¡µé¢ï¼Œåœ¨â€œé«˜çº§â€Tabé¡µä¸Šä¼ å¿…è¦çš„æ’ä»¶ï¼ŒåŒ…æ‹¬Gitã€Gitlab Authã€Role-Based Authorizationç­‰ ç„¶åè¿›å…¥â€œConfigure Global Securityâ€é¡µé¢ï¼Œå‹¾é€‰â€œå¯ç”¨å®‰å…¨â€ï¼Œå®‰å…¨åŸŸé‡Œé€‰æ‹©Gitlabç™»å½•ï¼Œå¹¶æ·»åŠ ç›¸å…³ä¿¡æ¯ åœ¨â€œConfigure Global Securityâ€é¡µé¢çš„å®‰å…¨åŸŸâ€œæƒé™â€ä¸­é€‰æ‹©â€œRole-Based Strategyâ€ï¼Œç„¶ååˆ°â€œManage and Assign Rolesâ€é¡µé¢é…ç½®é¡¹ç›®è§’è‰²å’Œæƒé™ åŸŸåæ˜ å°„ å¯åŠ¨æ—¶ï¼Œè®¾ç½® --httpPort=80ï¼Œå†ç”±ç½‘ç®¡æŒ‡å®šåŸŸå http://jenkins.haihangyun.com æ˜ å°„å³å¯ é›†æˆGitlabç™»å½•åï¼Œç”¨æˆ·ç™»å½•æ—¶ä¼šè·³è½¬åˆ°Gitlabé¡µé¢ï¼Œæ­¤æ—¶å¯ç”¨æµ·èˆªåŸŸè´¦å·ç™»å½•ï¼Œå®Œæˆåä¼šè·³è½¬å›åˆ°Jenkinsé¦–é¡µã€‚ Â¶Jenkinså‘å¸ƒæµæ°´çº¿ éƒ¨ç½²æµæ°´çº¿ï¼š Jenkinsæä¾›å¾ˆå¥½çš„æŒç»­é›†æˆ/äº¤ä»˜çš„æ”¯æŒã€‚ é€šå¸¸æµæ°´çº¿çš„è®¾è®¡æ˜¯ä»Gitlabè·å–ä»£ç æ›´æ–°å¼€å§‹çš„ï¼Œå¯¹äºå•å¼€å‘åˆ†æ”¯+å•å‘å¸ƒåˆ†æ”¯çš„é¡¹ç›®ï¼Œåº”è¯¥å¯¹åº”æœ‰ä¸¤æ¡ç”šè‡³å¤šæ¡æµæ°´çº¿ã€‚ ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„éƒ¨ç½²æµç¨‹å¦‚ä¸‹å›¾ï¼š åˆ›å»ºæµæ°´çº¿: è¿›å…¥jenkinsç•Œé¢åï¼Œç‚¹å‡»å·¦ä¸Šè§’æ–°å»ºæŒ‰é’®ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢ ä¾æ®éœ€è¦åˆ›å»ºå­ç›®å½•æˆ–æµæ°´çº¿ å¦‚æœéœ€è¦åˆ›å»ºçš„æ˜¯å­ç›®å½•ï¼Œåœ¨ç•Œé¢ä¸­å¡«å†™ç›®å½•åç§°ï¼Œå¹¶ä¸”é€‰æ‹©ä¸‹æ–¹çš„Folderé€‰é¡¹ ä¸ºåŒä¸€é¡¹ç›®æ­å»ºçš„æµæ°´çº¿åº”è¯¥æ”¾ç½®äºåŒä¸€ç›®å½•ä¸‹ã€‚ ç‚¹å‡»ä¿å­˜åï¼Œåœ¨ç•Œé¢ä¼šå‡ºç°æ–°å»ºçš„ç›®å½• ç‚¹å‡»ç›®å½•åç§°è¿›å…¥ç›®å½•å†…ï¼Œåœ¨å·¦ä¾§çš„æŒ‰é’®å¯ä»¥ç»§ç»­åˆ›å»ºå­ç›®å½•å’Œæµæ°´çº¿ã€‚ å¦‚æœåˆ›å»ºçš„æ˜¯æµæ°´çº¿ï¼Œå¡«å†™æµæ°´çº¿åç§°ï¼Œå¹¶é€‰æ‹©Pipelineé€‰é¡¹,æµæ°´çº¿çš„åˆ›å»ºå®Œæˆ Â¶Jenkinsé…ç½®æµæ°´çº¿å†…å®¹ æ‰“å¼€æ–°å»ºæµæ°´çº¿ï¼Œç‚¹å‡»å·¦ä¾§configureæŒ‰é’®ã€‚è¿›å…¥é…ç½®ç•Œé¢ã€‚å…·ä½“æœ‰ä¸¤ç§æ–¹å¼ï¼š ç›´æ¥å¡«å†™åœ¨ç•Œé¢ä¸­,é€‰æ‹©Pipeline scriptï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½¿ç”¨SCM,åœ¨Defintionéƒ¨åˆ†é€‰æ‹© Pipeline script from SCMã€‚åœ¨SCMç±»å‹ä¸­é€‰æ‹©Gitï¼Œå¡«å†™Pipeline scriptæ‰€åœ¨ä»£ç ä»“åº“å’Œåˆ†æ”¯ä»¥åŠè„šæœ¬æ–‡ä»¶è·¯å¾„ã€‚ è‡³æ­¤ä¸€æ¡æµæ°´çº¿æ­å»ºå®Œæˆã€‚ Â¶å…¸å‹çš„æµæ°´çº¿æ¨¡æ¿ å¯¹äºä¸åŒç±»å‹çš„åº”ç”¨ï¼Œæ‰€éœ€çš„æµæ°´çº¿ä¼šæœ‰å·®å¼‚ã€‚ä¾‹å¦‚Webåº”ç”¨é€šå¸¸éœ€è¦è®¾è®¡è‡ªåŠ¨åŒ–éƒ¨ç½²çš„æµç¨‹ï¼Œè€ŒMobileçš„åº”ç”¨åˆ™é€šå¸¸åªèƒ½åˆ°è¾¾æ‰“åŒ…çš„æ­¥éª¤ã€‚ ä»¥èšå®æ»™äº§å“ä¸ºä¾‹ã€‚ä¸€ä¸ªæ¯”è¾ƒè§„èŒƒçš„Webé¡¹ç›®æµæ°´çº¿å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354withEnv([&#x27;PATH=/usr/local/bin:$PATH&#x27;]) &#123; node &#123; stage(&#x27;ä»£ç æ›´æ–°&#x27;) &#123; checkout scm: [$class: &#x27;GitSCM&#x27;, branches: [[name: &#x27;*/dev&#x27;]], userRemoteConfigs: [[url: &#x27;git@gitbj.haihangyun.com:JBH/web.git&#x27;]]] &#125; stage(&#x27;å•å…ƒæµ‹è¯•&#x27;) &#123; sh &quot;phpunit&quot; &#125; stage(&#x27;ä»£ç æ£€æŸ¥&#x27;) &#123; sh &quot;sonar-scanner -Dsonar.login=&#x27;jenkins&#x27; -Dsonar.password=&#x27;jenkins&#x27; -Dsonar.host.url=http://sonar.haihangyun.com&quot; sh &quot;bash ./pipeline/checkSonarStatus.sh&quot; &#125; &#125; stage(&#x27;éƒ¨ç½²ç¡®è®¤&#x27;) &#123; timeout(time:1, unit:&#x27;HOURS&#x27;) &#123; milestone() input &quot;ç°åœ¨æ‰§è¡Œéƒ¨ç½²ï¼Ÿ&quot; &#125; &#125; node &#123; lock(resource: &#x27;WEB_PAAS&#x27;, inversePrecedence: true) &#123; stage(&#x27;éƒ¨ç½²PaaSäº‘ä¸»ç«™æœåŠ¡&#x27;) &#123; sh &#x27;bash ./pipeline/buildImage.sh dev&#x27; sh &#x27;bash ./pipeline/makesureImageReady.sh dev&#x27; sh &quot;bash ./pipeline/deployImage.sh dev&quot; sh &quot;bash ./pipeline/waitDeployment.sh dev&quot; &#125; stage(&#x27;éƒ¨ç½²PaaSäº‘æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡&#x27;) &#123; sh &#x27;bash ./pipeline/buildImage.sh dev -queue&#x27; sh &#x27;bash ./pipeline/makesureImageReady.sh dev -queue&#x27; sh &quot;bash ./pipeline/deployImage.sh dev -queue&quot; sh &quot;bash ./pipeline/waitDeployment.sh dev -queue&quot; &#125; stage(&#x27;æ¥å£æµ‹è¯•&#x27;) &#123; withEnv([&#x27;SERVICE_NAME=api-app&#x27;,&#x27;BACKEND_ADDR=&quot;http://devopsgroup-jbh-api-dev.haihangyun.com&quot;&#x27;]) &#123; dir(&#x27;api-test&#x27;) &#123; git url: &#x27;git@gitbj.haihangyun.com:JBH/api-doc.git&#x27; sh &#x27;npm run api-test&#x27; &#125; &#125; &#125; stage(&#x27;ç•Œé¢æµ‹è¯•&#x27;) &#123; withEnv([&#x27;PATH=/opt/jdk1.7.0_67/bin:/usr/local/bin:$PATH&#x27;,&#x27;JAVA_HOME=/opt/jdk1.7.0_67&#x27;]) &#123; dir(&#x27;e2e-test&#x27;) &#123; git url: &#x27;git@gitbj.haihangyun.com:JBH/e2e-test.git&#x27; sh &#x27;mvn clean test&#x27; &#125; &#125; &#125; milestone() &#125; &#125;&#125; è€ŒMobileçš„æµæ°´çº¿å†…å®¹çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š 12345678910111213141516171819202122232425262728293031withEnv([&#x27;PATH=/usr/local/bin:$PATH&#x27;]) &#123; node &#123; stage(&#x27;ä»£ç æ›´æ–°&#x27;) &#123; checkout scm: [$class: &#x27;GitSCM&#x27;, branches: [[name: &#x27;*/dev&#x27;]], userRemoteConfigs: [[url: &#x27;git@gitbj.haihangyun.com:JBH/app-android.git&#x27;]]] &#125; dir(&#x27;jbh&#x27;) &#123; stage(&#x27;å•å…ƒæµ‹è¯•&#x27;) &#123; sh &#x27;gradle clean test&#x27; &#125; stage(&#x27;ä»£ç æ£€æŸ¥&#x27;) &#123; sh &quot;sonar-scanner -Dsonar.login=&#x27;jenkins&#x27; -Dsonar.password=&#x27;jenkins&#x27; -Dsonar.host.url=http://sonar.haihangyun.com&quot; sh &quot;bash ./pipeline/checkSonarStatus.sh&quot; &#125; &#125; &#125; stage(&#x27;æ‰“åŒ…ç¡®è®¤&#x27;) &#123; timeout(time:6, unit:&#x27;HOURS&#x27;) &#123; milestone() input &quot;ç”Ÿæˆæ­¤ç‰ˆæœ¬çš„ApkåŒ…ï¼Ÿ&quot; &#125; &#125; node &#123; dir(&#x27;jbh&#x27;) &#123; stage(&#x27;ç”ŸæˆApk&#x27;) &#123; sh &quot;gradle build&quot; archiveArtifacts &#x27;build/app.apk&#x27; &#125; &#125; &#125;&#125; Â¶Jenkinsfileæ–‡ä»¶ç®¡ç† ä¾æ®Jenkinsçš„æƒ¯ä¾‹ï¼Œæµæ°´çº¿è„šæœ¬æ–‡ä»¶é€šå¸¸å‘½åä¸ºJenkinsfileï¼Œä¸é¡¹ç›®ä¸€èµ·å­˜æ”¾åˆ°ç‰ˆæœ¬ä»“åº“ä¸­ã€‚ åœ¨Jenkinsfileä¸­å¯èƒ½è¿˜éœ€è¦è°ƒç”¨å…¶ä»–è¾…åŠ©è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ç›¸å…³çš„æ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªç»Ÿä¸€çš„pipelineç›®å½•ä¸­ã€‚å½¢æˆç±»ä¼¼è¿™æ ·çš„ç»“æ„ï¼š 12345678pipelineâ”œâ”€â”€ Jenkinsfile.devâ”œâ”€â”€ Jenkinsfile.releaseâ”œâ”€â”€ Jenkinsfile.prodâ”œâ”€â”€ checkSonarStatus.shâ”œâ”€â”€ buildImage.shâ”œâ”€â”€ deployImage.shâ”œâ”€â”€ ... ... Â¶help Jenkins Stepå‚è€ƒï¼šhttps://jenkins.io/doc/pipeline/steps/ ä½¿ç”¨Jenkins Syntax","raw":null,"content":null,"categories":[],"tags":[{"name":"jenkins","slug":"jenkins","permalink":"http://blog.nicexiangcun.com/tags/jenkins/"}]},{"title":"ä»£ç æ•´æ´ä¹‹é“ä¹‹è£…é¥°è€…æ¨¡å¼","slug":"è£…é¥°è€…","date":"2017-04-23T13:15:08.000Z","updated":"2020-11-20T13:06:15.522Z","comments":true,"path":"2017/04/23/è£…é¥°è€…/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/23/%E8%A3%85%E9%A5%B0%E8%80%85/","excerpt":"è£…é¥°è€…æ¨¡å¼ï¼ˆç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼‰ï¼šé€šè¿‡åŠ¨æ€çš„ä»£ç†ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±æ–°å¢åŠ çš„åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°è€…æ¯”æ´¾ç”Ÿå­ç±»æ›´åŠ çµæ´»ã€‚\nè£…é¥°è€…æ¨¡å¼é‡‡ç”¨ç»„åˆçš„æ„å»ºæ–¹å¼,å¤§å¤§å‡å°‘äº†ç±»çš„æ•°é‡,ä¹Ÿæ‰“ç ´äº†æ‰©å±•åŠŸèƒ½ä¸€å®šè¦ä½¿ç”¨ç»§æ‰¿çš„æ€ç»´æƒ¯æ€§.ä½†æ˜¯è£…é¥°è€…æ¨¡å¼ä¼šäº§ç”Ÿè¿‡å¤šçš„å°ç±»,è¿‡åº¦åœ°ä½¿ç”¨ä¼šè®©ç¨‹åºå˜å¾—æ›´å¤æ‚\n\nå¦‚ä¸Šå›¾ï¼šWebServiceçš„renderDataèŒè´£æ˜¯è¿”å›String,ç°åœ¨éœ€è¦æ·»åŠ ä¸¤é¡¹èŒè´£ï¼šè¿”å›Xml å’Œ Json\né€šè¿‡ RendererDecoratoræ¥ä»£ç† JsonRenderer å’Œ XmlRenderer  è£…é¥°Webservice çš„è¿”å›ç»“æœã€‚","text":"è£…é¥°è€…æ¨¡å¼ï¼ˆç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼‰ï¼šé€šè¿‡åŠ¨æ€çš„ä»£ç†ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±æ–°å¢åŠ çš„åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°è€…æ¯”æ´¾ç”Ÿå­ç±»æ›´åŠ çµæ´»ã€‚ è£…é¥°è€…æ¨¡å¼é‡‡ç”¨ç»„åˆçš„æ„å»ºæ–¹å¼,å¤§å¤§å‡å°‘äº†ç±»çš„æ•°é‡,ä¹Ÿæ‰“ç ´äº†æ‰©å±•åŠŸèƒ½ä¸€å®šè¦ä½¿ç”¨ç»§æ‰¿çš„æ€ç»´æƒ¯æ€§.ä½†æ˜¯è£…é¥°è€…æ¨¡å¼ä¼šäº§ç”Ÿè¿‡å¤šçš„å°ç±»,è¿‡åº¦åœ°ä½¿ç”¨ä¼šè®©ç¨‹åºå˜å¾—æ›´å¤æ‚ å¦‚ä¸Šå›¾ï¼šWebServiceçš„renderDataèŒè´£æ˜¯è¿”å›String,ç°åœ¨éœ€è¦æ·»åŠ ä¸¤é¡¹èŒè´£ï¼šè¿”å›Xml å’Œ Json é€šè¿‡ RendererDecoratoræ¥ä»£ç† JsonRenderer å’Œ XmlRenderer è£…é¥°Webservice çš„è¿”å›ç»“æœã€‚ Â¶RenderableInterface æ¥å£ï¼ˆè¢«è£…é¥°è€…æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼‰ å¦‚ä¸‹ï¼š 123456&lt;?phpnamespace DesignPatterns\\Structural\\Decorator;interface RenderableInterface&#123; public function renderData(): string;&#125; Â¶Webserviceï¼ˆå…·ä½“è¢«è£…é¥°è€…ï¼‰ å¦‚ä¸‹ï¼š 1234567891011121314151617&lt;?phpnamespace DesignPatterns\\Structural\\Decorator;class Webservice implements RenderableInterface&#123; /** * @var string */ private $data; public function __construct(string $data) &#123; $this-&gt;data = $data; &#125; public function renderData(): string &#123; return $this-&gt;data; &#125;&#125; Â¶RendererDecorator ä»£ç†å¦‚ä¸‹(è£…é¥°è€…æŠ½è±¡ç±»)ï¼š 1234567891011121314151617&lt;?phpnamespace DesignPatterns\\Structural\\Decorator;abstract class RendererDecorator&#123; /** * @var RenderableInterface */ protected $wrapped; /** * @param RenderableInterface $renderer */ public function __construct(RenderableInterface $renderer) &#123; $this-&gt;wrapped = $renderer; &#125;&#125; Â¶å…·ä½“è£…é¥°è€… JsonRenderer 123456789&lt;?phpnamespace DesignPatterns\\Structural\\Decorator;class JsonRenderer extends RendererDecorator&#123; public function renderData(): string &#123; return json_encode($this-&gt;wrapped-&gt;renderData()); &#125;&#125; Â¶å…·ä½“è£…é¥°è€… XmlRenderer 123456789101112&lt;?phpnamespace DesignPatterns\\Structural\\Decorator;class XmlRenderer extends RendererDecorator&#123; public function renderData(): string &#123; $doc = new \\DOMDocument(); $data = $this-&gt;wrapped-&gt;renderData(); $doc-&gt;appendChild($doc-&gt;createElement(&#x27;content&#x27;, $data)); return $doc-&gt;saveXML(); &#125;&#125; Â¶test : 12345678910111213141516171819202122232425&lt;?phpnamespace DesignPatterns\\Structural\\Decorator\\Tests;use DesignPatterns\\Structural\\Decorator;use PHPUnit\\Framework\\TestCase;class DecoratorTest extends TestCase&#123; /** * @var Decorator\\Webservice */ private $service; protected function setUp() &#123; $this-&gt;service = new Decorator\\Webservice(&#x27;foobar&#x27;); &#125; public function testJsonDecorator() &#123; $service = new Decorator\\JsonRenderer($this-&gt;service); $this-&gt;assertEquals(&#x27;&quot;foobar&quot;&#x27;, $service-&gt;renderData()); &#125; public function testXmlDecorator() &#123; $service = new Decorator\\XmlRenderer($this-&gt;service); $this-&gt;assertXmlStringEqualsXmlString(&#x27;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;content&gt;foobar&lt;/content&gt;&#x27;, $service-&gt;renderData()); &#125;&#125; å¤‡æ³¨ï¼šè£…é¥°è€…å¯ä»¥è£…é¥°ï¼Œè£…é¥°è€…è¿”å›çš„ç»“æœã€‚","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"swoole å®‰è£…","slug":"swoole-å®‰è£…","date":"2017-04-19T14:59:56.000Z","updated":"2020-11-20T13:06:15.518Z","comments":true,"path":"2017/04/19/swoole-å®‰è£…/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/19/swoole-%E5%AE%89%E8%A3%85/","excerpt":"Â¶ä»releaseä¸Šé€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬cloneæºä»£ç  ğŸ˜‰\nsudo  git clone https://github.com/swoole/swoole-src.git\nÂ¶ç¼–è¯‘ç”Ÿæˆconfigureæ–‡ä»¶\nä¸€ ï¼š é€šè¿‡phpizeè„šæœ¬ç”Ÿæˆ\ncd swoole-src.git\nsudo /usr/bin/phpize7.0\nå¦‚æœæ²¡æœ‰æ‰¾åˆ°phpize å…ˆå®‰è£…phpize\n123sudo apt-get install autoconf automake libtool m4sudo apt-get install php7.0-devFor PHP7.1, use php7.1-dev","text":"Â¶ä»releaseä¸Šé€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬cloneæºä»£ç  ğŸ˜‰ sudo git clone https://github.com/swoole/swoole-src.git Â¶ç¼–è¯‘ç”Ÿæˆconfigureæ–‡ä»¶ ä¸€ ï¼š é€šè¿‡phpizeè„šæœ¬ç”Ÿæˆ cd swoole-src.git sudo /usr/bin/phpize7.0 å¦‚æœæ²¡æœ‰æ‰¾åˆ°phpize å…ˆå®‰è£…phpize 123sudo apt-get install autoconf automake libtool m4sudo apt-get install php7.0-devFor PHP7.1, use php7.1-dev äºŒ ï¼š é€šè¿‡configureç”Ÿæˆmakefile æ–‡ä»¶ 1sudo ./configure ä¸‰ ï¼šé€šè¿‡ makefile æ–‡ä»¶ç¼–è¯‘ç”Ÿæˆ .soæ–‡ä»¶ 123sudo makesudo make test //å¯é€‰sudo make install å›› ï¼šé…ç½® .ini 123456789101112cd /etc/php/7.0/mods-available/touch swoole.iniextension=swoole.sosudo ln -s /etc/php/7.0/mods-available/swoole.ini/etc/php/7.0/cli/conf.d/swoole.inisudo ln -s /etc/php/7.0/mods-available/swoole.ini/etc/php/7.0/fpm/conf.d/swoole.ini//fpmæ¨¡å¼ä¸‹éœ€è¦é‡å¯fpmï¼Œphpinfo æŸ¥çœ‹sudo service php7.0-fpm restartphp -m | grep swoole Â¶é€šè¿‡Cmakeå®‰è£… æŠŠswoole.soåšä¸ºä¸€ä¸ªCåº“","raw":null,"content":null,"categories":[{"name":"swoole","slug":"swoole","permalink":"http://blog.nicexiangcun.com/categories/swoole/"}],"tags":[{"name":"swoole","slug":"swoole","permalink":"http://blog.nicexiangcun.com/tags/swoole/"}]},{"title":"å¤§å‹ç½‘ç«™æŠ€æœ¯ç¯‡ä¹‹è´Ÿè½½å‡è¡¡","slug":"large-website-load-balance","date":"2017-04-17T14:03:03.000Z","updated":"2020-11-20T13:06:15.513Z","comments":true,"path":"2017/04/17/large-website-load-balance/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/17/large-website-load-balance/","excerpt":"","text":"Â¶æ¶æ„å›¾ Â¶è´Ÿè½½å‡è¡¡å·¥ä½œæ–¹å¼ Â¶http é‡å®šå‘ï¼ã€‹è½¬ç§»è¯·æ±‚ Â¶DNS è´Ÿè½½å‡è¡¡ å¤šæœºæˆ¿éƒ¨ç½²ï¼Œå°±è¿‘è®¿é—®ã€‚å¯ä»¥æŸ¥çœ‹googleçš„dnsé…ç½® ï¼š dig google.cn å¯ä»¥äº§çœ‹ google.cn çš„åŸŸååé¢é…ç½®çš„IP Â¶åå“ä»£ç†è´Ÿè½½å‡è¡¡ å·¥ä½œåœ¨ httpå±‚ï¼ˆä¸ƒå±‚ï¼‰å¸¸ç”¨ nginxåšä»£ç†è½¯ä»¶ Â¶IPè´Ÿè½½å‡è¡¡ å·¥ä½œåœ¨ ä¼ è¾“å±‚ (å››å±‚è½¬å‘è´Ÿè½½) ï¼Œé€šè¿‡è½¬å‘ipæ•°æ®åŒ…æ–¹å¼ï¼Œç¼ºç‚¹æ˜¯æ‰€æœ‰æ•°æ®å‡è¦é€šè¿‡è´Ÿè½½æœºå™¨ï¼Œè´Ÿè½½æœºå™¨çš„ç½‘ç»œå¸¦å®½ä¼šé€æ¸æˆä¸ºç“¶é¢ˆ Â¶LVS å·¥ä½œåœ¨ æ•°æ®é“¾è·¯å±‚ï¼ˆäºŒå±‚ï¼‰é€šè¿‡è™šæ‹ŸIPè½¬å‘webserver,2âƒ£webserverå¤„ç†å®Œæˆåç›´æ¥å“åº”ç»™å®¢æˆ·ç«¯ Â¶è´Ÿè½½å‡è¡¡å¸¸è§ç­–ç•¥ è½®è¯¢ åŠ æƒè½®è¯¢ æœ€å°é“¾æ¥æ•° ip hash","raw":null,"content":null,"categories":[],"tags":[{"name":"å¤§å‹ç½‘ç«™","slug":"å¤§å‹ç½‘ç«™","permalink":"http://blog.nicexiangcun.com/tags/%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99/"}]},{"title":"mysqlé”æœºåˆ¶","slug":"mysql","date":"2017-04-11T11:01:18.000Z","updated":"2020-11-20T13:06:15.514Z","comments":true,"path":"2017/04/11/mysql/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/11/mysql/","excerpt":"é”æœºåˆ¶ç”¨äºç®¡ç†å¯¹å…±äº«èµ„æºçš„å¹¶å‘è®¿é—®ï¼Œæä¾›æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§\n\nè¯»é”æ˜¯å…±äº«çš„ï¼Œä¸å½±å“å¹¶å‘çš„è¯»å–ï¼Œä½†æ˜¯ä¼šé˜»å¡å†™æ“ä½œï¼ˆå½“ç„¶è¿™åªæ˜¯é»˜è®¤æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®ï¼Œä½¿å…¶å¯ä»¥è¿›è¡Œæœ«å°¾æ’å…¥ï¼‰ï¼Œå†™é”æ˜¯æ’ä»–çš„ï¼Œé˜»å¡è¯»å’Œå†™ã€‚\n\nÂ¶è¡Œé”\nInnoDBè¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•è®°å½•åŠ é”æ¥å®ç°çš„ï¼Œå³ï¼šInnoDBä¼šåœ¨å®ƒæ‰«æåˆ°çš„æ¯æ¡ç´¢å¼•è®°å½•ä¸Šè®¾ç½®ä¸€ä¸ªSæˆ–Xé”ï¼Œåœ¨MVCCæ¨¡å¼ä¸‹ï¼Œç®€å•çš„selectè¯­å¥ä¸ä¼šåŠ ä»»ä½•é”ï¼Œé™¤éæ‰‹åŠ¨æ·»åŠ ã€‚å› æ­¤æŸ¥è¯¢æ—¶ï¼Œç´¢å¼•å¾ˆé‡è¦ ğŸ’¯\nÂ¶é”æ¨¡å¼\nå…±äº«é”S(Shared Lock)ï¼š å…è®¸äº‹åŠ¡ä½¿ç”¨è¯¥é”å»è¯»å–\nåŠ é”è¯­å¥ï¼š select â€¦ lock in share mode (æ‰‹åŠ¨åŠ é”)\næ’å®ƒé”X(Exclusive Lock)ï¼š å…è®¸äº‹åŠ¡ä½¿ç”¨è¯¥é”å»updateã€insertæˆ–è€…delete\nåŠ é”è¯­å¥ï¼š insert â€¦ update â€¦ delete â€¦ select â€¦ for update (æ‰‹åŠ¨åŠ é”)\nÂ¶é˜»å¡\nå› ä¸ºä¸åŒé”ä¹‹é—´çš„å…¼å®¹æ€§å…³ç³»ï¼Œåœ¨æœ‰äº›æ—¶åˆ»ä¸€ä¸ªäº‹åŠ¡ä¸­çš„é”éœ€è¦ç­‰å¾…å¦ä¸€äº‹åŠ¡ä¸­çš„é”é‡Šæ”¾å®ƒæ‰€å æœ‰çš„èµ„æºï¼Œé˜»å¡å¯ä»¥ç¡®ä¿äº‹åŠ¡æ­£å¸¸è¿›è¡Œ\nÂ¶æ­»é”\næŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ é™¤äº†è¶…æ—¶æœºåˆ¶å¤–ï¼ˆinnodb_lock_wait_timeoutï¼‰ï¼ŒInnoDBè¿˜é‡‡ç”¨äº†wait-for graphæ¥è¿›è¡Œæ­»é”æ£€æµ‹ï¼Œè‹¥æ£€æµ‹åˆ°æ­»é”ï¼ŒInnoDBä¼šé€‰æ‹©å›æ»šundoé‡æœ€å°çš„äº‹åŠ¡","text":"é”æœºåˆ¶ç”¨äºç®¡ç†å¯¹å…±äº«èµ„æºçš„å¹¶å‘è®¿é—®ï¼Œæä¾›æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ è¯»é”æ˜¯å…±äº«çš„ï¼Œä¸å½±å“å¹¶å‘çš„è¯»å–ï¼Œä½†æ˜¯ä¼šé˜»å¡å†™æ“ä½œï¼ˆå½“ç„¶è¿™åªæ˜¯é»˜è®¤æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®ï¼Œä½¿å…¶å¯ä»¥è¿›è¡Œæœ«å°¾æ’å…¥ï¼‰ï¼Œå†™é”æ˜¯æ’ä»–çš„ï¼Œé˜»å¡è¯»å’Œå†™ã€‚ Â¶è¡Œé” InnoDBè¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•è®°å½•åŠ é”æ¥å®ç°çš„ï¼Œå³ï¼šInnoDBä¼šåœ¨å®ƒæ‰«æåˆ°çš„æ¯æ¡ç´¢å¼•è®°å½•ä¸Šè®¾ç½®ä¸€ä¸ªSæˆ–Xé”ï¼Œåœ¨MVCCæ¨¡å¼ä¸‹ï¼Œç®€å•çš„selectè¯­å¥ä¸ä¼šåŠ ä»»ä½•é”ï¼Œé™¤éæ‰‹åŠ¨æ·»åŠ ã€‚å› æ­¤æŸ¥è¯¢æ—¶ï¼Œç´¢å¼•å¾ˆé‡è¦ ğŸ’¯ Â¶é”æ¨¡å¼ å…±äº«é”S(Shared Lock)ï¼š å…è®¸äº‹åŠ¡ä½¿ç”¨è¯¥é”å»è¯»å– åŠ é”è¯­å¥ï¼š select â€¦ lock in share mode (æ‰‹åŠ¨åŠ é”) æ’å®ƒé”X(Exclusive Lock)ï¼š å…è®¸äº‹åŠ¡ä½¿ç”¨è¯¥é”å»updateã€insertæˆ–è€…delete åŠ é”è¯­å¥ï¼š insert â€¦ update â€¦ delete â€¦ select â€¦ for update (æ‰‹åŠ¨åŠ é”) Â¶é˜»å¡ å› ä¸ºä¸åŒé”ä¹‹é—´çš„å…¼å®¹æ€§å…³ç³»ï¼Œåœ¨æœ‰äº›æ—¶åˆ»ä¸€ä¸ªäº‹åŠ¡ä¸­çš„é”éœ€è¦ç­‰å¾…å¦ä¸€äº‹åŠ¡ä¸­çš„é”é‡Šæ”¾å®ƒæ‰€å æœ‰çš„èµ„æºï¼Œé˜»å¡å¯ä»¥ç¡®ä¿äº‹åŠ¡æ­£å¸¸è¿›è¡Œ Â¶æ­»é” æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ é™¤äº†è¶…æ—¶æœºåˆ¶å¤–ï¼ˆinnodb_lock_wait_timeoutï¼‰ï¼ŒInnoDBè¿˜é‡‡ç”¨äº†wait-for graphæ¥è¿›è¡Œæ­»é”æ£€æµ‹ï¼Œè‹¥æ£€æµ‹åˆ°æ­»é”ï¼ŒInnoDBä¼šé€‰æ‹©å›æ»šundoé‡æœ€å°çš„äº‹åŠ¡ Â¶æ›´æ–°ä¸¢å¤± ç”±äºå¹¶å‘é—®é¢˜ï¼Œåœ¨äº‹åŠ¡å†…éƒ¨æœªæ­£ç¡®ä½¿ç”¨é”å®šå¯¼è‡´çš„æ›´æ–°ä¸¢å¤±é—®é¢˜ zhangshan --&gt; money = 20 Session A SessionB begin æŸ¥è¯¢money = 20 select money from account where user=â€˜zhangshanâ€™; &lt;br&gt; |begin;&lt;br&gt;æŸ¥è¯¢money = 20&lt;br&gt;select money from account where user='zhangshan';&lt;br&gt; update account set money=money+10 where user=â€˜zhangshanâ€™;commit; | | update account set money=money+50 where user=â€˜zhangshanâ€™;commit; æœ€ç»ˆçš„ç»“æœæ˜¯ï¼š70ï¼Œå°‘åŠ 10 è§£å†³åŠæ³•ï¼š select â€¦ for update é”å®šè¯¥æ¡è®°å½•ï¼ŒåŠ æ’å®ƒé” Session A SessionB beginå¯¹è¯¥æ¡è®°å½•åŠ æ’å®ƒé”XæŸ¥è¯¢money = 20select money from account where user=â€˜zhangshanâ€™ for update; &lt;br&gt; |begin;&lt;br&gt;è¢«é˜»å¡ï¼Œç¨‹åºæŒ‚èµ·ï¼Œç­‰å¾…Session Aå®Œæˆ&lt;br&gt;æŸ¥è¯¢money = 20&lt;br&gt;select money from account where user='zhangshan' for update;&lt;br&gt; update account set money=money+10 where user=â€˜zhangshanâ€™;commit; | |update account set money=money+50 where user=â€˜zhangshanâ€™;commit; Â¶æ­»é”äº§ç”Ÿçš„2ç§æƒ…å†µ 123456 CREATE TABLE b ( id int(11) NOT NULL, uid int(11) DEFAULT NULL, PRIMARY KEY (id), KEY uid (uid)) ENGINE=InnoDB DEFAULT CHARSET=utf8 id uid 1 10 2 20 3 30 4 40 Â¶ç¬¬ä¸€ç§æƒ…å†µï¼šåŒºé—´æ­»é”ï¼ˆç›®å‰æœ€å¤šçš„æƒ…å†µï¼‰ Session A SessionB begin;ä½¿ç”¨è¾…åŠ©ç´¢å¼•ç­›é€‰æ—¶ï¼Œæ­¤æ—¶ä½¿ç”¨Next-keyç®—æ³•é”å®šåŒºé—´ä¸º:(11,55)select * from b where uid=22 for update; &lt;br&gt; |begin;&lt;br&gt;æ­¤æ—¶Session Bè¢«é˜»å¡&lt;br&gt;select * from b where uid&lt;22 for update;&lt;br&gt; æ’å…¥æˆåŠŸâ€¦insert into b values(9,20);commit; | |æ­»é”å‡ºç°Deadlock foundï¼Œtry restarting transactionrollback; Â¶ç¬¬äºŒç§æƒ…å†µï¼šä¸åŒè®°å½•é”å®š Session A SessionB begin;idä¸ºä¸»é”®ï¼Œä½¿ç”¨Record Lockç®—æ³•é”å®šé”å®šid=5è¯¥è¡Œè®°å½•select * from b where id = 5 for update; &lt;br&gt; |begin;&lt;br&gt;åŒç†&lt;br&gt;select * from b where id=8 for update;&lt;br&gt; select * from b where id = 8 for update; | |æ­»é”å‡ºç°select * from b where id=5 for update;Deadlock foundï¼Œtry restarting transaction; commit | | rollback; Â¶å¦‚ä½•é¿å…é˜»å¡å’Œæ­»é”ï¼š updateæ—¶ï¼Œå°½é‡ä½¿ç”¨ä¸»é”®æˆ–è¾…åŠ©ç´¢å¼•ä½œä¸ºwhereæ¡ä»¶ï¼Œåˆ‡å‹¿ä¸ä½¿ç”¨ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦åˆ™å…¨è¡¨é”å®š è·‘è„šæœ¬æˆ–è€…æ‰¹é‡ä»»åŠ¡æ—¶ï¼Œæ¯æ¬¡åªå¯¹ä¸€æ¡æ•°æ®åŠ äº‹åŠ¡å¤„ç†ï¼Œåˆ‡å‹¿å°†ä¸€ä¸ªå¤§å¾ªç¯åŒ…è£¹åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢ ä¸¥ç¦åœ¨updateè¯­å¥é‡Œé¢å°è£…å­æŸ¥è¯¢ï¼Œselectè¯­å¥ï¼Œupdate â€¦ set â€¦ where â€¦å°±okï¼Œå…¶ä»–çš„ç”±ç¨‹åºå¤„ç† å…»æˆè‰¯å¥½çš„äº‹åŠ¡ä¹ æƒ¯ï¼Œäº‹åŠ¡ä¸€å®šè¦è¿›è¡Œcommitæˆ–rollbackæ“ä½œ æ¶‰åŠåˆ°ä¿®æ”¹åŒä¸€å¼ è¡¨æ•°æ®çš„å®šæ—¶ä»»åŠ¡ï¼Œåº”è¯¥é—´éš”ä¸€å®šçš„æ—¶é—´ï¼Œé¿å…å‡ºç°æ­»é” å‡å°‘é”å®šèŒƒå›´ï¼Œåœ¨è·‘å®šæ—¶ä»»åŠ¡æ—¶ï¼Œç­›é€‰æ•°æ®æ—¶ï¼Œå°¤å…¶æ˜¯æ—¥æœŸèŒƒå›´çš„ï¼Œè¯·åŠ¡å¿…ä½¿ç”¨between â€¦ and â€¦ è€Œä¸æ˜¯end_time &lt; now() Â¶éšå¼è½¬æ¢ æŸ¥è¯¢æ—¶ï¼Œç±»å‹ä¸å¯¹ï¼Œå¯¼è‡´ç±»å‹è½¬æ¢ï¼Œç»“æœä¸å¯¹ mysql&gt; select * from test_2 where name=0; id name 1 | lhw 2 | cxx 3 | 0 åˆ†æï¼šå¾ˆå¤šå¼€å‘åœ¨ä¹¦å†™sqlæ—¶ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°ä¼ å…¥åˆ°æ•°æ®åº“çš„å€¼çš„ç±»å‹ï¼Œæ¯”å¦‚ï¼šä¸Šé¢nameç±»å‹ä¸ºcharï¼Œè€Œä¼ å…¥æŸ¥è¯¢æ—¶ï¼Œå´è¾“å…¥çš„æ˜¯0ï¼Œè€Œä¸æ˜¯â€™0â€™ ç»“æœï¼šmysqlå¯¹åŒ¹é…åˆ°è¡Œçš„å­—ç¬¦ä¸²è¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œå‘ç°è½¬æ¢éæ³•ï¼Œè½¬æ¢æˆäº†0 æ³¨æ„ï¼šåœ¨æŸ¥è¯¢æ—¶æ£€æŸ¥ä¼ å…¥çš„æŸ¥è¯¢æ¡ä»¶ç±»å‹ å…¨è¡¨æ‰«æï¼ŒæŸ¥è¯¢æ…¢ mysql&gt; explain select * from xboss_account where mobile=15510337665; åˆ†æï¼šmobileå­—æ®µç±»å‹ä¸ºchar(11)ï¼ŒæŸ¥è¯¢æ—¶ï¼Œåº”è¯¥ä½¿ç”¨mobile=â€˜15510337665â€™ æ³¨æ„ï¼šåœ¨phpç«¯ä¹¦å†™sqlæ—¶ï¼Œåº”æ­£ç¡®ä¼ å…¥æŸ¥è¯¢å€¼çš„ç±»å‹ æ­£ç¡®ä½¿ç”¨ç±»å‹è½¬æ¢ï¼Œé˜²æ­¢SQLæ³¨å…¥ï¼Œå…¶å®ƒçš„ç±»å‹è½¬æ¢ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±ç ”ç©¶ï¼Œå¦‚ï¼šselect '11aa' + 11,select a+1ï¼Œselect '1'+1ç­‰","raw":null,"content":null,"categories":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/categories/mysql/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/tags/mysql/"}]},{"title":"å…³äºMysqlçš„ä¸€äº›æ€»ç»“","slug":"Mysql-æ€»ç»“","date":"2017-04-10T13:34:15.000Z","updated":"2020-11-20T13:06:15.509Z","comments":true,"path":"2017/04/10/Mysql-æ€»ç»“/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/10/Mysql-%E6%80%BB%E7%BB%93/","excerpt":"ğŸ›\nÂ¶äº‹åŠ¡æ¦‚å¿µï¼š\näº‹åŠ¡æ˜¯ç”±ä¸€ç»„SQLç»„æˆï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œåœ¨äº‹åŠ¡ä¸­ï¼Œæ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼Œå»ºè¡¨ç»Ÿä¸€ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“\n\nÂ¶äº‹åŠ¡çš„ACIDçš„ç‰¹æ€§ï¼š\nåŸå­æ€§(atomicity): äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šä¸€è‡´æ€§(consistency): åœ¨äº‹åŠ¡å¼€å§‹å’Œå®Œæˆæ—¶ï¼Œæ•°æ®éƒ½å¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€éš”ç¦»æ€§(isolation): ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æäº¤ä¹‹å‰å¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„æŒä¹…æ€§(durability):ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œå…¶æ‰€åšçš„ä¿®æ”¹ä¾¿ä¼šæ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­\n\nÂ¶äº‹åŠ¡ä½¿ç”¨åœºæ™¯ï¼š\nä¾‹å¦‚ä¸€ä¸ªé‡‘èå¹³å°ï¼Œå‡¡æ˜¯æ¶‰åŠåˆ°æ ¸å¿ƒä¸šåŠ¡ï¼Œæ¯”å¦‚ï¼šé‡‘é¢ã€ç§¯åˆ†ç­‰æ“ä½œéƒ½å¿…é¡»ä½¿ç”¨äº‹åŠ¡ï¼Œäº‹åŠ¡ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§\næ¯”å¦‚ç”¨æˆ·è´­ä¹°ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨äº‹åŠ¡ï¼ŒåŒæ—¶éœ€è¦ä½¿ç”¨select â€¦ for updateè¿›è¡Œæ•°æ®éªŒè¯ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§\n\nÂ¶ä¸éœ€è¦ä½¿ç”¨äº‹åŠ¡çš„åœºæ™¯ï¼š\nç”¨æˆ·ç™»å½•\nç”¨æˆ·èµ„äº§ï¼Œé’±åŒ…ï¼Œç§¯åˆ†ç­‰æŸ¥è¯¢ï¼Œå…è®¸ä¸€å®šçš„å»¶æ—¶\nå‡¡æ˜¯ä¸æ¶‰åŠåˆ°äº¤æ˜“çš„æŸ¥è¯¢\n\nÂ¶NULLçš„é—®é¢˜\nNULLï¼šå¯ä»¥æ’å…¥ç©ºå€¼æˆ–NULLï¼ŒNULLä¼šå ç”¨æ•°æ®åº“ç©ºé—´ï¼Œæ•°æ®åº“ä¼šè¯·æ±‚é¢å¤–çš„ç©ºé—´è®°å½•è¯¥è¡Œä¸ºNULL\nNOT NULLï¼šä¸å¯ä»¥æ’å…¥NULLï¼Œå¯ä»¥æ’å…¥ç©ºå€¼ï¼Œç©ºå€¼ä¸å ç”¨æ•°æ®åº“ç©ºé—´\nNULLå ç”¨ç©ºé—´ï¼Œç©ºå€¼ä¸å ç”¨ç©ºé—´ï¼ŒBæ ‘ç´¢å¼•ä¸ä¼šå­˜å‚¨NULLå€¼ï¼Œå¦‚æœç´¢å¼•å­—æ®µå¯ä»¥ä¸ºNULLï¼Œåˆ™æ•ˆç‡ä¸‹é™å¾ˆå¤š\né€šå¸¸å­—æ®µè®¾ç½®(NOT NULL) å¦‚æ—¶é—´å­—æ®µ NOT NULL DEFAULT 0000-00 00:00:00","text":"ğŸ› Â¶äº‹åŠ¡æ¦‚å¿µï¼š äº‹åŠ¡æ˜¯ç”±ä¸€ç»„SQLç»„æˆï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œåœ¨äº‹åŠ¡ä¸­ï¼Œæ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼Œå»ºè¡¨ç»Ÿä¸€ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“ Â¶äº‹åŠ¡çš„ACIDçš„ç‰¹æ€§ï¼š åŸå­æ€§(atomicity): äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šä¸€è‡´æ€§(consistency): åœ¨äº‹åŠ¡å¼€å§‹å’Œå®Œæˆæ—¶ï¼Œæ•°æ®éƒ½å¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€éš”ç¦»æ€§(isolation): ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æäº¤ä¹‹å‰å¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„æŒä¹…æ€§(durability):ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œå…¶æ‰€åšçš„ä¿®æ”¹ä¾¿ä¼šæ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ Â¶äº‹åŠ¡ä½¿ç”¨åœºæ™¯ï¼š ä¾‹å¦‚ä¸€ä¸ªé‡‘èå¹³å°ï¼Œå‡¡æ˜¯æ¶‰åŠåˆ°æ ¸å¿ƒä¸šåŠ¡ï¼Œæ¯”å¦‚ï¼šé‡‘é¢ã€ç§¯åˆ†ç­‰æ“ä½œéƒ½å¿…é¡»ä½¿ç”¨äº‹åŠ¡ï¼Œäº‹åŠ¡ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ æ¯”å¦‚ç”¨æˆ·è´­ä¹°ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨äº‹åŠ¡ï¼ŒåŒæ—¶éœ€è¦ä½¿ç”¨select â€¦ for updateè¿›è¡Œæ•°æ®éªŒè¯ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ Â¶ä¸éœ€è¦ä½¿ç”¨äº‹åŠ¡çš„åœºæ™¯ï¼š ç”¨æˆ·ç™»å½• ç”¨æˆ·èµ„äº§ï¼Œé’±åŒ…ï¼Œç§¯åˆ†ç­‰æŸ¥è¯¢ï¼Œå…è®¸ä¸€å®šçš„å»¶æ—¶ å‡¡æ˜¯ä¸æ¶‰åŠåˆ°äº¤æ˜“çš„æŸ¥è¯¢ Â¶NULLçš„é—®é¢˜ NULLï¼šå¯ä»¥æ’å…¥ç©ºå€¼æˆ–NULLï¼ŒNULLä¼šå ç”¨æ•°æ®åº“ç©ºé—´ï¼Œæ•°æ®åº“ä¼šè¯·æ±‚é¢å¤–çš„ç©ºé—´è®°å½•è¯¥è¡Œä¸ºNULL NOT NULLï¼šä¸å¯ä»¥æ’å…¥NULLï¼Œå¯ä»¥æ’å…¥ç©ºå€¼ï¼Œç©ºå€¼ä¸å ç”¨æ•°æ®åº“ç©ºé—´ NULLå ç”¨ç©ºé—´ï¼Œç©ºå€¼ä¸å ç”¨ç©ºé—´ï¼ŒBæ ‘ç´¢å¼•ä¸ä¼šå­˜å‚¨NULLå€¼ï¼Œå¦‚æœç´¢å¼•å­—æ®µå¯ä»¥ä¸ºNULLï¼Œåˆ™æ•ˆç‡ä¸‹é™å¾ˆå¤š é€šå¸¸å­—æ®µè®¾ç½®(NOT NULL) å¦‚æ—¶é—´å­—æ®µ NOT NULL DEFAULT 0000-00 00:00:00 ä»»ä½•æ•°å€¼çš„è¿ç®—å’Œå­—ç¬¦ç»„åˆï¼Œç»“æœéƒ½æ˜¯NULL mysql&gt; select 1+NULL, CONCAT('Invisible',NULL); 1+NULL CONCAT(â€˜Invisibleâ€™,NULL) NUL NULL NULLå…è®¸æ’å…¥å’ŒNULLï¼ŒæŸ¥è¯¢æ—¶å®¹æ˜“äº§ç”Ÿæ­§ä¹‰ mysql&gt; select * from test_1 where name &lt;&gt; ; id name 1 lhw mysql&gt; select * from test_1 where name is not null; id name 1 lhw 2 counté—®é¢˜ï¼Œå¿½ç•¥éä¸»é”®å¤–çš„nullå€¼ mysql&gt; select count(1),count(name) from test_1; count(1) count(name) 6 3 æ’åºé—®é¢˜ åœ¨order byæ’åºçš„æ—¶å€™ï¼Œå¦‚æœå­˜åœ¨NULLå€¼ï¼Œé‚£ä¹ˆNULLæ˜¯æœ€å°çš„ï¼ŒASCæ­£åºæ’åºçš„è¯ï¼ŒNULLå€¼æ˜¯åœ¨æœ€å‰é¢çš„ mysql&gt; select * from test_1 order by name asc; id name create_at 3 null null 2 null 5 lhw null è§£å†³åŠæ³•ï¼š 12select * from test_1 order by isnull(name) asc;select *,name is null as username from test_1 order by username asc; Â¶æµæ§åˆ¶å‡½æ•° Â¶caseè¯­æ³•ï¼š 12345CASE value WHEN [compare_value] THEN result [WHEN [compare_value] THEN result ...] [ELSE result] END&lt;=ç­‰ä»·äº=&gt;CASE WHEN [condition] THEN result [WHEN [condition] THEN result ...] [ELSE result] END Â¶ifè¯­æ³•ï¼š 1234IF(expr1,expr2,expr3)å¦‚æœexpr1ä¸ºTrueï¼Œè¿”å›expr2ï¼Œå¦åˆ™è¿”å›expr3 Â¶ifnullè¯­æ³•ï¼š 1234IFNULL(expr1,expr2)å¦‚æœexpr1ä¸ºnullï¼Œè¿”å›expr2 Â¶nullifè¯­æ³•ï¼š 1234NULLIF(expr1,expr2)å¦‚æœexpr1=expr2ï¼Œè¿”å›nullï¼Œå¦åˆ™è¿”å›expr1 Â¶éšå¼è½¬æ¢ æŸ¥è¯¢æ—¶ï¼Œç±»å‹ä¸å¯¹ï¼Œå¯¼è‡´ç±»å‹è½¬æ¢ï¼Œç»“æœä¸å¯¹ mysql&gt; select * from test_2 where name=0; id name 1 lhw 2 cxx 3 0 åˆ†æï¼šå¾ˆå¤šå¼€å‘åœ¨ä¹¦å†™sqlæ—¶ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°ä¼ å…¥åˆ°æ•°æ®åº“çš„å€¼çš„ç±»å‹ï¼Œæ¯”å¦‚ï¼šä¸Šé¢nameç±»å‹ä¸ºcharï¼Œè€Œä¼ å…¥æŸ¥è¯¢æ—¶ï¼Œå´è¾“å…¥çš„æ˜¯0ï¼Œè€Œä¸æ˜¯â€™0â€™ ç»“æœï¼šmysqlå¯¹åŒ¹é…åˆ°è¡Œçš„å­—ç¬¦ä¸²è¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œå‘ç°è½¬æ¢éæ³•ï¼Œè½¬æ¢æˆäº†0 æ³¨æ„ï¼šåœ¨æŸ¥è¯¢æ—¶æ£€æŸ¥ä¼ å…¥çš„æŸ¥è¯¢æ¡ä»¶ç±»å‹ å…¨è¡¨æ‰«æï¼ŒæŸ¥è¯¢æ…¢ mysql&gt; explain select * from xboss_account where mobile=15510337665; åˆ†æï¼šmobileå­—æ®µç±»å‹ä¸ºchar(11)ï¼ŒæŸ¥è¯¢æ—¶ï¼Œåº”è¯¥ä½¿ç”¨mobile=â€˜15510337665â€™ æ³¨æ„ï¼šåœ¨phpç«¯ä¹¦å†™sqlæ—¶ï¼Œåº”æ­£ç¡®ä¼ å…¥æŸ¥è¯¢å€¼çš„ç±»å‹ æ­£ç¡®ä½¿ç”¨ç±»å‹è½¬æ¢ï¼Œé˜²æ­¢SQLæ³¨å…¥ï¼Œå…¶å®ƒçš„ç±»å‹è½¬æ¢ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±ç ”ç©¶ï¼Œå¦‚ï¼šselect â€˜11aaâ€™ + 11,select a+1ï¼Œselect â€˜1â€™+1ç­‰ Â¶Group by group byä¸€èˆ¬å’Œèšåˆå‡½æ•°ä¸€èµ·ä½¿ç”¨æ‰æœ‰æ„ä¹‰ï¼Œåœ¨MySQL5.7å¼•å…¥äº†ONLY_FULL_GROUP_BYå¯¹è¯­æ³•åˆæ³•æ€§è¿›è¡Œæ£€æµ‹ ä½¿ç”¨group byçš„ä¸¤ä¸ªè¦ç´ ï¼š å‡ºç°åœ¨selectåé¢çš„å­—æ®µï¼Œè¦ä¹ˆæ˜¯èšåˆå‡½æ•°ä¸­çš„ï¼Œè¦ä¹ˆå°±æ˜¯group byä¸­çš„ï¼Œè‹¥æ˜¯è¯¥å­—æ®µæ—¢ä¸å‡ºç°åœ¨èšåˆå‡½æ•°ä¸­ï¼Œä¹Ÿä¸å‡ºç°åœ¨åé¢çš„group byä¸­ï¼Œåˆ™è¯¥æ¡selectè¯­å¥æ˜¯é”™è¯¯çš„ è‹¥æ˜¯éœ€è¦ç­›é€‰ç»“æœï¼Œå¯ä»¥å…ˆä½¿ç”¨whereï¼Œå†ç”¨group byï¼›æˆ–è€…å…ˆç”¨group byï¼Œå†ç”¨having ä¸ºä»€ä¹ˆè¦æ±‚ä½¿ç”¨èšåˆå‡½æ•°ï¼š åœ¨æœªä½¿ç”¨èšåˆå‡½æ•°çš„æƒ…å†µä¸‹ï¼Œå¦‚æœgroup byåé¢çš„å­—æ®µä¸å”¯ä¸€ï¼Œåˆ™ä¼šå‡ºç°æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ä¸å¯¹ Â¶Sql modeé—®é¢˜ sql_modeé€šè¿‡æ£€æµ‹sqlçš„åˆæ³•æ€§æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ å¸¸ç”¨åˆ°çš„è®¾ç½®ï¼š STRICT_TRANS_TABLES å¦‚æœä¸èƒ½å°†ç»™å®šçš„å€¼æ’å…¥åˆ°äº‹åŠ¡è¡¨ä¸­ï¼Œåˆ™æ”¾å¼ƒè¯¥è¯­å¥ï¼Œå¯¹äºéäº‹åŠ¡è¡¨ï¼Œå¦‚æœå‡ºç°åœ¨å•è¡Œè¯­å¥æˆ–å¤šè¡Œè¯­å¥çš„ç¬¬ä¸€è¡Œï¼Œåˆ™æ”¾å¼ƒè¯¥è¯­å¥ NO_ENGINE_SUBSTITUTION å½“ä½¿ç”¨create tableæˆ–è€…alter tableæ—¶ï¼Œè‡ªåŠ¨æ§åˆ¶æ›¿æ¢å­˜å‚¨å¼•æ“ ONLY_FULL_GROUP_BY å®ç°sqlè¯­å¥åˆæ³•æ€§æ£€æµ‹ å¯¹äºgroup by columnè¡¨è¾¾å¼ï¼Œselectåˆ—å¿…é¡»ä½¿ç”¨èšåˆå‡½æ•°ï¼Œå¦åˆ™æŠ¥é”™ï¼Œå¦‚ï¼š select group_concat(id1),id2 from test_1 group by id2; Â¶æ²¡æœ‰å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œå¼•èµ·çš„é—®é¢˜ï¼š ä¸€ æ¯”å¦‚ï¼šfreeze_scoreä¸ä¸ºè´Ÿæ•°ï¼Œå³ï¼šunsigned update xboss_integrals set freeze_score = 500-1000, updated_at = â€˜2016-07-04 16:51:20â€™ where id = â€˜562â€™; æ­¤æ—¶freeze_scoreä¼šè¢«è®¾ç½®ä¸º0ï¼Œwarningè­¦å‘Šä¸ä¼šè¢«è¿”å›ç»™apiç«¯ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ äºŒ æ¯”å¦‚ï¼šmobileå­—æ®µä¸ºint(11) update zz set phone=â€˜188qwewqâ€™ where id=8; æ­¤æ—¶phoneå­—æ®µä¼šè¢«è®¾ç½®ä¸º188ï¼Œwarningè­¦å‘Šä¸ä¼šè¢«è¿”å›ç»™apiç«¯ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ Â¶JOINè¯­æ³• æ­¤å¤„åªè¯´MySQLæœ€å¸¸ç”¨çš„ä¸¤ç§joinç±»å‹ï¼Œinner join å’Œ {LEFT|RIGHT} [OUTER] join åœ¨MySQLä¸­çš„JOINï¼ŒCROSS JOINå’ŒINNER JOINå’Œâ€™,'åœ¨å¥æ³•ä¸Šç›¸åŒ,å¯ä»¥äº’ç›¸æ›¿æ¢ä½¿ç”¨ã€‚ä½†æ˜¯åœ¨æ ‡å‡†çš„SQLä¸­ï¼Œå®ƒä»¬æ˜¯ä¸åŒçš„ inner join(å†…è¿æ¥)ï¼š å°†Aè¡¨å’ŒBè¡¨ä¸­å­˜åœ¨è¿æ¥å…³ç³»çš„å­—æ®µï¼Œç»„æˆçš„ç»“æœé›†(Aè¡¨å’ŒBè¡¨çš„äº¤é›†) left join(å·¦è¿æ¥,å±äºå¤–è¿æ¥): ä»¥å·¦è¡¨ä¸ºå‡†ï¼Œå»å³è¡¨æ‰¾æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…çš„æ•°æ®ï¼Œåˆ™ä»¥nullè¡¥ä½å³è¡¨çš„æ•°æ®ï¼Œæ‰€ä»¥è¾“å‡ºç»“æœæ•°ä¸ºå·¦è¡¨åŸæ•°æ®é›†(right joinåŒç†) tipsï¼šleft join å¯ä»¥è½¬æ¢ä¸º inner join 123select * from a inner join b on a.id=b.id;&lt;==&gt;select * from a left join b on a.id=b.id where b.id is not null; Â¶å¸¸ç”¨å­—ç¬¦å¤„ç†å‡½æ•° concat(str1,str2,...) æŠŠç»™å®šå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²,é€‚ç”¨äºå¤šä¸ªæ•°æ®åˆ— select concat(firstname,lastname) as fullname from user; concat_ws(separator,str1,str2,...) ä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦å°†ç»™å®šçš„å­—ç¬¦ä¸²æˆ–åˆ—åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² select concat_ws('-',id,name) from pp; ELT(N,str1,str2,str3,...) è¿”å›å­—ç¬¦ä¸²åˆ—è¡¨çš„ç¬¬å‡ ä¸ªå…ƒç´ ï¼Œå½“Nä¸º1æ—¶ï¼Œè¿”å›str1ï¼Œä¸º2æ—¶ï¼Œè¿”å›str2ï¼Œå½“Nå¤§äºå­—ç¬¦ä¸²åˆ—è¡¨é•¿åº¦æ—¶ï¼Œè¿”å›NULL select elt(2,'hello','world'); â€“&gt;world SUBSTRING(str,pos),SUBSTRING(strFROMpos),SUBSTRING(str,pos,len), SUBSTRING(str FROM pos FOR len) æˆªå–å­—ç¬¦ä¸²ï¼Œé»˜è®¤èµ·å§‹ä½ç½®ä¸º1ï¼Œç»“æŸä½ç½®ä¸º-1 ä»ç¬¬äº”ä¸ªå­—ç¬¦å¼€å§‹æˆªå– SELECT SUBSTRING('Quadratically',5); â€“&gt;ratically ä»ç¬¬å››ä¸ªå­—ç¬¦å¼€å§‹æˆªå– SELECT SUBSTRING('foobarbar' FROM 4); â€“&gt;barbar ä»ç¬¬äº”ä¸ªå­—ç¬¦å¼€å§‹æˆªå–ï¼Œæˆªå–é•¿åº¦ä¸º6ä¸ªå­—ç¬¦ SELECT SUBSTRING('Quadratically',5,6); â€“&gt;ratica ä»å€’æ•°ç¬¬ä¸‰ä¸ªå­—ç¬¦æˆªå– SELECT SUBSTRING('Sakila', -3); â€“&gt;ila ä»å€’æ•°ç¬¬4ä¸ªå­—ç¬¦å¼€å§‹ï¼Œæˆªå–é•¿åº¦ä¸º2ä¸ªå­—ç¬¦ SELECT SUBSTRING('Sakila' FROM -4 FOR 2); â€“&gt;ki substring_index(str,delim,count) æˆªå–å­—ç¬¦ä¸²ï¼Œsubstring_index('www.mysql.com','.',2)ï¼Œä»¥é€—å·åˆ†éš”ï¼Œæˆªå–ï¼šwww.mysql select substring_index(sitename,'.',-2) from siteinfo where id=2; æˆªå–ç»“æœä¸º:mysql.com mid(str,pos,len)æˆªå–å­—ç¬¦ä¸²,mid('helloworld',7,12)ï¼Œæˆªå–ç¬¬7ä¸ªåˆ°ç¬¬12ä¸ªå­—ç¬¦ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œç»“æœä¸ºï¼šworld select mid(username,6,5) from userinfo; left(str,len)&lt;=&gt;right(str,len) æˆªå–å­—ç¬¦ä¸²ï¼Œleft('hello world',5)ï¼Œæˆªå–å·¦è¾¹5ä¸ªå­—ç¬¦ select right(username,5) from userinfo; replace(str,from_str,to_str) æ›¿æ¢å­—ç¬¦ä¸² å°†usernameåˆ—ä¸­çš„zhangå§“å…¨éƒ¨æ”¹ä¸ºliå§“ update user set username=replace(username,'zhang','li'); instr(str,substr) è¿”å›æŒ‡å®šå­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œinstr('welcome you baby,','you'),è¿”å›ä½ç½®ä¸ºï¼š9 select instr(username,'shan') as pos from userinfo where uid=1; find_in_set(str,strlist) è¿”å›å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²åˆ—è¡¨ä¸­çš„ä½ç½®ï¼Œå­—ç¬¦ä¸²åˆ—è¡¨å¿…é¡»ä»¥é€—å·â€™,'åˆ†éš”ï¼Œèµ·å§‹å€¼ä¸ºï¼š1 select find_in_set('shi','wo,shi,chinese') as pos; è¿”å›å€¼ä¸º2 TRIM([&#123;BOTH | LEADING | TRAILING&#125; [remstr] FROM] str), TRIM([remstr FROM] str) ç§»é™¤æŒ‡å®šçš„å­—ç¬¦ï¼Œbothè¡¨ç¤ºå‰åï¼Œleadingï¼šå‰é¢ï¼Œtrailingï¼šåé¢ ç§»é™¤å­—ç¬¦ä¸²å‰åçš„ç©ºæ ¼ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸ºbothï¼Œç§»é™¤ç©ºæ ¼ select trim(' bar '); â€“&gt;bar ç§»é™¤å­—ç¬¦ä¸²å‰é¢çš„x SELECT TRIM(LEADING 'x' FROM 'xxxbarxxx'); â€“&gt;barxxx ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„x SELECT TRIM(BOTH 'x' FROM 'xxxbarxxx'); â€“&gt;bar ç§»é™¤å­—ç¬¦ä¸²åé¢çš„xyz SELECT TRIM(TRAILING 'xyz' FROM 'barxxyz'); â€“&gt;barx Â¶å¸¸ç”¨æ—¶é—´å‡½æ•° CURDATE(),CURTIME() ä»¥â€™YYYY-MM-DDâ€™æ ¼å¼è¿”å›å½“å‰æ—¥æœŸ select curdate(); â€“&gt;2016-07-05 ä»¥â€™YYYYMMDDâ€™æ ¼å¼è¿”å›å½“å‰æ—¥æœŸï¼Œ+0è¡¨ç¤º+0å¤© select curdate()+0; â€“&gt;20160705 ä»¥â€™HH:MM:SSâ€™æ ¼å¼è¿”å›å½“å‰æ—¶é—´ select curtime(); â€“&gt;15:17:30 ä»¥â€™HHMMSSâ€™æ ¼å¼è¿”å›å½“å‰æ—¶é—´,+0è¡¨ç¤º+0ç§’ select curtime()+0; â€“&gt;151855 DATE(),TIME() è¿”å›æ—¶é—´è¡¨è¾¾å¼çš„æ—¥æœŸéƒ¨åˆ† select date(now()); â€“&gt;2016-07-05 è¿”å›æ—¶é—´è¡¨è¾¾å¼çš„æ—¶é—´éƒ¨åˆ† select time(now()); â€“&gt;15:14:16 DATEDIFF(expr1,expr2),TIMEDIFF(expr1,expr2) è¿”å›expr1-expr2ç›¸å·®çš„å¤©æ•°ï¼Œå¿½ç•¥æ—¶é—´éƒ¨åˆ† select datediff(now(),â€˜2016-6-12 12:00:00â€™); â€“&gt;23 è¿”å›expr1-expr2ç›¸å·®çš„æ—¶é—´ select timediff(now(),â€˜2016-6-12 12:00:00â€™); â€“&gt;555:24:52 FROM_UNIXTIME(unix_timestamp),FROM_UNIXTIME(unix_timestamp,format) æ ¼å¼åŒ–unixæ—¶é—´æˆ³æˆâ€™YYYY-MM-DD HH:MM:SSâ€™ or YYYYMMDDHHMMSSæ ¼å¼ select from_unixtime(1467703739,â€˜%Y %M %D %h:%i:%sâ€™) â€“&gt;2016 July 5th 03:28:59 select from_unixtime(1467703739); â€“&gt;2016-07-05 15:28:59 TIMESTAMP(expr),TIMESTAMP(expr1,expr2) å½“ä¸€ä¸ªå‚æ•°æ—¶ï¼Œæ ¼å¼åŒ–ä¸ºdatetimeç±»å‹ï¼Œå½“ä¸º2ä¸ªå‚æ•°æ—¶ï¼Œexpr2å°†ä¼šå¯¹expr1çš„æ—¥æœŸæˆ–æ—¶é—´éƒ¨åˆ†è¿›è¡Œç›¸åŠ  select timestamp(â€˜2016-07-03â€™); â€“&gt;2016-07-03 00:00:00 SELECT TIMESTAMP(â€˜2003-12-31 12:00:00â€™,â€˜09:00:00â€™); â€“&gt;2003-12-31 21:00:00 UNIX_TIMESTAMP()è¿”å›unixæ—¶é—´æˆ³ select unix_timestamp(â€˜2015-08-12 13:57:51â€™); â€“&gt;1439359071 DATE_FORMAT(date,format)ï¼ŒTIME_FORMAT(time,format) æ ¼å¼åŒ–dateæˆæŒ‡å®šç±»å‹ select date_format(now(),â€˜%Y-%m-%dâ€™); â€“&gt;2016-07-05 DATE_ADD(date,INTERVAL expr unit), DATE_SUB(date,INTERVAL expr unit) æ—¶é—´åŠ å‡ åŠ 10åˆ†é’Ÿ select date_add(now(), interval 10 minute); â€“&gt;2016-07-05 15:57:17 å‡10åˆ†é’Ÿ select date_sub(now(), interval 10 minute); â€“&gt;2016-07-05 15:37:47 è®¾ç½®æ—¶é—´ä¸º24å°æ—¶ä¹‹å‰ set @time_before_24= (select date_sub(now(),interval 24 hour)); Â¶æ¶æ„ç»„ä»¶ Â¶MaxScale è‡ªåŠ¨è¯»å†™åˆ†ç¦» è‡ªåŠ¨å‰”é™¤å»¶è¿Ÿè¶…è¿‡30sçš„ä»åº“ è¯»è´Ÿè½½ æœ€å°åŒ–å®•æœºæ—¶é—´ Â¶MHA è‡ªåŠ¨æ•…éšœæ¢æµ‹ï¼Œæ¢å¤ å·®å¼‚æ—¥å¿—åº”ç”¨ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ Â¶Pacemaker + Corosync æä¾›å¿ƒè·³æ£€æµ‹å’Œè‡ªåŠ¨æ•…éšœåˆ‡æ¢ï¼Œä¿è¯MaxScaleçš„é«˜å¯ç”¨ Â¶Box Anemometer æ…¢æŸ¥è¯¢åˆ†æç³»ç»Ÿï¼Œæ¯5åˆ†é’Ÿè‡ªåŠ¨é‡‡é›†æ…¢æŸ¥è¯¢æ—¥å¿—å¹¶æ±‡æ€» Â¶Binlog Server è´Ÿè´£ä¸­ç»§Binlogï¼Œå¹¶åŠ å¯†å¤åˆ¶ç»™æµ·å£æœºæˆ¿ Â¶æ•°æ®å®‰å…¨ Â¶æ•°æ®å®¡æ ¸ æ˜å¾¡æ•°æ®åº“å®¡è®¡ä¸é£é™©æ§åˆ¶ç³»ç»Ÿæä¾›å‡†å®æ—¶çš„æ•°æ®æ“ä½œå®¡æ ¸è®°å½• Â¶æ•°æ®å¤‡ä»½ æ¯å¤©å…¨é‡å¤‡ä»½å¹¶åŠ å¯† æ¯å¤©å•è¡¨å¤‡ä»½å¹¶åŠ å¯† å®æ—¶binlogå¢é‡å¤‡ä»½ ç¾å¤‡ç³»ç»Ÿ Â¶Sphinx Â¶è§„èŒƒ æ‰‹æœºå·ï¼šé•¿åº¦&gt;=7ä¸ªå­—ç¬¦ å§“åï¼šé•¿åº¦&gt;=2ä¸ªå­—ç¬¦ æ¨¡ç³ŠæŸ¥è¯¢ç»“æœç»Ÿä¸€æœ€å¤§å–1Wï¼šlimit=10000,maxmatches=10000 è¡¨ï¼šxboss_sphinx_counts è§£å†³åå°åˆ†é¡µï¼ˆåŒ…å«whereæ¡ä»¶çš„countï¼Œè¯·ç›´æ¥å»åŸåº“æŸ¥è¯¢ï¼‰ï¼Œä¾‹å¥ï¼š select count(*) from xboss_account; å·²æ”¯æŒè¡¨ï¼š xboss_account,xboss_user_orders ä¾‹å­ï¼ˆéœ€è¦å¯¹xboss_accountè¡¨è¿›è¡Œcountï¼Œå¹¶è®¡ç®—åå°æ˜¾ç¤ºé¡µæ•°ï¼‰ï¼š select table_rows from xboss_sphinx_counts where query='*xboss_account*'; xboss_accountå¿…é¡»è·Ÿä¸Š*å· è¡¨ï¼šxboss_account_sphinx è§£å†³æ¨¡ç³ŠæŸ¥è¯¢å’Œæ¨¡ç³ŠjoinæŸ¥è¯¢ï¼š ç´¢å¼•xboss_accountè¡¨çš„true_nameï¼Œmobileå­—æ®µ Â¶SphinxSE SQLè¯­æ³•ï¼š è¯­æ³•ï¼šlimit,offet,maxmatches limité»˜è®¤ä¸º20ï¼Œoffseté»˜è®¤ä¸º0ï¼Œmaxmatchesé»˜è®¤ä¸º1000ï¼ˆrowsï¼‰ ä¾‹å­ï¼š 1234567select * from xboss_account_sphinx where query=&#x27;*18810*;limit=2000;maxmatches=100&#x27;;--&gt;è¾“å‡º100è¡Œç»“æœselect * from xboss_account_sphinx where query=&#x27;*18810*;limit=2000&#x27;;--&gt;è¾“å‡º1000è¡Œç»“æœ å¼•ç”¨ç´¢å¼•å­—æ®µ '@'å¼•ç”¨ç´¢å¼•å­—æ®µ,å¦‚ï¼š@mobileï¼Œ@true_nameï¼Œ| è¡¨ç¤º andï¼Œå¿…é¡»åŠ ä¸Šï¼šmode=extended å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™æ£€ç´¢æ‰€æœ‰çš„ç´¢å¼•å­—æ®µ ä¸‹é¢æŸ¥è¯¢true_nameåŒ…å«â€˜ä»˜â€™ï¼Œä¸”æ‰‹æœºå·åŒ…å«â€˜18622â€™çš„ç”¨æˆ· 1select b.true_name,b.mobile from xboss_account_sphinx a join xboss_account b on a.uid=b.uid where b.is_auth=&#x27;1&#x27; and a.query=&#x27;@mobile *18622* | @true_name *ä»˜*;mode=extended;limit=10000;maxmatches=10000&#x27; limit 15 offset 0; filter filter åªæ”¯æŒintç±»å‹ é‡‡ç”¨filter=å­—æ®µåç§°,å€¼å°±ç›¸å½“äºwhereä¸­çš„å­—æ®µå=å€¼ï¼Œfilteræåˆ°çš„å­—æ®µå¿…é¡»åœ¨sphinxçš„sourceéƒ¨åˆ†çš„å­—æ®µå±æ€§å®šä¹‰ä¸­å®šä¹‰ ä¾‹å¥ï¼šæŸ¥è¯¢is_authä¸º1çš„ç”¨æˆ·ï¼Œä¸ç­‰äºï¼š!filter=is_auth,1ï¼ŒèŒƒå›´ï¼šfilter=is_auth,1,2,3 1select b.true_name,b.mobile,b.created_at,b.updated_at from xboss_account_sphinx a join xboss_account b on a.uid=b.uid where a.query=&#x27;@mobile *18622* | @true_name *ä»˜*;mode=extended;limit=10000;maxmatches=10000;filter=is_auth,1&#x27; order by b.created_at limit 15 offset 0; Â¶åˆ†é¡µï¼ˆåœ¨å¤–éƒ¨å®ç°ï¼‰ 1select a.*,b.mobile,b.true_name from xboss_wallet_records a join xboss_account b join xboss_account_sphinx c on a.uid = b.uid and a.uid = c.uid where a.`type_new` != &#x27;4&#x27; and c.query=&#x27;*1881048*;limit=10000;maxmatches=10000&#x27; order by a.id desc limit 15 offset 0; Â¶andæˆ–oræŸ¥è¯¢ andæŸ¥è¯¢ï¼Œç”¨|åˆ†éš” 123set names utf8;select * from xboss_account_sphinx a join xboss_wallet_records b on a.uid=b.uid where a.query=&#x27;@mobile *18622* | @true_name *ä»˜*;mode=extended;limit=10000;maxmatches=10000&#x27;\\G; Â¶oræŸ¥è¯¢ 1select b.username from xboss_account_sphinx a join xboss_wallet_records b on a.uid=b.uid where a.query =&#x27;*1881048*;limit=10000;maxmatches=10000&#x27; or a.query=&#x27;*ä»˜*;limit=10000;maxmatches=10000&#x27;\\G;","raw":null,"content":null,"categories":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/categories/mysql/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/tags/mysql/"}]},{"title":"å‘½ä»¤è¡Œä¸‹mysqläº‹åŠ¡æ§åˆ¶æ–¹æ³•","slug":"Mysql-item-äº‹åŠ¡","date":"2017-04-10T13:18:02.000Z","updated":"2020-11-20T13:06:15.509Z","comments":true,"path":"2017/04/10/Mysql-item-äº‹åŠ¡/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/10/Mysql-item-%E4%BA%8B%E5%8A%A1/","excerpt":"æŸ¥çœ‹mysqlç³»ç»Ÿçš„äº‹åŠ¡éš”ç¦»çº§åˆ« â˜ºï¸\n12345678mysql&gt; SELECT @@global.tx_isolation;+-----------------------+| @@global.tx_isolation |+-----------------------+| REPEATABLE-READ       |+-----------------------+1 row in set (0.00 sec)\næŸ¥çœ‹mysqlä¼šè¯çš„äº‹åŠ¡éš”ç¦»çº§åˆ«\n123456789101112131415mysql&gt; SELECT @@tx_isolation;+-----------------+| @@tx_isolation  |+-----------------+| REPEATABLE-READ |+-----------------+1 row in set (0.00 sec)mysql&gt; SELECT @@session.tx_isolation;+------------------------+| @@session.tx_isolation |+------------------------+| REPEATABLE-READ        |+------------------------+1 row in set (0.00 sec)","text":"æŸ¥çœ‹mysqlç³»ç»Ÿçš„äº‹åŠ¡éš”ç¦»çº§åˆ« â˜ºï¸ 12345678mysql&gt; SELECT @@global.tx_isolation;+-----------------------+| @@global.tx_isolation |+-----------------------+| REPEATABLE-READ |+-----------------------+1 row in set (0.00 sec) æŸ¥çœ‹mysqlä¼šè¯çš„äº‹åŠ¡éš”ç¦»çº§åˆ« 123456789101112131415mysql&gt; SELECT @@tx_isolation;+-----------------+| @@tx_isolation |+-----------------+| REPEATABLE-READ |+-----------------+1 row in set (0.00 sec)mysql&gt; SELECT @@session.tx_isolation;+------------------------+| @@session.tx_isolation |+------------------------+| REPEATABLE-READ |+------------------------+1 row in set (0.00 sec) è®¾ç½®ç³»ç»Ÿçš„äº‹åŠ¡éš”ç¦»çº§åˆ« 123456789101112131415161718mysql&gt; set global transaction isolation level read committed;Query OK, 0 rows affected (0.00 sec)mysql&gt; SELECT @@global.tx_isolation;+-----------------------+| @@global.tx_isolation |+-----------------------+| READ-COMMITTED |+-----------------------+1 row in set (0.00 sec)mysql&gt; SELECT @@tx_isolation;+-----------------+| @@tx_isolation |+-----------------+| REPEATABLE-READ |+-----------------+1 row in set (0.00 sec) è®¾ç½®ä¼šè¯çš„äº‹åŠ¡éš”ç¦»çº§åˆ« 12345678910111213141516171819mysql&gt; set session transaction isolation level read committed;Query OK, 0 rows affected (0.00 sec)mysql&gt; SELECT @@global.tx_isolation;+-----------------------+| @@global.tx_isolation |+-----------------------+| READ-COMMITTED |+-----------------------+1 row in set (0.00 sec)mysql&gt; SELECT @@tx_isolation;+----------------+| @@tx_isolation |+----------------+| READ-COMMITTED |+----------------+1 row in set (0.00 sec) mysqlé»˜è®¤æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡çš„ï¼ŒæŸ¥çœ‹autocommitå˜é‡ 12345678mysql&gt; select @@autocommit;+--------------+| @@autocommit |+--------------+| 1 |+--------------+1 row in set (0.01 sec) è®¾ç½®mysqlä¸è‡ªåŠ¨æäº¤äº‹åŠ¡ 12345678910mysql&gt; set autocommit = 0;Query OK, 0 rows affected (0.00 sec)mysql&gt; select @@autocommit;+--------------+| @@autocommit |+--------------+| 0 |+--------------+1 row in set (0.01 sec) ä½¿ç”¨rollbackå›æ»šäº‹åŠ¡ 123456789101112131415161718192021mysql&gt; select * from t1;Empty set (0.00 sec)mysql&gt; insert into t1 values (51, 3000);Query OK, 1 row affected (0.00 sec)mysql&gt; select * from t1;+----+------+| a | b |+----+------+| 51 | 3000 |+----+------+1 row in set (0.00 sec)mysql&gt; rollback;Query OK, 0 rows affected (0.03 sec)mysql&gt; select * from t1;Empty set (0.00 sec)mysql&gt; ä½¿ç”¨start transaction;æˆ–begin;æ˜¾ç¤ºçš„å¼€å¯ä¸€ä¸ªäº‹åŠ¡ 1234567891011121314151617181920212223242526272829mysql&gt; start transaction;Query OK, 0 rows affected (0.00 sec)mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; insert into t1 values (51, 3000);Query OK, 1 row affected (0.00 sec)mysql&gt; select * from t1;+----+------+| a | b |+----+------+| 51 | 3000 |+----+------+1 row in set (0.00 sec)mysql&gt; rollback;Query OK, 0 rows affected (0.04 sec)mysql&gt; select * from t1;Empty set (0.00 sec)mysql&gt; commit;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from t1;Empty set (0.00 sec) ä½¿ç”¨savepointåœ¨äº‹åŠ¡ä¸­åˆ›å»ºä¸€ä¸ªä¿å­˜ç‚¹ï¼ˆå¯ä»¥åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­åˆ›å»ºå¤šä¸ªä¿å­˜ç‚¹ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; insert into t1 values (51, 3000);Query OK, 1 row affected (0.00 sec)mysql&gt; select * from t1;+----+------+| a | b |+----+------+| 51 | 3000 |+----+------+1 row in set (0.00 sec)mysql&gt; savepoint tx1;Query OK, 0 rows affected (0.00 sec)mysql&gt; insert into t1 values (52, 3000);Query OK, 1 row affected (0.00 sec)mysql&gt; select * from t1;+----+------+| a | b |+----+------+| 51 | 3000 || 52 | 3000 |+----+------+2 rows in set (0.00 sec)mysql&gt; rollback to tx1;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from t1;+----+------+| a | b |+----+------+| 51 | 3000 |+----+------+1 row in set (0.00 sec)mysql&gt; commit;Query OK, 0 rows affected (0.04 sec) ä»¥ä¸Šæ˜¯mysqlå‘½ä»¤è¡Œæ˜¯å¯¹äº‹åŠ¡éš”ç¦»çº§åˆ«å’Œäº‹åŠ¡æäº¤çš„åŸºæœ¬æ“ä½œã€‚ç°åœ¨è¯´æ˜ä»¥ä¸‹æ“ä½œåŸºäºå¯é‡å¤å¤è¯»çš„éš”ç¦»çº§åˆ«ï¼Œäº‹åŠ¡ä¸è‡ªåŠ¨æäº¤ã€‚ 12345678mysql&gt; set global transaction isolation level repeatable read;Query OK, 0 rows affected (0.00 sec)mysql&gt; set session transaction isolation level repeatable read;Query OK, 0 rows affected (0.00 sec)mysql&gt; set autocommit = 0;Query OK, 0 rows affected (0.00 sec)","raw":null,"content":null,"categories":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/categories/mysql/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/tags/mysql/"}]},{"title":"Java å˜é‡å’Œæ•°æ®ç±»å‹","slug":"java-æ•°æ®ç±»å‹","date":"2017-04-10T12:58:51.000Z","updated":"2020-11-20T13:06:15.512Z","comments":true,"path":"2017/04/10/java-æ•°æ®ç±»å‹/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/10/java-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","excerpt":"Â¶å˜é‡ ğŸ˜œ\n\nå˜é‡å¯ä»¥æŒæœ‰åŸºæœ¬ç±»å‹æˆ–æŒ‡å‘æŸä¸ªå¯¹è±¡\nå˜é‡å¿…é¡»å…ˆå®šä¹‰åä½¿ç”¨\nå®šä¹‰å˜é‡\nå˜é‡å¯ä»¥è¢«èµ‹å€¼ï¼Œè¿˜å¯ä»¥è¢«é‡æ–°èµ‹å€¼\nç­‰å·=æ˜¯èµ‹å€¼ï¼Œä¸æ˜¯æ•°å­¦çš„ç›¸ç­‰\n\nÂ¶Eclipse Debug\nè¿›å…¥è°ƒè¯•æ¨¡å¼åå¯ä»¥è®¾ç½®æ–­ç‚¹åå•æ­¥æ‰§è¡Œ\nÂ¶æ•°æ®ç±»å‹\n\næ•´æ•°ç±»å‹ï¼šbyteï¼Œshortï¼Œintï¼Œlong\næµ®ç‚¹ç±»å‹ï¼šfloatï¼Œdouble\nå­—ç¬¦ç±»å‹ï¼šchar\nå¸ƒå°”ç±»å‹ï¼šboolean\n\nÂ¶å¸¸é‡\n\nç”¨finalå®šä¹‰\né€šå¸¸å…¨éƒ¨å¤§å†™\né¿å…magic number\n\nÂ¶è®¡ç®—æœºå†…å­˜åœ°å€\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªå†…å­˜æ­£å¥½å­˜ä¸€ä¸ªå­—èŠ‚ï¼Œç®—ä¸€ä¸‹å¦‚æœä½ æœ‰16Gå†…å­˜ï¼Œå¤§æ¦‚æœ‰å¤šå°‘å­—èŠ‚å‘¢.\n\njavaä¸­,æ•´å‹æ‰€å¯¹åº”å†…å­˜çš„å­—èŠ‚æ•°å¦‚ä¸‹å›¾\n\nÂ¶æ•´å‹çš„èŒƒå›´\njava çš„æ•´å‹æ˜¯å¸¦ç¬¦å·çš„ï¼Œæ³¨æ„è¦å£°æ˜ä¸ºlongæ•´å‹çš„æ—¶å€™è¦åœ¨åé¢åŠ ä¸ŠLï¼Œå¦åˆ™æ˜¯intç±»å‹ï¼Œå¦‚ä¸‹å›¾\n","text":"Â¶å˜é‡ ğŸ˜œ å˜é‡å¯ä»¥æŒæœ‰åŸºæœ¬ç±»å‹æˆ–æŒ‡å‘æŸä¸ªå¯¹è±¡ å˜é‡å¿…é¡»å…ˆå®šä¹‰åä½¿ç”¨ å®šä¹‰å˜é‡ å˜é‡å¯ä»¥è¢«èµ‹å€¼ï¼Œè¿˜å¯ä»¥è¢«é‡æ–°èµ‹å€¼ ç­‰å·=æ˜¯èµ‹å€¼ï¼Œä¸æ˜¯æ•°å­¦çš„ç›¸ç­‰ Â¶Eclipse Debug è¿›å…¥è°ƒè¯•æ¨¡å¼åå¯ä»¥è®¾ç½®æ–­ç‚¹åå•æ­¥æ‰§è¡Œ Â¶æ•°æ®ç±»å‹ æ•´æ•°ç±»å‹ï¼šbyteï¼Œshortï¼Œintï¼Œlong æµ®ç‚¹ç±»å‹ï¼šfloatï¼Œdouble å­—ç¬¦ç±»å‹ï¼šchar å¸ƒå°”ç±»å‹ï¼šboolean Â¶å¸¸é‡ ç”¨finalå®šä¹‰ é€šå¸¸å…¨éƒ¨å¤§å†™ é¿å…magic number Â¶è®¡ç®—æœºå†…å­˜åœ°å€ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªå†…å­˜æ­£å¥½å­˜ä¸€ä¸ªå­—èŠ‚ï¼Œç®—ä¸€ä¸‹å¦‚æœä½ æœ‰16Gå†…å­˜ï¼Œå¤§æ¦‚æœ‰å¤šå°‘å­—èŠ‚å‘¢. javaä¸­,æ•´å‹æ‰€å¯¹åº”å†…å­˜çš„å­—èŠ‚æ•°å¦‚ä¸‹å›¾ Â¶æ•´å‹çš„èŒƒå›´ java çš„æ•´å‹æ˜¯å¸¦ç¬¦å·çš„ï¼Œæ³¨æ„è¦å£°æ˜ä¸ºlongæ•´å‹çš„æ—¶å€™è¦åœ¨åé¢åŠ ä¸ŠLï¼Œå¦åˆ™æ˜¯intç±»å‹ï¼Œå¦‚ä¸‹å›¾ Â¶æµ®ç‚¹æ•° 12float money = 100.12f // ç»“å°¾åŠ fdouble d = 1.79e4 Â¶å­—ç¬¦ç±»å‹ æ³¨æ„å­—ç¬¦ç±»å‹å’Œå­—ç¬¦ä¸²ç±»å‹çš„åŒºåˆ«ï¼šå­—ç¬¦ç±»å‹ç”¨å•å¼•å·ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªå­—ç¬¦ã€‚ 12char c = &#x27;a&#x27; ;char b = &#x27;æ&#x27;ï¼› Â¶äºŒè¿›åˆ¶å’Œåå…­è¿›åˆ¶è¡¨ç¤ºæ•´å½¢çš„æ–¹å¼ 123int i3 = 2_000_000_000;int i4 = 0xff0000; // åå…­è¿›åˆ¶è¡¨ç¤ºçš„åè¿›åˆ¶16711680int i5 = 0b1000000000; // äºŒè¿›åˆ¶è¡¨ç¤ºçš„åè¿›åˆ¶512 å¦‚æœè¦è¾“å‡ºä¸€ä¸ªä»¥16è¿›åˆ¶è¡¨ç¤ºçš„æ•´å‹ï¼Œæˆ–è€…ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºçš„æ•´å‹ï¼Œå¯ä»¥ä½¿ç”¨JDKæä¾›çš„æ–¹æ³•ï¼š 123456// è¾“å‡ºä»¥åå…­è¿›åˆ¶è¡¨ç¤ºçš„æ•´å‹çš„å­—ç¬¦ä¸²ï¼šSystem.out.println(Integer.toHexString(12345678)); // bc614e// è¾“å‡ºä»¥äºŒè¿›åˆ¶è¡¨ç¤ºçš„æ•´å‹çš„å­—ç¬¦ä¸²ï¼šSystem.out.println(Integer.toBinaryString(12345678)); // 101111000110000101001110 Â¶å¸¸é‡ ä¸ç®¡PHP è¿˜æ˜¯ JAVA,è®¸å¤šå¯ä»¥é¿å…ç¡¬ç¼–ç çš„åœ°æ–¹éƒ½å¯ä»¥ç”¨å¸¸äº®å»ä¿®é¥°ï¼Œè¿™æ ·å¯ä»¥ä½¿æˆ‘ä»¬æ›´å¥½åœ°å»ç†è§£ç¨‹åºçš„æ„å›¾ 1final double PI = 3.14","raw":null,"content":null,"categories":[{"name":"Java","slug":"Java","permalink":"http://blog.nicexiangcun.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://blog.nicexiangcun.com/tags/Java/"}]},{"title":"å¤§å‹ç½‘ç«™æŠ€æœ¯ç¯‡ä¹‹å®¹é‡ä¼°ç®—å’Œè´Ÿè½½çš„æŸ¥çœ‹","slug":"large-website","date":"2017-04-09T12:29:31.000Z","updated":"2020-11-20T13:06:15.513Z","comments":true,"path":"2017/04/09/large-website/","link":"","permalink":"http://blog.nicexiangcun.com/2017/04/09/large-website/","excerpt":"Â¶âœï¸å¤§å‹ç½‘ç«™å…·æœ‰çš„ç‰¹ç‚¹\n\næµ·é‡æ•°æ®ï¼ˆå¤§æ•°æ®ï¼‰\né«˜å¹¶å‘ å¤§æµé‡\né«˜å¯ç”¨ 7*24 å°æ—¶ä¸æ–­æœåŠ¡, äº”ä¸ª9çº§åˆ« (99.999)\né¢‘é¢‘è¿­ä»£ï¼Œéœ€æ±‚å¤š\n\nÂ¶âœï¸å®¹é‡ä¼°ç®—å’Œè´Ÿè½½æŸ¥çœ‹\nå®¹é‡ï¼šæ•°æ®é‡ï¼Œå¹¶å‘é‡ï¼Œå¸¦å®½ï¼ŒCPU ç­‰\nå®¹é‡è¯„ä¼°çš„ç®€å•æ­¥éª¤å’Œæ–¹æ³•ï¼š\n\nè¯„ä¼°æ€»è®¿é—®é‡ï¼Œç»“åˆå¸‚åœºåŠè¿è¥æ´»åŠ¨ç­‰è¯„ä¼°\nè¯„ä¼°å¹³å±€è®¿é—®é‡QPS\nè¯„ä¼°é«˜å³°QPSï¼Œä¸€èˆ¬æ˜¯å¹³å‡QPSçš„2å€\nç³»ç»Ÿå‹æµ‹å¦‚ç”¨apacheçš„ abç­‰ï¼Œå•æœºæé™QPSï¼Œæ‹¿é«˜å³°çš„QPSå’Œå•æœºå‹æµ‹çš„QPSæ¯”å¯¹ä¸€ä¸‹ã€‚\nè®¡ç®—å®¹é‡\n\nè´Ÿè½½ï¼šç³»ç»Ÿçš„ç¹å¿™ç¨‹åº¦ï¼Œå³æœ‰å¤šå°‘è¿›ç¨‹ç­‰cpuè°ƒåº¦\ntopå‘½ä»¤ï¼šè¿‡å»1åˆ†é’Ÿï¼Œ5åˆ†é’Ÿï¼Œ10åˆ†é’Ÿçš„è´Ÿè½½å€¼\nLoad Avg: 1.61, 1.79, 1.64  CPU usage: 1.96% user, 1.96% sys, 96.6%\nLoad çš„è­¦æƒ•å€¼ ï¼š ä»¥å•æ ¸ä¸ºä¾‹ Load &gt; 2 ç³»ç»Ÿä»¥ç›¸å¯¹ç¹å¿™ Load &gt; 5 ç³»ç»Ÿå´©æºƒè¾¹ç¼˜","text":"Â¶âœï¸å¤§å‹ç½‘ç«™å…·æœ‰çš„ç‰¹ç‚¹ æµ·é‡æ•°æ®ï¼ˆå¤§æ•°æ®ï¼‰ é«˜å¹¶å‘ å¤§æµé‡ é«˜å¯ç”¨ 7*24 å°æ—¶ä¸æ–­æœåŠ¡, äº”ä¸ª9çº§åˆ« (99.999) é¢‘é¢‘è¿­ä»£ï¼Œéœ€æ±‚å¤š Â¶âœï¸å®¹é‡ä¼°ç®—å’Œè´Ÿè½½æŸ¥çœ‹ å®¹é‡ï¼šæ•°æ®é‡ï¼Œå¹¶å‘é‡ï¼Œå¸¦å®½ï¼ŒCPU ç­‰ å®¹é‡è¯„ä¼°çš„ç®€å•æ­¥éª¤å’Œæ–¹æ³•ï¼š è¯„ä¼°æ€»è®¿é—®é‡ï¼Œç»“åˆå¸‚åœºåŠè¿è¥æ´»åŠ¨ç­‰è¯„ä¼° è¯„ä¼°å¹³å±€è®¿é—®é‡QPS è¯„ä¼°é«˜å³°QPSï¼Œä¸€èˆ¬æ˜¯å¹³å‡QPSçš„2å€ ç³»ç»Ÿå‹æµ‹å¦‚ç”¨apacheçš„ abç­‰ï¼Œå•æœºæé™QPSï¼Œæ‹¿é«˜å³°çš„QPSå’Œå•æœºå‹æµ‹çš„QPSæ¯”å¯¹ä¸€ä¸‹ã€‚ è®¡ç®—å®¹é‡ è´Ÿè½½ï¼šç³»ç»Ÿçš„ç¹å¿™ç¨‹åº¦ï¼Œå³æœ‰å¤šå°‘è¿›ç¨‹ç­‰cpuè°ƒåº¦ topå‘½ä»¤ï¼šè¿‡å»1åˆ†é’Ÿï¼Œ5åˆ†é’Ÿï¼Œ10åˆ†é’Ÿçš„è´Ÿè½½å€¼ Load Avg: 1.61, 1.79, 1.64 CPU usage: 1.96% user, 1.96% sys, 96.6% Load çš„è­¦æƒ•å€¼ ï¼š ä»¥å•æ ¸ä¸ºä¾‹ Load &gt; 2 ç³»ç»Ÿä»¥ç›¸å¯¹ç¹å¿™ Load &gt; 5 ç³»ç»Ÿå´©æºƒè¾¹ç¼˜","raw":null,"content":null,"categories":[],"tags":[{"name":"å¤§å‹ç½‘ç«™","slug":"å¤§å‹ç½‘ç«™","permalink":"http://blog.nicexiangcun.com/tags/%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99/"}]},{"title":"Yar","slug":"Yar","date":"2017-03-27T14:57:58.000Z","updated":"2020-11-20T13:06:15.509Z","comments":true,"path":"2017/03/27/Yar/","link":"","permalink":"http://blog.nicexiangcun.com/2017/03/27/Yar/","excerpt":"Â¶ğŸ· Yar ç¼–è¯‘å®‰è£…\n123456789101112131415161718192021222324git clone https://github.com/laruence/yar.gitcd yar//å®‰è£…ä¾èµ–åŒ…sudo apt-get install curlsudo apt-get install libcurl4-gnutls-dev//è½¯è¿æ¥åˆ°binç›®å½•ln -s /usr/local/php7.0/bin/phpize /usr/bin/phpize phpize./configuresudo makesudo make install//é…ç½®fpmsudo ln -s /etc/php/7.0/mods-available/yar.ini  /etc/php/7.0/fpm/conf.d/yar.ini//é‡å¯fpmsudo service php7.0-fpm restart","text":"Â¶ğŸ· Yar ç¼–è¯‘å®‰è£… 123456789101112131415161718192021222324git clone https://github.com/laruence/yar.gitcd yar//å®‰è£…ä¾èµ–åŒ…sudo apt-get install curlsudo apt-get install libcurl4-gnutls-dev//è½¯è¿æ¥åˆ°binç›®å½•ln -s /usr/local/php7.0/bin/phpize /usr/bin/phpize phpize./configuresudo makesudo make install//é…ç½®fpmsudo ln -s /etc/php/7.0/mods-available/yar.ini /etc/php/7.0/fpm/conf.d/yar.ini//é‡å¯fpmsudo service php7.0-fpm restart Â¶æœåŠ¡ç«¯æ³¨å†Œ 1234567891011121314151617181920class ApiController&#123; public function getUserInfo($uid) &#123; return json_encode([ &#x27;uid&#x27;=&gt;$uid, &#x27;username&#x27;=&gt;&#x27;lihongwei&#x27;, ]); &#125; public function getDealInfo($dealid) &#123; return json_encode([ &#x27;did&#x27;=&gt;$dealid, &#x27;dealname&#x27;=&gt;&#x27;haihang&#x27;, ]); &#125;&#125;$service = new \\Yar_Server(new ApiController());$service-&gt;handle(); Â¶å®¢æˆ·ç«¯è°ƒç”¨ 1234567891011121314151617181920212223242526 //åŒæ­¥ $client = new \\Yar_Client(&quot;http://yaf.dev&quot;); /* ä»¥ä¸‹æ˜¯æœ€ä½³setopt */ $client-&gt;SetOpt(YAR_OPT_CONNECT_TIMEOUT, 1000); /* åŒæ­¥è°ƒç”¨è¿œç¨‹æœåŠ¡ */ $result = $client-&gt;getUserInfo(100); //å¼‚æ­¥ \\Yar_Concurrent_Client::call(&quot;http://yaf.dev&quot;, &quot;getUserInfo&quot;,[11320],[$this , &#x27;getUserInfoCallback&#x27;]);\\Yar_Concurrent_Client::call(&quot;http://yaf.dev&quot;, &quot;getDealInfo&quot;,[18800],[$this , &#x27;getDealInfoCallback&#x27;]);\\Yar_Concurrent_Client::call(&quot;http://yaf.dev&quot;, &quot;getDealInfo&quot;,[18800],[$this , &#x27;getDealInfoCallback&#x27;],[$this , &#x27;getDealInfoCallbackError&#x27;],[YAR_OPT_PACKAGER =&gt; &quot;json&quot;]);\\Yar_Concurrent_Client::call(&quot;http://yaf.dev&quot;, &quot;getDealInfo&quot;,[18800],[$this , &#x27;getDealInfoCallback&#x27;],[$this , &#x27;getDealInfoCallbackError&#x27;],[YAR_OPT_TIMEOUT=&gt;1]);\\Yar_Concurrent_Client::loop();public function getUserInfoCallback($retval, $callinfo) &#123; $data = json_decode($retval ,true); var_dump($data[&#x27;username&#x27;]);&#125;","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"yar","slug":"yar","permalink":"http://blog.nicexiangcun.com/tags/yar/"}]},{"title":"æ·±å…¥ç†è§£æ­£åˆ™è¡¨è¾¾å¼","slug":"æ­£åˆ™","date":"2017-02-25T11:58:37.000Z","updated":"2020-11-20T13:06:15.521Z","comments":true,"path":"2017/02/25/æ­£åˆ™/","link":"","permalink":"http://blog.nicexiangcun.com/2017/02/25/%E6%AD%A3%E5%88%99/","excerpt":"Â¶è¡¨è¾¾å¼æµ‹è¯• ğŸ\næ¨èä¸€ä¸ªæµ‹è¯•åœ°å€ http://www.rexv.org/\næµ‹è¯•é¢˜ï¼šç”¨å•å¼•å·å’ŒåŒå¼•å·åŒ¹é… \\$\nç­”æ¡ˆ ï¼š é¦–å…ˆ\\$éƒ½æ˜¯å…ƒå­—ç¬¦éƒ½éœ€è¦è½¬ä¹‰ï¼Œè½¬ä¹‰ç»“æœä¸ºï¼š\\\\\\$\n\nç”¨å•å¼•å·æ¥æ ‡è¯†çš„æ­£åˆ™: /\\\\\\\\\\$/\nç”¨åŒå¼•å·æ¥æ ‡è¯†çš„æ­£åˆ™: /\\\\\\\\\\\\\\$/\n\nÂ¶ğŸŒ´ åˆ†ç»„å’Œåå‘å¼•ç”¨\né€šè¿‡æ¬¡æ•°é™å®šç¬¦ï¼Œæ¥é™å®šå‰é¢æ‹¬å·ä¸­çš„å•å…ƒã€‚åŒ¹é…åˆ°çš„å•å…ƒå°†ä¼šè¢«æ•è·ï¼Œæ•è·åˆ°çš„å†…å®¹å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„åé¢é€šè¿‡\\1,\\2,\\3è·å–ã€‚\nÂ¶è´ªå©ªä¸éè´ªå©ª ğŸª²\n\n.* è´ªå©ªæ¨¡å¼ï¼Œè´ªå©ªæ¨¡å¼ä¼šå›æº¯åŒ¹é…æ•ˆç‡ä½ã€‚\n.*? éè´ªå©ªæ¨¡å¼\n","text":"Â¶è¡¨è¾¾å¼æµ‹è¯• ğŸ æ¨èä¸€ä¸ªæµ‹è¯•åœ°å€ http://www.rexv.org/ æµ‹è¯•é¢˜ï¼šç”¨å•å¼•å·å’ŒåŒå¼•å·åŒ¹é… \\$ ç­”æ¡ˆ ï¼š é¦–å…ˆ\\$éƒ½æ˜¯å…ƒå­—ç¬¦éƒ½éœ€è¦è½¬ä¹‰ï¼Œè½¬ä¹‰ç»“æœä¸ºï¼š\\\\\\$ ç”¨å•å¼•å·æ¥æ ‡è¯†çš„æ­£åˆ™: /\\\\\\\\\\$/ ç”¨åŒå¼•å·æ¥æ ‡è¯†çš„æ­£åˆ™: /\\\\\\\\\\\\\\$/ Â¶ğŸŒ´ åˆ†ç»„å’Œåå‘å¼•ç”¨ é€šè¿‡æ¬¡æ•°é™å®šç¬¦ï¼Œæ¥é™å®šå‰é¢æ‹¬å·ä¸­çš„å•å…ƒã€‚åŒ¹é…åˆ°çš„å•å…ƒå°†ä¼šè¢«æ•è·ï¼Œæ•è·åˆ°çš„å†…å®¹å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„åé¢é€šè¿‡\\1,\\2,\\3è·å–ã€‚ Â¶è´ªå©ªä¸éè´ªå©ª ğŸª² .* è´ªå©ªæ¨¡å¼ï¼Œè´ªå©ªæ¨¡å¼ä¼šå›æº¯åŒ¹é…æ•ˆç‡ä½ã€‚ .*? éè´ªå©ªæ¨¡å¼ Â¶æ­£åˆ™è¡¨è¾¾å¼çš„å›æº¯ 12/&quot;.*&quot;/ å’Œ /&quot;.*?&quot;/åˆ†åˆ«åŒ¹é… &#x27;my name is &quot;lhw&quot; who &quot;are&quot; you &#x27; &quot;.*&quot;åŒ¹é…è¿‡ç¨‹ï¼šå½“åŒ¹é…åˆ°ç¬¬ä¸€ä¸ª&quot;å­—ç¬¦çš„æ—¶å€™ç”±äº.æ˜¯åŒ¹é…éæ¢è¡Œç¬¦çš„æ‰€æœ‰å­—ç¬¦ï¼Œæ‰€ä»¥å°±ä»&quot;ä¸€ç›´åŒ¹é…çš„æœ€åï¼ŒåŒ¹é…åˆ°æœ€åç„¶ååœ¨é€æ¬¡å¾€å‰å›æº¯ï¼Œæ‹¿æ¯ä¸ªå­—ç¬¦å’Œæœ€åä¸€ä¸ª&quot;ç¬¦å·åŒ¹é…ï¼Œç›´åˆ°åŒ¹é…åˆ°ä¸ºæ­¢ï¼Œæ‰€ä»¥&quot;.*&quot;åŒ¹é…çš„ç»“æœæ˜¯ â€œlhwâ€ who â€œareâ€ &quot;.*?&quot;åŒ¹é…è¿‡ç¨‹ï¼šå½“åŒ¹é…åˆ°ç¬¬ä¸€ä¸ª&quot;å­—ç¬¦çš„æ—¶å€™ï¼Œå°±ä¼šé€æ¬¡çš„ä»å½“å‰çš„&quot;åé¢çš„å­—ç¬¦å’Œæœ€å&quot;åšåŒ¹é…ã€‚ç›´åˆ°åŒ¹é…ä¸ºæ­¢ã€‚ Â¶âœ‚ï¸ é™å®šç¬¦å’Œå…ƒå­—ç¬¦ä½¿ç”¨æ—¶æ³¨æ„ æ‰€æœ‰é™å®šç¬¦éƒ½æ˜¯é™å®šå®ƒå‰é¢çš„ä¸€ä¸ªå­å•å…ƒå‡ºç°çš„æ¬¡æ•°ã€‚ åªæœ‰å…ƒå­—ç¬¦å‡ºç°åœ¨å®ƒè¯¥å‡ºç°çš„åœ°æ–¹æ‰èƒ½èµ·åˆ°å…ƒå­—ç¬¦ä½œç”¨ï¼Œå¦åˆ™å°±æ˜¯æ™®é€šå­—ç¬¦å¦‚ï¼š [-0-9A-Z.?]ç”±äº[]ä¼˜å…ˆçº§é«˜äº.?æ‰€ä»¥è¿™é‡Œçš„.?å°±æ˜¯æ™®é€šå­—ç¬¦ Â¶PCRE ä¸»è¦å‡½æ•° preg_grep è¿”å›åŒ¹é…æ¨¡å¼çš„æ•°ç»„æ¡ç›® preg_match æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é… preg_match_all æ‰§è¡Œä¸€ä¸ªå…¨å±€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… preg_filter æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢å’Œæ›¿æ¢ preg_replace æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢å’Œæ›¿æ¢ preg_replace_callback æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢ä¸”ä½¿ç”¨ä¸€ä¸ªå›è°ƒè¿›è¡Œæ›¿æ¢ preg_split é€šè¿‡ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å­—ç¬¦ä¸² Â¶æ­£åˆ™è¡¨è¾¾å¼ - å…ƒå­—ç¬¦ ğŸ½ å­—ç¬¦ æè¿° \\ æœ‰ä¸‰ç§å«ä¹‰ï¼Œ1æ˜¯è½¬ä¹‰å¦‚ \\\\,\\(,2æ˜¯ç‰¹æ®Šå­—ç¬¦å¦‚\\n åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦,3æ˜¯å‘åå¼•ç”¨ ^ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExpå¯¹è±¡çš„Multilineå±æ€§ï¼Œ^ä¹ŸåŒ¹é…â€œ\\nâ€æˆ–â€œ\\râ€ä¹‹åçš„ä½ç½® $ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExpå¯¹è±¡çš„Multilinæ€§ï¼Œ$ä¹ŸåŒ¹é…â€œ\\nâ€æˆ–â€œ\\râ€ä¹‹å‰çš„ä½ç½® | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡(æ³¨æ„ï¼šå‰é¢çš„å­è¡¨è¾¾)ã€‚ä¾‹å¦‚ï¼Œlhw* èƒ½åŒ¹é… â€œlh&quot;å’Œ&quot;lhwâ€ ä»¥åŠ â€œlhwwwâ€ã€‚ç­‰ä»·äº{0,} | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜lhw+â€™ èƒ½åŒ¹é… â€œlhwâ€ ä»¥åŠ â€œlhwwwâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œlhâ€ã€‚+ ç­‰ä»·äº {1,} ? | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œlhw(nb)?â€ å¯ä»¥åŒ¹é… â€œlhwâ€ æˆ– â€œlhwnbâ€ ç­‰ä»·äº {0,1} {n} | åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜lhw{2}â€™ ä¸èƒ½åŒ¹é… â€œlhwâ€ ä½†æ˜¯èƒ½åŒ¹é… â€œlhwwâ€ {n,} | è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooodâ€ ä¸­çš„æ‰€æœ‰ o,â€˜o{1,}â€™ ç­‰ä»·äº â€˜o+â€™,â€˜o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ {n,m} | æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œo{1,3}â€ å°†åŒ¹é… â€œfoooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€˜o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ . | åŒ¹é…é™¤ â€œ\\nâ€ ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚è¦åŒ¹é…åŒ…æ‹¬ â€˜\\nâ€™ åœ¨å†…çš„ä»»ä½•å­—ç¬¦ï¼Œè¯·ä½¿ç”¨åƒ&quot;(.|\\n)&quot;çš„æ¨¡å¼ ? | å½“è¯¥å­—ç¬¦ç´§è·Ÿåœ¨ä»»ä½•ä¸€ä¸ªå…¶ä»–é™åˆ¶ç¬¦ (*, +, ?, {n}, {n,}, {n,m}) åé¢æ—¶ï¼ŒåŒ¹é…æ¨¡å¼æ˜¯éè´ªå©ªçš„ã€‚éè´ªå©ªæ¨¡å¼å°½å¯èƒ½å°‘çš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œè€Œé»˜è®¤çš„è´ªå©ªæ¨¡å¼åˆ™å°½å¯èƒ½å¤šçš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸² â€œooooâ€ï¼Œâ€˜o+?â€™ å°†åŒ¹é…å•ä¸ª â€œoâ€ï¼Œè€Œ â€˜o+â€™ å°†åŒ¹é…æ‰€æœ‰ â€˜oâ€™ x|y | åŒ¹é… x æˆ– yã€‚ä¾‹å¦‚ï¼Œâ€˜z|foodâ€™ èƒ½åŒ¹é… â€œzâ€ æˆ– â€œfoodâ€ã€‚â€˜(z|f)oodâ€™ åˆ™åŒ¹é… â€œzoodâ€ æˆ– â€œfoodâ€ [xyz] | åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„ â€˜aâ€™ [^xyz] | åŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[^abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„â€™pâ€™ã€â€˜lâ€™ã€â€˜iâ€™ã€â€˜nâ€™ [a-z] | åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€˜[a-z]â€™ å¯ä»¥åŒ¹é… â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å°å†™å­—æ¯å­—ç¬¦ [^a-z] | åŒ¹é…ä»»ä½•ä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€˜[^a-z]â€™ å¯ä»¥åŒ¹é…ä»»ä½•ä¸åœ¨ â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ \\d | åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [0-9] \\D | åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [^0-9] \\n | åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ \\s | åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ \\S |åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [^ \\f\\n\\r\\t\\v] \\r | åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ \\t | åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ \\w | åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ç­‰ä»·äºâ€™[A-Za-z0-9_]â€™ \\W | åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ã€‚ç­‰ä»·äº â€˜[^A-Za-z0-9_]â€™ \\xn | åå…­è¿›åˆ¶è½¬ä¹‰å€¼å¿…é¡»ä¸ºç¡®å®šçš„ä¸¤ä¸ªæ•°å­—é•¿ã€‚ä¾‹å¦‚ï¼Œâ€˜\\x41â€™ åŒ¹é… â€œAâ€ã€‚â€˜\\x041â€™ åˆ™ç­‰ä»·äº â€˜\\x04â€™ &amp; â€œ1â€ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨ ASCII ç¼–ç  \\nm | æ ‡è¯†ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€‚å¦‚æœ \\nm ä¹‹å‰è‡³å°‘æœ‰ nm ä¸ªè·å¾—å­è¡¨è¾¾å¼ï¼Œåˆ™ nm ä¸ºå‘åå¼•ç”¨ã€‚å¦‚æœ \\nm ä¹‹å‰è‡³å°‘æœ‰ n ä¸ªè·å–ï¼Œåˆ™ n ä¸ºä¸€ä¸ªåè·Ÿæ–‡å­— m çš„å‘åå¼•ç”¨ã€‚å¦‚æœå‰é¢çš„æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œè‹¥ n å’Œ m å‡ä¸ºå…«è¿›åˆ¶æ•°å­— (0-7)ï¼Œåˆ™ \\nm å°†åŒ¹é…å…«è¿›åˆ¶è½¬ä¹‰å€¼ nm [\\u4e00-\\u9fa5] | unicodeç èŒƒå›´ï¼ŒåŒ¹é…ä»»æ„æ±‰å­—ï¼Œ\\uå›ºå®šå†™æ³•ï¼Œ4e00ä¸º16è¿›åˆ¶çš„unicodeç¼–ç ","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"http://blog.nicexiangcun.com/tags/%E6%AD%A3%E5%88%99/"}]},{"title":"å­—ç¬¦ä¸²å’Œå­—ç¬¦ç¼–ç åŸç†","slug":"å­—ç¬¦ä¸²","date":"2017-02-24T12:56:53.000Z","updated":"2020-11-20T13:06:15.521Z","comments":true,"path":"2017/02/24/å­—ç¬¦ä¸²/","link":"","permalink":"http://blog.nicexiangcun.com/2017/02/24/%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"Â¶ğŸ•·ï¸å•å¼•å·å’ŒåŒå¼•å·çš„åŒºåˆ«\nå•å¼•å·å’ŒåŒå¼•å·çš„åŒºåˆ«ç»å¸¸è¢«å½“åšé¢è¯•é¢˜è¢«é—®åˆ°ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†å›ç­”çš„å¹¶ä¸å¥½ï¼Œå…¶ä¸­æœ‰ä»¥ä¸‹å‡ ç§åŒºåˆ«ç»å¸¸è¢«å¿½ç•¥ã€‚\nå½“å­—ç¬¦ä¸²ç”¨åŒå¼•å·æˆ–è€…heredocç»“æ„å®šä¹‰æ—¶ï¼Œå…¶ä¸­å˜é‡å¯ä»¥è¢«è§£æï¼ŒåŒæ—¶å¯ä»¥è§£æä»¥ä¸‹å­—ç¬¦\n\n\\n,\\r,\\t,\\v,\\e,\\f,\\,$,&quot;\n[0-7]{1,3}ç¬¦åˆè¯¥æ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œæ˜¯ä»¥ä¸€ä¸ªå…«è¿›åˆ¶æ–¹å¼æ¥è¡¨è¾¾çš„å­—ç¬¦ï¼Œä¾‹å¦‚\n\n12345/*** 101è½¬10è¿›åˆ¶ï¼š1*8^2+0*8^1+1*8^0 = 64+0+1 = 65* 102è½¬10è¿›åˆ¶ï¼š1*8^2+0*8^1+2*8^0 = 64+0+2 = 66*/echo &quot;\\101\\102&quot; // AB\n\n\\x[0-9A-Fa-f]{1,2}ç¬¦åˆè¯¥æ­£åˆ™è¡¨è¾¾çš„ï¼Œæ˜¯ä»¥ä¸€ä¸ªåå…­è¿›åˆ¶æ–¹å¼æ¥è¡¨è¾¾çš„å­—ç¬¦ï¼Œä¾‹å¦‚\n\n12345/*** 41è½¬10è¿›åˆ¶ï¼š4*16^1+1*16^0 = 64+1 = 65* 42è½¬10è¿›åˆ¶ï¼š4*16^2+2*16^0 = 64+2 = 66*/echo &quot;\\x41\\x42&quot; // AB\n\nå•å¼•å·åªè½¬ä¹‰\\ å’Œ â€™\n\nÂ¶â†˜ï¸ å…³äºå­—ç¬¦ä¸²ä¸‹æ ‡\n\nè·å–å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡å»è·å–ã€‚\nç”¨è¶…å‡ºå­—ç¬¦ä¸²é•¿åº¦çš„ä¸‹æ ‡å†™å…¥å­—ç¬¦ä¸²ï¼Œä¼šæ‹‰é•¿è¯¥å­—ç¬¦ä¸²ï¼Œä¸­é—´ä»¥ç©ºæ ¼å¡«å……ã€‚\n\n123$str = &#x27;lhw&#x27;;$str[10] = &#x27;ok&#x27;;echo $str;\nÂ¶ğŸœ å­—ç¬¦ä¸²ä¸²è¡ŒåŒ–\nä¸²è¡ŒåŒ–çš„ç›®çš„ï¼šå°†ä¸æ˜“äºå­˜å‚¨çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ä¸²è¡ŒåŒ–æ¥å­˜å‚¨æ•°æ®åº“æˆ–è€…æ–‡ä»¶å½“ä¸­ã€‚\n\nserialize()   æ€§èƒ½ç¨å·®ï¼Œå¯åºåˆ—å·å¯¹è±¡\njson_encode() æ€§èƒ½å¥½ï¼Œè¿™åºåˆ—åŒ–æ•°ç»„ï¼Œå¹¶ä¸”ä¸åŒè¯­è¨€å¯é€šç”¨\nvar_export($arr,true) åºåˆ—åŒ–æ•°ç»„ï¼Œå¹¶å†™å…¥æ–‡ä»¶ï¼Œå¯åšæ–‡ä»¶ç¼“å­˜ä½¿ç”¨ï¼Œæˆ–è€…å†™å…¥æ—¥å¿—è°ƒè¯•\n\n\nvar_export åˆ©ç”¨å®ƒçš„ç‰¹æ€§ï¼Œå¯ä»¥å°†è¯»å–æ•°æ®åº“çš„é…ç½®ç­‰ä¿¡æ¯ï¼Œå†™å…¥ç¼“å­˜æ–‡ä»¶ã€‚\n","text":"Â¶ğŸ•·ï¸å•å¼•å·å’ŒåŒå¼•å·çš„åŒºåˆ« å•å¼•å·å’ŒåŒå¼•å·çš„åŒºåˆ«ç»å¸¸è¢«å½“åšé¢è¯•é¢˜è¢«é—®åˆ°ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†å›ç­”çš„å¹¶ä¸å¥½ï¼Œå…¶ä¸­æœ‰ä»¥ä¸‹å‡ ç§åŒºåˆ«ç»å¸¸è¢«å¿½ç•¥ã€‚ å½“å­—ç¬¦ä¸²ç”¨åŒå¼•å·æˆ–è€…heredocç»“æ„å®šä¹‰æ—¶ï¼Œå…¶ä¸­å˜é‡å¯ä»¥è¢«è§£æï¼ŒåŒæ—¶å¯ä»¥è§£æä»¥ä¸‹å­—ç¬¦ \\n,\\r,\\t,\\v,\\e,\\f,\\,$,&quot; [0-7]{1,3}ç¬¦åˆè¯¥æ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œæ˜¯ä»¥ä¸€ä¸ªå…«è¿›åˆ¶æ–¹å¼æ¥è¡¨è¾¾çš„å­—ç¬¦ï¼Œä¾‹å¦‚ 12345/*** 101è½¬10è¿›åˆ¶ï¼š1*8^2+0*8^1+1*8^0 = 64+0+1 = 65* 102è½¬10è¿›åˆ¶ï¼š1*8^2+0*8^1+2*8^0 = 64+0+2 = 66*/echo &quot;\\101\\102&quot; // AB \\x[0-9A-Fa-f]{1,2}ç¬¦åˆè¯¥æ­£åˆ™è¡¨è¾¾çš„ï¼Œæ˜¯ä»¥ä¸€ä¸ªåå…­è¿›åˆ¶æ–¹å¼æ¥è¡¨è¾¾çš„å­—ç¬¦ï¼Œä¾‹å¦‚ 12345/*** 41è½¬10è¿›åˆ¶ï¼š4*16^1+1*16^0 = 64+1 = 65* 42è½¬10è¿›åˆ¶ï¼š4*16^2+2*16^0 = 64+2 = 66*/echo &quot;\\x41\\x42&quot; // AB å•å¼•å·åªè½¬ä¹‰\\ å’Œ â€™ Â¶â†˜ï¸ å…³äºå­—ç¬¦ä¸²ä¸‹æ ‡ è·å–å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡å»è·å–ã€‚ ç”¨è¶…å‡ºå­—ç¬¦ä¸²é•¿åº¦çš„ä¸‹æ ‡å†™å…¥å­—ç¬¦ä¸²ï¼Œä¼šæ‹‰é•¿è¯¥å­—ç¬¦ä¸²ï¼Œä¸­é—´ä»¥ç©ºæ ¼å¡«å……ã€‚ 123$str = &#x27;lhw&#x27;;$str[10] = &#x27;ok&#x27;;echo $str; Â¶ğŸœ å­—ç¬¦ä¸²ä¸²è¡ŒåŒ– ä¸²è¡ŒåŒ–çš„ç›®çš„ï¼šå°†ä¸æ˜“äºå­˜å‚¨çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ä¸²è¡ŒåŒ–æ¥å­˜å‚¨æ•°æ®åº“æˆ–è€…æ–‡ä»¶å½“ä¸­ã€‚ serialize() æ€§èƒ½ç¨å·®ï¼Œå¯åºåˆ—å·å¯¹è±¡ json_encode() æ€§èƒ½å¥½ï¼Œè¿™åºåˆ—åŒ–æ•°ç»„ï¼Œå¹¶ä¸”ä¸åŒè¯­è¨€å¯é€šç”¨ var_export($arr,true) åºåˆ—åŒ–æ•°ç»„ï¼Œå¹¶å†™å…¥æ–‡ä»¶ï¼Œå¯åšæ–‡ä»¶ç¼“å­˜ä½¿ç”¨ï¼Œæˆ–è€…å†™å…¥æ—¥å¿—è°ƒè¯• var_export åˆ©ç”¨å®ƒçš„ç‰¹æ€§ï¼Œå¯ä»¥å°†è¯»å–æ•°æ®åº“çš„é…ç½®ç­‰ä¿¡æ¯ï¼Œå†™å…¥ç¼“å­˜æ–‡ä»¶ã€‚ Â¶å­—ç¬¦ ç›¸å…³å…³é”®å­— ä½(bit b)ï¼Œè®¡ç®—æœºæœ€å°å­˜å‚¨å•ä½ï¼Œ0æˆ–1ç»„æˆ å­—èŠ‚(byte B),è®¡é‡å•ä½ å­—ç¬¦(char),å¯è§å­—æ¯ï¼Œæ•°å­—ï¼Œç¬¦å·ç­‰ Â¶å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç  å­—ç¬¦é›† æ‰€æœ‰æŠ½è±¡å­—ç¬¦çš„é›†åˆï¼Œå¦‚ ASCII å­—ç¬¦é›†ï¼ŒUnicode å­—ç¬¦é›† å­—ç¬¦ç¼–ç  ä¸€ç§çº¦å®šè§„èŒƒï¼Œä½¿å­—ç¬¦å’Œè®¡ç®—æœºç›´æ¥å»ºç«‹å¯¹åº”å…³ç³»ï¼Œå°±æ˜¯ä»¥äºŒè¿›åˆ¶çš„æ•°å­—å¯¹åº”å­—ç¬¦é›†çš„å­—ç¬¦ã€‚ Â¶ASCII ç¼–ç  ç¾å›½å®šä¹‰çš„å­—ç¬¦é›†ï¼Œåªç”¨ä¸€ä¸ªå­—èŠ‚æ ‡è¯†çš„å­—ç¬¦ï¼Œä½¿ç”¨å­—èŠ‚çš„ä½7ä½æ ‡è¯†ä¸€å…±2çš„7æ¬¡æ–¹128ä¸ªå­—ç¬¦ï¼Œè¿™äº›å­—ç¬¦éƒ½å’ŒäºŒè¿›åˆ¶æ•°å­—æœ‰äº†å¯¹åº”å…³ç³»ã€‚ Â¶Latin1 ç¼–ç  (ISO-8859-1) åœ¨ASCIIç¼–ç åŸºç¡€ä¸Šçš„æ‰©å±•ï¼Œä¸»è¦æ˜¯è¥¿æ¬§å›½å®¶çš„ï¼ŒèŒƒå›´æ˜¯125-255(å…·ä½“å­—ç¬¦å» google) Â¶GB2132ç¼–ç  å’Œ GBKç¼–ç  (ä¸­å›½) GB2132 åªæ”¶äº†å¸¸ç”¨çš„6763ä¸ªæ±‰å­— GBKåœ¨GB2132çš„åŸºç¡€ä¸Šæ‰©å±•äº†è®¸å¤šè¡Œçš„æ±‰å­— GB2132ä¸€ä¸ªæ±‰å­—ç”¨2ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¸€ä¸ªå­—èŠ‚å 8ä½æ€»å…±åˆ†ä¸º2çš„8æ¬¡æ–¹(256)ç§å¯èƒ½ï¼Œä¸¤ä¸ªå­—èŠ‚å°±æ˜¯256*256=65536ç§ä¸åŒçš„ç¬¦åˆï¼Œä½†æ˜¯ä¸­å›½åªæ‰ç”¨äº†ä¸¤ä¸ªå­—èŠ‚çš„ä½7ä½128*128=16384ç§ä¸åŒçš„æ±‰å­—ã€‚ä½†æ˜¯åœ¨GB2132ä¸­ä¸ºäº†å’ŒASCIIä¿æŒå…¼å®¹ï¼ŒGB2132çš„æ¯ä¸ªå­—èŠ‚ä¸­ä¸èƒ½åœ¨ç”¨ASCIIä¸­çš„å­—ç¬¦ç¼–ç ï¼Œæ‰€æœ‰å®é™…GB2132æ‰€èƒ½è¡¨ç¤ºçš„åªæœ‰94*94=8836ä¸ªã€‚ Â¶BIG5ç¼–ç  (å°æ¹¾) Â¶ISOç»„ç»‡çš„Unicodeå­—ç¬¦é›† Unicodeçš„ç¼–ç æ–¹å¼ï¼šUTF-8/UTF-16/UTF-32 Unicode é‡‡ç”¨4ä¸ªå­—èŠ‚æ¥è¡¨è¾¾ä¸€ä¸ªå­—ç¬¦ Â¶UTF-8çš„ç¼–ç è§„åˆ™ Unicodeç¼–ç (16è¿›åˆ¶) UTF-8å­—èŠ‚æµ(äºŒè¿›åˆ¶) 0000-007F 0xxxxxxx 0080-07FF 110xxxxx 10xxxxxx 0800-FFFF 1110xxxx 10xxxxxx 10xxxxxx 010000-10FFFF 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx ä¸­å›½çš„æ±‰å­—èŒƒå›´æ˜¯4E00-9FFF,æ ¹æ®ä¸Šé¢çš„è§„åˆ™å¯ä»¥çœ‹å‡ºï¼Œæ˜¯0800-FFFFåŒºé—´ï¼Œæ‰€ä»¥UTF-8çš„æ±‰å­—æ˜¯3ä¸ªå­—èŠ‚ã€‚ å¦‚ä½•æŠŠâ€™åŒ—äº¬â€™çš„unicodeç  â€˜21271â€™,'20140â€™è½¬ä¸ºUTF-8. ç®—å‡ºæ¯ä¸ªå­—çš„äºŒè¿›åˆ¶ ä»å³è‡³å·¦ä¸€æ¬¡å¡«å……ï¼Œä¸è¶³è¡¥0ï¼š 1110xxxx 10xxxxxx 10xxxxxx åœ¨å°†äºŒè¿›åˆ¶è½¬ä¸º16è¿›åˆ¶ å°†16è¿›åˆ¶ç¼–è¾‘åˆ°ç¼–è¾‘å™¨ï¼Œå·²UTF-8æŸ¥çœ‹ Â¶UTF-16çš„ç¼–ç è§„åˆ™ å’Œ UTF-8ç±»ä¼¼ï¼Œé‡‡ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ä¸å…¼å®¹ASCIIç ï¼Œå¦‚æœå­˜å‚¨è‹±æ–‡åŠ¿å¿…ä¼šé€ æˆç©ºé—´çš„æµªè´¹ Â¶GBKå’ŒUTF-8å¦‚ä½•é€‰æ‹© ä¼˜å…ˆé€‰æ‹©UTF-8 ä¸ºäº†èŠ‚çœå­˜å‚¨ç©ºé—´é€‰æ‹©GBK æ”¯æŒå¤šç§è¯­è¨€é€‰æ‹©UTF-8 PHP ä¸­çš„json_encode()æ˜¯åªæ”¯æŒUTF-8çš„æ±‰å­—ã€‚","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"å­—ç¬¦ä¸²","slug":"å­—ç¬¦ä¸²","permalink":"http://blog.nicexiangcun.com/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"}]},{"title":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","date":"2017-02-18T12:40:02.000Z","updated":"2020-11-20T13:06:15.521Z","comments":true,"path":"2017/02/18/å¾®æœåŠ¡/","link":"","permalink":"http://blog.nicexiangcun.com/2017/02/18/%E5%BE%AE%E6%9C%8D%E5%8A%A1/","excerpt":"Â¶å¾®æœåŠ¡ç›®çš„\nä¸€ç›´åœ¨è¯´å¾®æœåŠ¡ï¼Œå¾®æœåŠ¡åˆ°åº•èƒ½å¸¦æ¥ä»€ä¹ˆå¥½å¤„å‘¢ï¼Œä»è€æ¿çš„è§’åº¦æ¥è¯´ï¼Œä»–ä»¬çœŸæ­£åªåœ¨ä¹ä¸¤ä»¶äº‹æƒ…ï¼š\nç³»ç»Ÿè¦ç¨³å®šï¼Œåˆ«æŒ‚\nå‡ºæ´»è¦å¿«ï¼Œæˆ‘è®©ä½ ä»¬åŠ ä»€ä¹ˆåŠŸèƒ½ï¼Œèµ¶ç´§å°±ç»™åŠ ä¸Š\nç¨³å®šæ€§å’Œäº¤ä»˜é€Ÿåº¦å°±æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªæŒ‡æ ‡äº†ã€‚\nÂ¶å¾®æœåŠ¡åˆ‡åˆ†\næŠŠä¸€ä¸ªå•ä½“åº”ç”¨åˆ‡åˆ†ä¸ºå¤šä¸ªè¿›ç¨‹ï¼Œç‹¬ç«‹éƒ¨ç½²æ˜¯å¿…ç„¶çš„ã€‚ç‹¬ç«‹å‘å¸ƒï¼Œç‹¬ç«‹æµ‹è¯•ï¼Œç‹¬ç«‹æµæ°´çº¿ï¼Œæ— è®ºæ€ä¹ˆæ‹†åˆ†ï¼Œéƒ½ä¼šæ¯”åˆåœ¨ä¸€èµ·è¦å¥½ã€‚ä½†æ˜¯ä¹Ÿä¼šè®¾è®¡åˆ°è·¨è¿›ç¨‹çš„äº‹åŠ¡ä¸€è‡´æ€§é—®é¢˜å¦‚ä½•ä¿è¯ï¼Œä»¥åŠè·¨ç½‘ç»œå»¶æ—¶ç­‰ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚","text":"Â¶å¾®æœåŠ¡ç›®çš„ ä¸€ç›´åœ¨è¯´å¾®æœåŠ¡ï¼Œå¾®æœåŠ¡åˆ°åº•èƒ½å¸¦æ¥ä»€ä¹ˆå¥½å¤„å‘¢ï¼Œä»è€æ¿çš„è§’åº¦æ¥è¯´ï¼Œä»–ä»¬çœŸæ­£åªåœ¨ä¹ä¸¤ä»¶äº‹æƒ…ï¼š ç³»ç»Ÿè¦ç¨³å®šï¼Œåˆ«æŒ‚ å‡ºæ´»è¦å¿«ï¼Œæˆ‘è®©ä½ ä»¬åŠ ä»€ä¹ˆåŠŸèƒ½ï¼Œèµ¶ç´§å°±ç»™åŠ ä¸Š ç¨³å®šæ€§å’Œäº¤ä»˜é€Ÿåº¦å°±æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªæŒ‡æ ‡äº†ã€‚ Â¶å¾®æœåŠ¡åˆ‡åˆ† æŠŠä¸€ä¸ªå•ä½“åº”ç”¨åˆ‡åˆ†ä¸ºå¤šä¸ªè¿›ç¨‹ï¼Œç‹¬ç«‹éƒ¨ç½²æ˜¯å¿…ç„¶çš„ã€‚ç‹¬ç«‹å‘å¸ƒï¼Œç‹¬ç«‹æµ‹è¯•ï¼Œç‹¬ç«‹æµæ°´çº¿ï¼Œæ— è®ºæ€ä¹ˆæ‹†åˆ†ï¼Œéƒ½ä¼šæ¯”åˆåœ¨ä¸€èµ·è¦å¥½ã€‚ä½†æ˜¯ä¹Ÿä¼šè®¾è®¡åˆ°è·¨è¿›ç¨‹çš„äº‹åŠ¡ä¸€è‡´æ€§é—®é¢˜å¦‚ä½•ä¿è¯ï¼Œä»¥åŠè·¨ç½‘ç»œå»¶æ—¶ç­‰ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚ Â¶å¾®æœåŠ¡ä¹‹é—´è°ƒç”¨å’Œå¼‚æ­¥åŒ– SOAPå’ŒRPCéƒ½æ˜¯SOAçš„å…·ä½“å®ç°æ–¹å¼ã€‚è¿™é‡Œè¦è¯´çš„æ˜¯ç”±äºæœåŠ¡çš„æ‹†åˆ†ï¼Œæ¶ˆæ¯æ€»çº¿æˆ–è€…æ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿæ˜¯é‡è¦çš„ä¸€ä¸ªè®¾è®¡ç¯èŠ‚ï¼Œå› ä¸ºRPC å’Œæ¶ˆæ¯é˜Ÿåˆ—æœ€æœ¬è´¨çš„åŒºåˆ«ï¼Œä¸æ˜¯ç½‘ç»œå¼€é”€ï¼Œä¸æ˜¯æé«˜å¹¶å‘ï¼Œè€Œæ˜¯èŒè´£çš„åè½¬ã€‚æ¯”å¦‚æˆ‘ä»¬å¼€å‘ä¸­ç»å¸¸é‡åˆ°è¿™æ ·çš„ä¸šåŠ¡æµç¨‹ï¼Œå¡åˆ¸å›¢é˜Ÿå¯¹è®¢å•å›¢é˜Ÿè¯´ä½ ä»¬ä¸‹å•çš„æ—¶å€™è¦è°ƒä¸€ä¸‹æˆ‘çš„æ¥å£æˆ‘è¦é€å¡åˆ¸â€¦,å¯ä»¥è½¬å˜æˆä¸æ˜¯æˆ‘è°ƒä½ è€Œæ˜¯ä½ ä¸»åŠ¨æ¥å–ã€‚æˆ‘åªè¦å°†äº‹ä»¶handleæ”¾è¿›æ¶ˆæ¯é˜Ÿåˆ—å°±okå•¦ã€‚å½“ç„¶RPCå¥½è¿˜æ˜¯èµ°æ¶ˆæ¯é˜Ÿåˆ—å¥½ï¼Œè¿˜æ˜¯è¦æ ¹æ®ä¸šåŠ¡å»åšæƒè¡¡ã€‚","raw":null,"content":null,"categories":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/categories/devops/"}],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://blog.nicexiangcun.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"devops","slug":"devops","date":"2016-12-04T02:49:07.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2016/12/04/devops/","link":"","permalink":"http://blog.nicexiangcun.com/2016/12/04/devops/","excerpt":"\ndevops\n\n\nè™½ç„¶ä¸å–œæ¬¢devopsï¼Œä½†æ˜¯è¿˜æ˜¯è¦æ€»ç»“ä¸€ä¸‹åœ¨devopsä¸­é‡åˆ°ä¸€äº›æ‰€ä½¿ç”¨çš„å·¥å…·ã€‚\nhttps://github.com/integrations\n\n\nÂ¶git\nhttp://blog.ffanfood.com/2016/07/09/git\n\nÂ¶ä»£ç æ‰˜ç®¡å’Œä»£ç å®¡æŸ¥\ngitlab / github ï¼ Code Review\n\nÂ¶CI è‡ªåŠ¨åŒ–æ„ä»¶ï¼Œæµ‹è¯•ï¼Œéƒ¨ç½²\nCircleCI ï¼ Travis CI\n\nÂ¶æ—¥å¿—èšé›†\nSlack  https://slack.com/\n\nÂ¶é¡¹ç›®ä¸äº‹åŠ¡è·Ÿè¸ª\nJIRA https://github.com/integrations/jira-software\n\nÂ¶å‰ç«¯åç«¯è§£è—•ï¼ˆå¥‘çº¦æµ‹è¯•ï¼‰","text":"devops è™½ç„¶ä¸å–œæ¬¢devopsï¼Œä½†æ˜¯è¿˜æ˜¯è¦æ€»ç»“ä¸€ä¸‹åœ¨devopsä¸­é‡åˆ°ä¸€äº›æ‰€ä½¿ç”¨çš„å·¥å…·ã€‚ https://github.com/integrations Â¶git http://blog.ffanfood.com/2016/07/09/git Â¶ä»£ç æ‰˜ç®¡å’Œä»£ç å®¡æŸ¥ gitlab / github ï¼ Code Review Â¶CI è‡ªåŠ¨åŒ–æ„ä»¶ï¼Œæµ‹è¯•ï¼Œéƒ¨ç½² CircleCI ï¼ Travis CI Â¶æ—¥å¿—èšé›† Slack https://slack.com/ Â¶é¡¹ç›®ä¸äº‹åŠ¡è·Ÿè¸ª JIRA https://github.com/integrations/jira-software Â¶å‰ç«¯åç«¯è§£è—•ï¼ˆå¥‘çº¦æµ‹è¯•ï¼‰ http://www.infoq.com/cn/articles/power-of-raml å·¥å…·ä¸å®‰è£…ï¼š 1. éœ€è¦Nodeç¯å¢ƒï¼Œä¸‹è½½nodejsï¼šhttps://nodejs.org/en/ ï¼Œé€‰æ‹©LTSç‰ˆæœ¬ 2. RAML APIè®¾è®¡å™¨ï¼šnpm install -g api-designer ç½‘é¡µç‰ˆide 3. å¯¹äºå‰ç«¯ï¼ˆæœåŠ¡è°ƒç”¨è€…ï¼‰ï¼šnpm install -g osprey-mock-service 4. å¯¹äºåç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰ï¼šnpm install -g abao 5. ideå·¥å…·: Atom https://atom.io/ï¼Œç„¶åæŒ‰ç…§æ‰©å±•api-workbenchï¼Œç±»ä¼¼phpstorm 6. PostMan éœ€è¦å®‰è£…cookieæ‰©å±• ç›¸å…³å‘½ä»¤ï¼š api-designer ç½‘é¡µç‰ˆide: 1. å‘½ä»¤è¡Œè¾“å…¥api-designerå¯åŠ¨ï¼Œæµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€http://localhost:3000/ osprey-mock-service å‰ç«¯ï¼š 1. å‘½ä»¤è¡Œè¾“å…¥ osprey-mock-service --cors -f wallet-list.raml -p 6060 2. è¿”å›ï¼šMock service running at http://localhost:6060 æˆåŠŸçŠ¶æ€ 3. PostManä¸­è¾“å…¥åœ°å€è°ƒè¯•ï¼ŒHeaderéœ€æ·»åŠ Content-Typeï¼šapplication/x-www-form-urlencoded 4. --cors è§£å†³jsè·¨åŸŸé—®é¢˜ abao åç«¯ï¼š 1. å‘½ä»¤è¡Œè¾“å…¥abao raml-specs/wallet-list.raml -t 15000 -f login.js --server http://www.abc.com 2. --server å°±æ˜¯baseUriï¼Œ -t æ˜¯å“åº”æ—¶é—´ï¼Œ æ–‡æ¡£ä¸è§„èŒƒï¼š RAML è§„èŒƒå®˜ç½‘ï¼š raml.org RAML è¯¦ç»†è§„èŒƒï¼š fhttps://github.com/raml-org/raml-spec/blob/master/versions/raml-08/raml-08.md RAML ç¤ºä¾‹ï¼š http://static-anypoint-mulesoft-com.s3.amazonaws.com/API_examples_notebooks/raml-design3.html API è¿”å›å€¼è§„èŒƒï¼š http://json-schema.org/ ä½œç”¨ï¼š 1. æ–‡æ¡£ä¸è§„èŒƒ 2. è‡ªåŠ¨åŒ–æµ‹è¯• 3. MockæœåŠ¡æ¨¡æ‹Ÿ å·¥ç¨‹ç›®å½•å‚è€ƒ https://github.com/raml-apis","raw":null,"content":null,"categories":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/categories/devops/"}],"tags":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/tags/devops/"}]},{"title":"php-trait","slug":"php-trait","date":"2016-11-30T13:42:12.000Z","updated":"2020-11-20T13:06:15.515Z","comments":true,"path":"2016/11/30/php-trait/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/30/php-trait/","excerpt":"","text":"Â¶å•ä¾‹æ¨¡å¼ å¦‚æœclass new èµ·æ¥å«Œéº»çƒ¦ï¼ŒğŸ‘™ æˆ–è€…æƒ³ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œè¯·åœ¨ä½ çš„classä¸­ use Singleton 12345678910111213141516171819202122232425trait Singleton&#123; protected static $__instances__ = array(); protected function __construct() &#123; &#125; public function __clone() &#123; throw new \\Exception(&#x27;Cloning &#x27;.__CLASS__.&#x27; is not allowed&#x27;); &#125; public static function getInstance() &#123; $class = get_called_class(); if (!isset(static::$__instances__[$class])) &#123; static::$__instances__[$class] = new static(); &#125; return static::$__instances__[$class]; &#125; public static function resetInstance() &#123; $class = get_called_class(); unset(static::$__instances__[$class]); &#125;&#125; 12345678910111213class Order extends \\AbstractOrder&#123; use Singleton public function getOrderInfo()&#123; //todo &#125;&#125;Order::getInstance()-&gt;getOrderInfo(); Â¶laravel å¤šå¤ªå…³è”ç»“åˆtrait","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"trait","slug":"trait","permalink":"http://blog.nicexiangcun.com/tags/trait/"}]},{"title":"éå¸¸collçš„æ¡†æ¶ vue-js","slug":"vue-js","date":"2016-11-22T13:49:03.000Z","updated":"2020-11-20T13:06:15.519Z","comments":true,"path":"2016/11/22/vue-js/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/22/vue-js/","excerpt":"Â¶æ•°æ®åŒå‘ç»‘å®š\nv-model ä½¿ç”¨äº input ,textarea å°†å±æ€§å’Œæˆ‘ä»¬çš„ dataå¯¹è±¡ä¸­çš„å±æ€§ç»‘å®šåœ¨ä¸€èµ·\n12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;vue-js&lt;/title&gt;        &lt;script type=&quot;text/javascript&quot; src=&quot;./node_modules/vue/dist/vue.js&quot;&gt;&lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;div id=&quot;app&quot;&gt;            &lt;h1&gt;&#123;&#123; message &#125;&#125;&lt;/h1&gt;            &lt;input type=&quot;text&quot; v-model=&quot;message&quot;&gt;            &lt;pre&gt;                &#123;&#123; $data | json &#125;&#125;            &lt;/pre&gt;        &lt;/div&gt;    &lt;/body&gt;    &lt;script&gt;        new Vue(&#123;            el:&#x27;#app&#x27;,            data:&#123;                message:&#x27;hello world !!&#x27;            &#125;        &#125;)    &lt;/script&gt;&lt;/html&gt;","text":"Â¶æ•°æ®åŒå‘ç»‘å®š v-model ä½¿ç”¨äº input ,textarea å°†å±æ€§å’Œæˆ‘ä»¬çš„ dataå¯¹è±¡ä¸­çš„å±æ€§ç»‘å®šåœ¨ä¸€èµ· 12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;vue-js&lt;/title&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;./node_modules/vue/dist/vue.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;h1&gt;&#123;&#123; message &#125;&#125;&lt;/h1&gt; &lt;input type=&quot;text&quot; v-model=&quot;message&quot;&gt; &lt;pre&gt; &#123;&#123; $data | json &#125;&#125; &lt;/pre&gt; &lt;/div&gt; &lt;/body&gt; &lt;script&gt; new Vue(&#123; el:&#x27;#app&#x27;, data:&#123; message:&#x27;hello world !!&#x27; &#125; &#125;) &lt;/script&gt;&lt;/html&gt; Â¶v-show å’Œ v-if 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Vue-js&lt;/title&gt; &lt;style&gt; #main&#123;border: 1px;width:800px;margin:100px auto;&#125; .name&#123;width:600px;height: 40px&#125; .passwd&#123;width:600px;height: 50px&#125; .name label&#123;display:inline-block;width: 60px&#125; .passwd label&#123;display:inline-block;width: 60px&#125; .error&#123;color:red&#125; &lt;/style&gt;&lt;/head&gt;&lt;!--v-show å’Œ v-if çš„ä½¿ç”¨--&gt;&lt;body&gt; &lt;div id=&quot;main&quot;&gt; &lt;div id=&quot;app&quot;&gt; &lt;form action=&quot;&quot;&gt; &lt;div class=&quot;name&quot;&gt; &lt;label&gt;ç”¨æˆ·å:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;&quot; value=&quot;&quot; v-model=&quot;username&quot;&gt; &lt;span class=&quot;error&quot; v-show=&quot;!username&quot;&gt;è¯·è¾“å…¥ç”¨æˆ·å&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;passwd&quot;&gt; &lt;label&gt;å¯†ç :&lt;/label&gt; &lt;input type=&quot;password&quot; name=&quot;&quot; value=&quot;&quot; v-model=&quot;password&quot;&gt; &lt;span class=&quot;error&quot; v-show=&quot;!password&quot;&gt;è¯·è¾“å…¥å¯†ç &lt;/span&gt; &lt;/div&gt; &lt;button v-show=&quot;username &amp;&amp; password&quot;&gt;ç™»å½•&lt;/button&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;./node_modules/vue/dist/vue.js&quot;&gt;&lt;/script&gt;&lt;script&gt; new Vue(&#123; el:&#x27;#app&#x27;, data:&#123; username : &#x27;&#x27;, password : &#x27;&#x27; &#125; &#125;)&lt;/script&gt;&lt;/html&gt;","raw":null,"content":null,"categories":[{"name":"vue","slug":"vue","permalink":"http://blog.nicexiangcun.com/categories/vue/"}],"tags":[{"name":"vue","slug":"vue","permalink":"http://blog.nicexiangcun.com/tags/vue/"}]},{"title":"mac å¼€å‘å¤§æ‚çƒ©","slug":"mac","date":"2016-11-21T12:42:26.000Z","updated":"2020-11-20T13:06:15.514Z","comments":true,"path":"2016/11/21/mac/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/21/mac/","excerpt":"\nğŸ‘€ macç»ˆç«¯å¸¸ç”¨é…ç½®\nÂ¶å®‰è£…oh my zsh\né¦–å…ˆå®‰è£… iterm2  http://www.iterm2.com\nç„¶åè¿›å…¥ http://ohmyz.sh æ ¹æ®ä»¥ä¸‹æ–‡æ¡£å®‰è£… zshrc\n123git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zshcp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc\né…ç½®\nzsh çš„é…ç½®ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·å½“å‰ç›®å½•çš„.zshrcé‡Œï¼Œç”¨ vim æˆ–ä½ å–œæ¬¢çš„å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€.zshrcï¼š\n123456789101112131415161718alias cls=&#x27;clear&#x27;alias ll=&#x27;ls -l&#x27;alias la=&#x27;ls -a&#x27;alias vi=&#x27;vim&#x27;alias javac=&quot;javac -J-Dfile.encoding=utf8&quot;alias grep=&quot;grep --color=auto&quot;alias -s html=mate   # åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥åç¼€ä¸º html çš„æ–‡ä»¶åï¼Œä¼šåœ¨ TextMate ä¸­æ‰“å¼€alias -s rb=mate     # åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ ruby æ–‡ä»¶ï¼Œä¼šåœ¨ TextMate ä¸­æ‰“å¼€alias -s py=vi       # åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ python æ–‡ä»¶ï¼Œä¼šç”¨ vim ä¸­æ‰“å¼€ï¼Œä»¥ä¸‹ç±»ä¼¼alias -s js=vialias -s c=vialias -s java=vialias -s txt=vialias -s gz=&#x27;tar -xzvf&#x27;alias -s tgz=&#x27;tar -xzvf&#x27;alias -s zip=&#x27;unzip&#x27;alias -s bz2=&#x27;tar -xjvf&#x27;","text":"ğŸ‘€ macç»ˆç«¯å¸¸ç”¨é…ç½® Â¶å®‰è£…oh my zsh é¦–å…ˆå®‰è£… iterm2 http://www.iterm2.com ç„¶åè¿›å…¥ http://ohmyz.sh æ ¹æ®ä»¥ä¸‹æ–‡æ¡£å®‰è£… zshrc 123git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zshcp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc é…ç½® zsh çš„é…ç½®ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·å½“å‰ç›®å½•çš„.zshrcé‡Œï¼Œç”¨ vim æˆ–ä½ å–œæ¬¢çš„å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€.zshrcï¼š 123456789101112131415161718alias cls=&#x27;clear&#x27;alias ll=&#x27;ls -l&#x27;alias la=&#x27;ls -a&#x27;alias vi=&#x27;vim&#x27;alias javac=&quot;javac -J-Dfile.encoding=utf8&quot;alias grep=&quot;grep --color=auto&quot;alias -s html=mate # åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥åç¼€ä¸º html çš„æ–‡ä»¶åï¼Œä¼šåœ¨ TextMate ä¸­æ‰“å¼€alias -s rb=mate # åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ ruby æ–‡ä»¶ï¼Œä¼šåœ¨ TextMate ä¸­æ‰“å¼€alias -s py=vi # åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ python æ–‡ä»¶ï¼Œä¼šç”¨ vim ä¸­æ‰“å¼€ï¼Œä»¥ä¸‹ç±»ä¼¼alias -s js=vialias -s c=vialias -s java=vialias -s txt=vialias -s gz=&#x27;tar -xzvf&#x27;alias -s tgz=&#x27;tar -xzvf&#x27;alias -s zip=&#x27;unzip&#x27;alias -s bz2=&#x27;tar -xjvf&#x27; å®‰è£…å®Œæˆï¼Œç»ˆç«¯è¾“å…¥zshè¿›å…¥ zsh Â¶å®‰è£… zsh-autosuggestions 1git clone git://github.com/zsh-users/zsh-autosuggestions ~/.zsh/zsh-autosuggestions åœ¨ .zshrc æ·»åŠ ï¼š 1source ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh æœ€å source ~/.zshrc æ›´å¤š oh my zsh é…ç½®å‚è€ƒï¼š https://zhuanlan.zhihu.com/p/19556676 Â¶iterm2 çš„é…ç½® zshçš„ä¸»é¢˜ ï¼š sudo vi ~/.zshrc ä¸‹çš„ ZSH_THEME=â€œcloudâ€ iterm2çš„ä¸»é¢˜ï¼š https://github.com/mbadolato/iTerm2-Color-Schemes https://draculatheme.com , Dracula.itermcolors (éå¸¸ä¸é”™å“¦) æ­¥éª¤ï¼šclone é€‰å¥½çš„é…è‰²ï¼Œcommand + , å‘¼å‡ºé…ç½®é¡¹ æ–°å»º profiles ,é€‰æ‹© Colors é€‰é¡¹å¯¼å…¥é…è‰²æ–‡ä»¶,å¯¼å…¥æˆåŠŸåï¼Œè¿˜è¦åœ¨ iTerm2 - Preferences - Profiles - Colors é‡Œé¢å³ä¸‹æ–¹çš„ Color Presets é‡Œé¢æœ‰æ²¡æœ‰åˆšåˆšå¯¼å…¥çš„ä¸»é¢˜å¦‚å›¾ã€‚ ç„¶å command + o å¯ä»¥é€‰æ‹©é…è‰²å®ç”¨äº† ç»å¸¸ä½¿ç”¨çš„å¿«æ·é”® command + o é€‰æ‹©ä¸»é¢˜é…è‰² command ï¼‹ å·¦å³ç®­å¤´ æ¥å›åˆ‡æ¢ command + enter åˆ‡æ¢å…¨å± command + ; æŸ¥çœ‹å†å²å‘½ä»¤ command + shift + h æŸ¥çœ‹å‰ªè´´æ¿å†å² ctrl + u æ¸…é™¤å½“å‰è¡Œ(åºŸé™¤å½“å‰å‘½ä»¤) ctrl + r æœç´¢å‘½ä»¤å†å² ctrl + d åˆ é™¤å½“å‰å…‰æ ‡çš„å­—ç¬¦ ctrl + h åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å­—ç¬¦ ctrl + w åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å•è¯ ctrl + k åˆ é™¤åˆ°æ–‡æœ¬æœ«å°¾ ctrl + t äº¤æ¢å…‰æ ‡å¤„æ–‡æœ¬ command + r æ¸…å±1 ctrl + l æ¸…å±2","raw":null,"content":null,"categories":[{"name":"mac","slug":"mac","permalink":"http://blog.nicexiangcun.com/categories/mac/"}],"tags":[{"name":"mac","slug":"mac","permalink":"http://blog.nicexiangcun.com/tags/mac/"}]},{"title":"laravel-è®¾è®¡æ¨¡å¼","slug":"laravel-è®¾è®¡æ¨¡å¼","date":"2016-11-18T15:03:31.000Z","updated":"2020-11-20T13:06:15.513Z","comments":true,"path":"2016/11/18/laravel-è®¾è®¡æ¨¡å¼/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/18/laravel-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","excerpt":"\nÂ¶å®¹å™¨æ³¨å…¥\nå…³é”®è¯ï¼š ä¾èµ–å€’ç½®,ä¾èµ–æ³¨å…¥\nç›¸å½“äºYiiä¸­çš„DIå®¹å™¨ï¼Œä½¿ç”¨ç›®çš„ï¼Œç”±äºåœ¨æˆ‘ä»¬å¹³æ—¶å†™ä»£ç è¿‡ç¨‹ä¸­ä½¿ç”¨newè¿™ä¸ªå…³é”®å­—è¢«è§†ä¸ºä¸€ç§ä¸å¥½çš„ä¹ æƒ¯ï¼Œæ‰€ä»¥laravelä¸­æä¾›äº†ä¸¤ç§ç±»å‹ï¼ˆå¤šç§æ–¹æ³•ï¼‰æ¥å¸®æˆ‘ä»¬è‡ªåŠ¨å®ä¾‹åŒ–ç±»ã€‚\nç¬¬ä¸€ç§æ–¹å¼ï¼šPHP åå°„æœºåˆ¶\nlaravel ä¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªç±»è§¦å‘äº†æ„é€ æ–¹æ³•çš„æ—¶å€™æ£€æŸ¥æ„é€ æ–¹æ³•æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå¹¶ä¸”è‡ªåŠ¨å®ä¾‹åŒ–ã€‚ä¸æ˜¯å…¨å±€çš„ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯å»è®¾è®¡ã€‚\nç¬¬äºŒç§æ–¹å¼ï¼šå…¨å±€çš„ App:bind() å’Œ serviceProvider æ–¹æ³• å¦‚ï¼š\n1234567891011class Foo&#123;&#125;App::bind(&#x27;foo&#x27;,function()&#123;\treturn new Foo();&#125;)app()-&gt;make(&#x27;foo&#x27;)-&gt;method();\nlaravelä¸­æ˜¯ç”¨serviceProviderä¸­çš„registeræ–¹æ³• æ¥å¸®é¡¶æˆ‘ä»¬éœ€è¦çš„ä¾èµ–å•å…ƒ å¦‚\n12345678protected function register()&#123;\t$this-&gt;app-&gt;singleton(&#x27;file&#x27;,function()&#123;\t\treturn new Files;\t&#125;);&#125;","text":"Â¶å®¹å™¨æ³¨å…¥ å…³é”®è¯ï¼š ä¾èµ–å€’ç½®,ä¾èµ–æ³¨å…¥ ç›¸å½“äºYiiä¸­çš„DIå®¹å™¨ï¼Œä½¿ç”¨ç›®çš„ï¼Œç”±äºåœ¨æˆ‘ä»¬å¹³æ—¶å†™ä»£ç è¿‡ç¨‹ä¸­ä½¿ç”¨newè¿™ä¸ªå…³é”®å­—è¢«è§†ä¸ºä¸€ç§ä¸å¥½çš„ä¹ æƒ¯ï¼Œæ‰€ä»¥laravelä¸­æä¾›äº†ä¸¤ç§ç±»å‹ï¼ˆå¤šç§æ–¹æ³•ï¼‰æ¥å¸®æˆ‘ä»¬è‡ªåŠ¨å®ä¾‹åŒ–ç±»ã€‚ ç¬¬ä¸€ç§æ–¹å¼ï¼šPHP åå°„æœºåˆ¶ laravel ä¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªç±»è§¦å‘äº†æ„é€ æ–¹æ³•çš„æ—¶å€™æ£€æŸ¥æ„é€ æ–¹æ³•æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå¹¶ä¸”è‡ªåŠ¨å®ä¾‹åŒ–ã€‚ä¸æ˜¯å…¨å±€çš„ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯å»è®¾è®¡ã€‚ ç¬¬äºŒç§æ–¹å¼ï¼šå…¨å±€çš„ App:bind() å’Œ serviceProvider æ–¹æ³• å¦‚ï¼š 1234567891011class Foo&#123;&#125;App::bind(&#x27;foo&#x27;,function()&#123; return new Foo();&#125;)app()-&gt;make(&#x27;foo&#x27;)-&gt;method(); laravelä¸­æ˜¯ç”¨serviceProviderä¸­çš„registeræ–¹æ³• æ¥å¸®é¡¶æˆ‘ä»¬éœ€è¦çš„ä¾èµ–å•å…ƒ å¦‚ 12345678protected function register()&#123; $this-&gt;app-&gt;singleton(&#x27;file&#x27;,function()&#123; return new Files; &#125;);&#125; è€Œæ‰€æœ‰çš„ serviceProvider éƒ½ä¼šä¸­laravel çš„app.config ä¸‹é…ç½®ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç±»ç±»(php artisan make:privace æ³¨å†Œçš„æœåŠ¡)ã€‚ 12345678910111213//app() æ­¤æ–¹æ³•åœ¨å…¥å£æ–‡ä»¶ index.php ä¸­app()-&gt;make(&#x27;file&#x27;)-&gt;method();app()[&#x27;file&#x27;]-&gt;method();app(&#x27;file&#x27;)-&gt;method();//é€šè¿‡é—¨é¢æ–¹å¼è®¿é—®file::method(); ä½¿ç”¨ serviceProviderçš„å¥½å¤„ï¼Œå¦‚æœè¿™ä¸ªç±»ä¾èµ–è¿‡å¤šçš„ä¾èµ–å•å…ƒå¯ä»¥ç§registerçš„æ—¶å€™ä¸€æ¬¡å¤„ç†å¥½ï¼Œä¸ç”¨ä¸šåŠ¡å±‚æ¯æ¬¡é‡æ–°æ„é€ ã€‚ Â¶é—¨é¢ Facade laravel ä¸­æä¾›äº†ä¸€ä¸ªfacadeæœåŠ¡å±‚æ¥å…±åº”ç”¨æˆå¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ä¸€æ ·è®¿é—®ç±»ä¸­çš„æˆå‘˜æ–¹æ³• 12345678910111213public static function __callStatic($method, $args)&#123; /* * è¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯laravelä¸­ facade ä¸­çš„ï¼Œæ¼”ç¤ºè€Œå·²ï¼Œnew static()é€šå¸¸ä¼šæ›¿æ¢æˆå­ç±»ä¸­æ„é€ æ³¨å…¥æˆ–è€…æ–¹æ³•æ³¨å…¥çš„ä¸€ä¸ªä¾èµ–ï¼Œæ‰€ä»¥ * è¿™é‡Œæœ‰ä¸ªé—®é¢˜ä¸€ç›´æ˜¯ä¸ªç–‘æƒ‘ï¼Œnew static() ï¼Œåœ¨è¿™é‡Œä¼šæ³¨å…¥ä¾èµ–æ˜¾ç„¶ä¸åˆç†ï¼Œä¸çŸ¥é“ï¼Œjwtç¬¬ä¸‰æ–¹æ˜¯æ€ä¹ˆåšçš„ */ $method = &#x27;dep&#x27;.ucfirst($method); if (method_exists(new static(), $method)) &#123; return call_user_func_array([new static(), $method], $args); &#125; throw new \\BadMethodCallException(&quot;Method [$method] does not exist.&quot;);&#125;","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"red-packet","slug":"red-packet","date":"2016-11-16T14:12:34.000Z","updated":"2020-11-20T13:06:15.517Z","comments":true,"path":"2016/11/16/red-packet/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/16/red-packet/","excerpt":"","text":"cmdçš„ä¸€ä¸ªä½¿ç”¨æŠ€å·§ sudo !! , rootçš„èº«ä»½æ‰§è¡Œä¸Šæ¬¡å‘½ä»¤","raw":null,"content":null,"categories":[],"tags":[]},{"title":"phpstorm vagrant xdebug","slug":"xdebug","date":"2016-11-13T12:57:35.000Z","updated":"2020-11-20T13:06:15.519Z","comments":true,"path":"2016/11/13/xdebug/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/13/xdebug/","excerpt":"phpstorm ç»“åˆhomestead é…ç½®xdebug ğŸ‘ \nÂ¶ç¼–è¾‘phpé…ç½®æ–‡ä»¶\nhomestead ssh\nsudo vi /etc/php/7.0/fpm/conf.d/20-xdebug.ini\næ·»åŠ  ï¼š\n123456789zend_extension=/usr/lib/php/20151012/xdebug.soxdebug.remote_enable = 1xdebug.remote_connect_back = 1xdebug.remote_port = 9000xdebug.scream=0xdebug.cli_color=1xdebug.show_local_vars=1\né‡å¯fpm\nsudo service php7.0-fpm restart","text":"phpstorm ç»“åˆhomestead é…ç½®xdebug ğŸ‘  Â¶ç¼–è¾‘phpé…ç½®æ–‡ä»¶ homestead ssh sudo vi /etc/php/7.0/fpm/conf.d/20-xdebug.ini æ·»åŠ  ï¼š 123456789zend_extension=/usr/lib/php/20151012/xdebug.soxdebug.remote_enable = 1xdebug.remote_connect_back = 1xdebug.remote_port = 9000xdebug.scream=0xdebug.cli_color=1xdebug.show_local_vars=1 é‡å¯fpm sudo service php7.0-fpm restart Â¶ä¸‹è½½chrom xdebug-help æ‰©å±• https://chrome.google.com/webstore/detail/eadndfjplgieldjbigjakmdgkmoaaaoc é…ç½®xdebug-helpï¼š IDE key ï¼š phpstorm Â¶phpstorm é…ç½® å‘¼å‡ºé…ç½®é¡¹ï¼Œæœç´¢phpï¼Œé€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ã€‚ é…ç½®sshé“¾æ¥vagrant ,å¦‚æœä½¿ç”¨ç§é’¥é“¾æ¥ä½ç½®åœ¨ .homestead\\.vagrant\\machines\\default\\virtualbox å¦‚æœæœ‰é—®é¢˜å¯ä»¥æŸ¥çœ‹ phpinfo xdebugæ˜¯å¦å®‰è£…æˆåŠŸ Â¶è°ƒè¯• æ‰“å¼€ phpstorm xdebug ç›‘å¬ã€‚ æ‰“å¼€ xdebug-helper æ‰©å±•ã€‚ è¾“å…¥app.devï¼Œphpstormä¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œé€‰æ‹©â€œAcceptâ€ã€‚ ç„¶åé€‰æ‹© Preferences â€”&gt; Languages &amp; Frameworks â€” &gt; PHP â€”&gt; Servers è¿™æ—¶æˆ‘ä»¬éœ€è¦ä¿®æ”¹é¡¹ç›®å¤–å±‚è·¯å¾„å¯¹åº”çš„æ˜ å°„å…³ç³»ï¼Œå¦åˆ™å°±åªèƒ½å¯¹index.phpè¿›è¡Œdebugï¼Œè€Œå…¶ä»–æ–‡ä»¶çš„æ–­ç‚¹å°†ä¸ä¼šèµ·ä½œç”¨ ç›‘å¬å¤šä¸ªåŸŸåï¼Œè¦åšserver ä¸‹é…ç½®ï¼Œå¹¶ä¸”åˆæ¬¡è®¿é—®ï¼Œå¿…é¡»è®¿é—®index.php","raw":null,"content":null,"categories":[{"name":"bug","slug":"bug","permalink":"http://blog.nicexiangcun.com/categories/bug/"}],"tags":[{"name":"xdebug","slug":"xdebug","permalink":"http://blog.nicexiangcun.com/tags/xdebug/"}]},{"title":"php7","slug":"php7","date":"2016-11-07T14:13:18.000Z","updated":"2020-11-20T13:06:15.515Z","comments":true,"path":"2016/11/07/php7/","link":"","permalink":"http://blog.nicexiangcun.com/2016/11/07/php7/","excerpt":"Â¶php7\næ’åº\n1234567891011121314$games = [&#x27;Mass Effect&#x27;,&#x27;Super&#x27;,&#x27;Zelda&#x27;,&#x27;Fallout&#x27;,&#x27;Metal Grear&#x27;];usort($games,function($a,$b))&#123;\t//return $a &lt;=&gt; $b; // if a&lt;b return -1 , a=b return 0 ,a&gt;b return 1\t  return $b &lt;=&gt; #a; \t//return $a - $b ;&#125;var_dump($games);//$games é€‚åˆäºå¯¹è±¡\nä¸‰å…ƒå£°æ˜æ›´ç®€å•\n12345678$name = &#x27;lhw&#x27;;echo $name ?? &quot;cxx&quot;;  //ç­‰ä»·äº empty($name) ? $name : &#x27;cxx&#x27; echo $_GET[&#x27;name&#x27;] ?? &#x27;cxx&#x27;; //ç­‰äº isset($_GET[&#x27;name&#x27;]) ? $_GET[&#x27;name&#x27;] : &#x27;cxx&#x27;;","text":"Â¶php7 æ’åº 1234567891011121314$games = [&#x27;Mass Effect&#x27;,&#x27;Super&#x27;,&#x27;Zelda&#x27;,&#x27;Fallout&#x27;,&#x27;Metal Grear&#x27;];usort($games,function($a,$b))&#123; //return $a &lt;=&gt; $b; // if a&lt;b return -1 , a=b return 0 ,a&gt;b return 1 return $b &lt;=&gt; #a; //return $a - $b ;&#125;var_dump($games);//$games é€‚åˆäºå¯¹è±¡ ä¸‰å…ƒå£°æ˜æ›´ç®€å• 12345678$name = &#x27;lhw&#x27;;echo $name ?? &quot;cxx&quot;; //ç­‰ä»·äº empty($name) ? $name : &#x27;cxx&#x27; echo $_GET[&#x27;name&#x27;] ?? &#x27;cxx&#x27;; //ç­‰äº isset($_GET[&#x27;name&#x27;]) ? $_GET[&#x27;name&#x27;] : &#x27;cxx&#x27;; è¿”å›ç±»å‹å£°æ˜ 123456789101112131415class User&#123;&#125;interface SomeInterface&#123; public function getUser() : User;&#125;class SomeClass implements SomeInterface &#123; public function getUser() : User &#123; return new User; &#125;&#125;(new SomeClass)-&gt;getUser 12345678910class User&#123;&#125;function getUser($id) : User &#123; if (userDoesNotExists($id)) return false; return User::find($id);&#125;var_dump(getUser()); psr4 åŠ è½½è§„èŒƒ 12345678910111213141516171819202122232425262728293031323334353637383940414243//touch composer.json&#123; &quot;autoload&quot; :&#123; &quot;psr-4&quot;:&#123; &quot;App\\\\&quot;:&quot;./&quot; &#125; &#125;&#125;//ç„¶å composer install//å»åˆ›å»ºå‡ ä¸ª class// Person.phpnamespace App;class Person&#123;&#125;//Animal.phpnamespace App;class Animal &#123;&#125;//å¦‚ä½•æ¥ä½¿ç”¨//touch index.phprequire &#x27;vendor/autoload.php&#x27;;use App\\Person;use App\\Animal;//åŒç©ºé—´ä¸‹ï¼Œæ•´åˆå¦‚ä¸‹use App\\&#123; Person, Animal, Foo\\Bar\\Baz&#125; åŒ¿åç±»çš„ç”¨æ³• 1234567891011121314151617181920212223242526272829303132333435interface Logger &#123; public function log($message);&#125;class TerminalLogger implements Logger &#123; public function log($message)&#123; var_dump($message); &#125;&#125;class Application &#123; protected $logger; public function setLogger(Logger $logger)&#123; $this-&gt;logger = $logger; return $this; &#125; public function action()&#123; $this-&gt;logger-&gt;log(&#x27;Doing things.&#x27;); &#125;&#125;$app = new Application();$app-&gt;setLogger(new TerminalLogger);$app-&gt;action(); ä½¿ç”¨åŒ¿åç±» 1234567891011121314151617181920212223242526272829303132333435363738interface Logger &#123; public function log($message);&#125;class Application &#123; protected $logger; public function setLogger(Logger $logger)&#123; $this-&gt;logger = $logger; return $this; &#125; public function action()&#123; $this-&gt;logger-&gt;log(&#x27;Doing things.&#x27;); &#125;&#125;$app = new Application();//ä½¿ç”¨åŒ¿åç±»åœ¨ ä¸šåŠ¡é€»è¾‘å±‚ ä¾èµ–æ³¨å…¥ä¸€ä¸ªå…·ä½“$app-&gt;setLogger(new class implements Logger&#123; public function log($message)&#123; var_dump($message); &#125;&#125;);$app-&gt;action(); laravel ä¸­çš„ä¾‹å­ 12345678910111213141516171819202122class BookTransformer &#123; public function transform()&#123; return []; &#125;&#125;class Item &#123; public function __construct($transformer)&#123; &#125;&#125;$item = new Item(new BookTransformer); ä½¿ç”¨åŒ¿åç±» 1234567891011121314151617181920212223class Item &#123; public function __construct($transformer)&#123; &#125;&#125;$item = new Item(new class&#123; public function transform()&#123; return [] ; &#125;&#125;);","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"php7","slug":"php7","permalink":"http://blog.nicexiangcun.com/tags/php7/"}]},{"title":"Ubuntu 14 PHP 5.6 å‡çº§åˆ°PHP 7.0","slug":"up-php7","date":"2016-10-24T04:25:28.000Z","updated":"2020-11-20T13:06:15.519Z","comments":true,"path":"2016/10/24/up-php7/","link":"","permalink":"http://blog.nicexiangcun.com/2016/10/24/up-php7/","excerpt":"Â¶Ubuntu 14 PHP 5.6 å‡çº§åˆ°PHP 7.0\nå¤‡ä»½ä¹‹å‰çš„é…ç½®ï¼Œå¤‡ä»½ä¹‹å‰çš„é…ç½®ï¼Œå¤‡ä»½ä¹‹å‰çš„é…ç½® ï¼ï¼ï¼\né€‚ç”¨äºUbuntu 14 ç‰ˆæœ¬çš„VPSï¼ŒUbuntu 16 ç‰ˆæœ¬è²Œä¼¼ç›´æ¥å°±åŒ…å«äº†php7.0\n1.å…ˆè§£å†³æœ‰å¯èƒ½å­˜åœ¨çš„è¯­è¨€é—®é¢˜\næ‰§è¡Œ\n12sudo apt-get update sudo apt-get install -y language-pack-en-base\nç„¶åå‘½ä»¤è¡Œé…ç½®ï¼š\n123locale-gen en_US.UTF-8export LANG=en_US.UTF-8export LC_ALL=en_US.UTF-8\n2.åˆ é™¤åŸæ¥çš„php5.6\n1sudo apt-get purge php5-fpm &amp;&amp; apt-get --purge autoremove\n3.æ·»åŠ php7.0çš„ä»“åº“\n12sudo apt-get install software-properties-commonsudo add-apt-repository ppa:ondrej/php","text":"Â¶Ubuntu 14 PHP 5.6 å‡çº§åˆ°PHP 7.0 å¤‡ä»½ä¹‹å‰çš„é…ç½®ï¼Œå¤‡ä»½ä¹‹å‰çš„é…ç½®ï¼Œå¤‡ä»½ä¹‹å‰çš„é…ç½® ï¼ï¼ï¼ é€‚ç”¨äºUbuntu 14 ç‰ˆæœ¬çš„VPSï¼ŒUbuntu 16 ç‰ˆæœ¬è²Œä¼¼ç›´æ¥å°±åŒ…å«äº†php7.0 1.å…ˆè§£å†³æœ‰å¯èƒ½å­˜åœ¨çš„è¯­è¨€é—®é¢˜ æ‰§è¡Œ 12sudo apt-get update sudo apt-get install -y language-pack-en-base ç„¶åå‘½ä»¤è¡Œé…ç½®ï¼š 123locale-gen en_US.UTF-8export LANG=en_US.UTF-8export LC_ALL=en_US.UTF-8 2.åˆ é™¤åŸæ¥çš„php5.6 1sudo apt-get purge php5-fpm &amp;&amp; apt-get --purge autoremove 3.æ·»åŠ php7.0çš„ä»“åº“ 12sudo apt-get install software-properties-commonsudo add-apt-repository ppa:ondrej/php 4.å®‰è£…php7.0 123456sudo apt-get update sudo apt-get install php7.0sudo apt-get install php7.0-mysqlsudo apt-get install php7.0-fpmsudo apt-get install php7.0-curl php7.0-xml php7.0-mcrypt php7.0-json php7.0-gd php7.0-mbstring ä¸Šé¢å¯ä»¥ä¸€æ­¥ä¸€æ­¥æ¥å®‰è£…ï¼Œå¦‚æœå‡ºç°ä¾èµ–å†²çªçš„æƒ…å†µï¼Œè¯·ä¸€ä¸ªä¸€ä¸ªå®‰è£…ã€‚ 5.é…ç½®æ–°çš„php.ini 12sudo vim /etc/php/7.0/fpm/php.ini#å°†cgi.fix_pathinfo=1è¿™ä¸€è¡Œå»æ‰æ³¨é‡Šï¼Œå°†1æ”¹ä¸º0ã€‚ 6.é…ç½®php-fpm 12sudo vim /etc/php/7.0/fpm/pool.d/www.conf# é…ç½®è¿™ä¸ª listen = /var/run/php7.0-fpm.sock 7.nginx é…ç½® 1sudo vim /etc/nginx/sites-enabled/default é…ç½®ç›¸å¯¹åº”çš„è·¯å¾„å’Œ location,(ä»¥laravelé¡¹ç›®ä¸ºä¾‹)ï¼š 123456789101112131415161718192021222324listen 80 default_server;listen [::]:80 default_server ipv6only=on;root your_website_root;index index.php index.html index.htm;# Make site accessible from http://localhost/server_name your_domain;location / &#123; # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ /index.php?$query_string; # Uncomment to enable naxsi on this location # include /etc/nginx/naxsi.rules&#125;location ~ \\.php$ &#123; try_files $uri /index.php =404; fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_pass unix:/var/run/php7.0-fpm.sock; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params;&#125; æ³¨æ„è¿™é‡Œçš„ fastcgi_pass unix:/var/run/php7.0-fpm.sock; è¦å’Œç¬¬6æ­¥çš„ php-fpm é…ç½®ï¼š/var/run/php7.0-fpm.sock; ä¸€è‡´ã€‚ å¦‚æœä½¿ç”¨ https çš„è¯ï¼Œæ¨èï¼š 1234567ssl on;ssl_certificate /etc/nginx/ssl/ssl.crt;ssl_certificate_key /etc/nginx/ssl/ssl.key;ssl_protocols TLSv1 TLSv1.1 TLSv1.2;ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;ssl_prefer_server_ciphers on; å¼€å¯ gzip å¯å‚è€ƒï¼Œé…ç½®æ–‡ä»¶ä½äº nginx.confï¼š 1234567891011gzip on;gzip_disable &quot;msie6&quot;;gzip_vary on;gzip_proxied any;gzip_comp_level 5;gzip_min_length 256;gzip_buffers 16 8k;gzip_http_version 1.1;gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"php7","slug":"php7","permalink":"http://blog.nicexiangcun.com/tags/php7/"}]},{"title":"é˜¿é‡Œäº‘ç«™ç‚¹éƒ¨ç½²","slug":"laravel-webhook","date":"2016-10-13T03:53:34.000Z","updated":"2020-11-20T13:06:15.513Z","comments":true,"path":"2016/10/13/laravel-webhook/","link":"","permalink":"http://blog.nicexiangcun.com/2016/10/13/laravel-webhook/","excerpt":"ä»¥ Ubuntu 14.04 ä¸ºä¾‹\nÂ¶é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥åˆ é™¤Apache\n123sudo service apache2 stopupdate-rc.d -f apache2 removesudo apt-get remove apache2\nåˆ é™¤å®Œä¹‹åï¼Œæ›´æ–°ä¸€ä¸‹åŒ…åˆ—è¡¨\n1sudo apt-get update\nÂ¶å®‰è£…Nginx\n12# æ³¨æ„nginxå®‰è£…éœ€è¦ç¬¬ä¸‰æ–¹åº“çš„ä¾èµ–ï¼Œé€šå¸¸æœ‰ pcreåº“ï¼ˆæ”¯æŒrewriteæ¨¡å—ï¼‰zlibåº“ï¼ˆæ”¯æŒgzipæ¨¡å—ï¼‰å’Œopensslåº“ï¼ˆæ”¯æŒsslæ¨¡å—ï¼‰ sudo apt-get install nginx\nå®‰è£…å®ŒNginxï¼Œæ‰§è¡Œï½€sudo service nginx startï½€å†åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä½ çš„å…¬ç½‘IPï¼Œä½ å°±å¯ä»¥çœ‹çš„welcome to Nginxçš„ç•Œé¢äº†\nÂ¶å®‰è£…PHP\n1sudo apt-get install php5-fpm php5-cli php5-mcrypt\nåªæœ‰é€šè¿‡php5-fpmï¼ŒPHPåœ¨Nginxä¸‹æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œé‚ï¼Œå®‰è£…ä¹‹ã€‚\nè‡³äºphp5-mcryptï¼Œæœ‰äº›PHPæ¡†æ¶ä¼šä¾èµ–äºè¿™ä¸ªï¼Œæ¯”å¦‚Laravelå°±æ˜¯ï¼Œæ‰€ä»¥ä¹ŸæŠŠå®ƒè£…ä¸Šäº†ã€‚\nÂ¶é…ç½®php\n1sudo vim /etc/php5/fpm/php.ini\næ‰“å¼€PHPé…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°cgi.fix_pathinfoé€‰é¡¹ï¼Œå»æ‰å®ƒå‰é¢çš„æ³¨é‡Šåˆ†å·;ï¼Œç„¶åå°†å®ƒçš„å€¼è®¾ç½®ä¸º0,å¦‚ä¸‹ cgi.fix_pathinfo=0\nå¯ç”¨php5-mcrypt: sudo php5enmod mcrypt\né‡å¯php5-fpm: sudo service php5-fpm restart","text":"ä»¥ Ubuntu 14.04 ä¸ºä¾‹ Â¶é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥åˆ é™¤Apache 123sudo service apache2 stopupdate-rc.d -f apache2 removesudo apt-get remove apache2 åˆ é™¤å®Œä¹‹åï¼Œæ›´æ–°ä¸€ä¸‹åŒ…åˆ—è¡¨ 1sudo apt-get update Â¶å®‰è£…Nginx 12# æ³¨æ„nginxå®‰è£…éœ€è¦ç¬¬ä¸‰æ–¹åº“çš„ä¾èµ–ï¼Œé€šå¸¸æœ‰ pcreåº“ï¼ˆæ”¯æŒrewriteæ¨¡å—ï¼‰zlibåº“ï¼ˆæ”¯æŒgzipæ¨¡å—ï¼‰å’Œopensslåº“ï¼ˆæ”¯æŒsslæ¨¡å—ï¼‰ sudo apt-get install nginx å®‰è£…å®ŒNginxï¼Œæ‰§è¡Œï½€sudo service nginx startï½€å†åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä½ çš„å…¬ç½‘IPï¼Œä½ å°±å¯ä»¥çœ‹çš„welcome to Nginxçš„ç•Œé¢äº† Â¶å®‰è£…PHP 1sudo apt-get install php5-fpm php5-cli php5-mcrypt åªæœ‰é€šè¿‡php5-fpmï¼ŒPHPåœ¨Nginxä¸‹æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œé‚ï¼Œå®‰è£…ä¹‹ã€‚ è‡³äºphp5-mcryptï¼Œæœ‰äº›PHPæ¡†æ¶ä¼šä¾èµ–äºè¿™ä¸ªï¼Œæ¯”å¦‚Laravelå°±æ˜¯ï¼Œæ‰€ä»¥ä¹ŸæŠŠå®ƒè£…ä¸Šäº†ã€‚ Â¶é…ç½®php 1sudo vim /etc/php5/fpm/php.ini æ‰“å¼€PHPé…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°cgi.fix_pathinfoé€‰é¡¹ï¼Œå»æ‰å®ƒå‰é¢çš„æ³¨é‡Šåˆ†å·;ï¼Œç„¶åå°†å®ƒçš„å€¼è®¾ç½®ä¸º0,å¦‚ä¸‹ cgi.fix_pathinfo=0 å¯ç”¨php5-mcrypt: sudo php5enmod mcrypt é‡å¯php5-fpm: sudo service php5-fpm restart Â¶åœ¨æ­å»ºå®ŒLEMPç¯å¢ƒä¹‹åï¼Œé¦–å…ˆè¦æ˜ç¡®ä¸¤ä¸ªé‡è¦ç›®å½• Nginxçš„é»˜è®¤rootæ–‡ä»¶å¤¹ /usr/share/nginx/html Nginxçš„æœåŠ¡å™¨é…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½• /etc/nginx/sites-available/ Â¶éƒ¨ç½²Laravel åˆ›å»ºç½‘ç«™çš„æ ¹ç›®å½• sudo mkdir -p /var/www é…ç½®nginxæœåŠ¡å™¨ sudo vim /etc/nginx/sites-available/default æ‰“å¼€nginxçš„é…ç½®æ–‡ä»¶ä¹‹åï¼Œæ‰¾åˆ°serverè¿™ä¸€å—ï¼Œå¤§æ¦‚æ˜¯é•¿è¿™ä¸ªæ ·å­çš„ 12345678910111213server &#123; listen 80 default_server; listen [::]:80 default_server ipv6only=on; root /usr/share/nginx/html; index index.html index.htm; server_name localhost; location / &#123; try_files $uri $uri/ =404; &#125;&#125; å…¶ä¸­rootï¼Œindex ï¼Œserver_nameå’Œlocationè¿™å‡ è¡Œéœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ 1234567891011121314server &#123; listen 80 default_server; listen [::]:80 default_server ipv6only=on; root /var/www/laravel/public; index index.php index.html index.htm; server_name server_domain_or_IP; # å°†server_domain_or_IPä¿®æ”¹ä¸ºä½ çš„å…¬ç½‘IP location / &#123; try_files $uri $uri/ /index.php?$query_string; &#125;&#125; æœ€åæˆ‘ä»¬è¿˜éœ€è¦é…ç½®ä¸€ä¸‹Nginxï¼Œè®©å…¶æ‰§è¡ŒPHPæ–‡ä»¶ã€‚åŒæ ·æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œåœ¨locationä¸‹æ–¹æ·»åŠ ä¸‹é¢çš„é…ç½®ï¼š 12345678910111213141516171819202122server &#123; listen 80 default_server; listen [::]:80 default_server ipv6only=on; root /var/www/laravel/public; index index.php index.html index.htm; server_name server_domain_or_IP; location / &#123; try_files $uri $uri/ /index.php?$query_string; &#125; location ~ \\.php$ &#123; try_files $uri /index.php =404; fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_pass unix:/var/run/php5-fpm.sock; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125;&#125; é…ç½®å®Œä¹‹åé‡å¯Nginxï¼Œä½¿ä¸Šé¢çš„é…ç½®é¡¹ç”Ÿæ•ˆã€‚ sudo service nginx restart Â¶åˆ›å»ºLaravelé¡¹ç›® ç¬¬ä¸€ç§æ–¹å¼ï¼š ç›´æ¥é€šè¿‡composeræ¥å®‰è£…,å®‰è£…composer 12cd ~curl -sS https://getcomposer.org/installer | php å¦‚æœ curl æœ‰å…³äºsslé”™è¯¯å¯ä»¥å°è¯•ä¸€ä¸‹æ–¹å¼ï¼š 12345wget https://getcomposer.org/installerand php installer; composerå…¨å±€ä½¿ç”¨ï¼š sudo mv composer.phar /usr/local/bin/composer æˆ–è€… sudo mv composer.phar /usr/bin/composer ç„¶ååœ¨/var/wwwç›®å½•ä¸‹ç›´æ¥æ‰§è¡Œ sudo composer create-project laravel/laravel laravel ç¬¬äºŒç§æ–¹å¼ï¼š ä½¿ç”¨Gitå’ŒCodingå¹³å° å®‰è£…git sudo apt-get install git å®‰è£…å®Œæˆå°±å¯ä»¥ä½¿ç”¨gitäº†ï¼Œç„¶ååœ¨Codingä¸Šåˆ›å»ºä¸€ä¸ªç§æœ‰é¡¹ç›®laravelï¼Œé‡Œé¢åŒ…å«æ‰€æœ‰è¯¥Laravelé¡¹ç›®æ‰€éœ€ä»£ç ã€‚ ä¸€æ—¦æœ¬åœ°ä»£ç éƒ½æ¨é€åˆ°Codingï¼Œç„¶ååœ¨/var/wwwç›®å½•ä¸‹ç›´æ¥ä½¿ç”¨ git clone your-project-git-link your-project-git-linkæ›¿æ¢ä¸ºä½ Codingä¸Šçš„laravelé¡¹ç›®åœ°å€ æ³¨æ„ï¼š ä¸ç®¡å“ªç§æ–¹å¼å®‰è£…çš„ä»£ç ï¼Œ/var/www/éƒ½æ˜¯å±äºrootç”¨æˆ·çš„ï¼Œè€Œè®¿é—®ç½‘ç«™çš„ç”¨æˆ·åˆ™éœ€è¦æ­£ç¡®çš„æƒé™å’Œè®¿é—®é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥å®ç°ã€‚ sudo chown -R :www-data /var/www/laravel æ ¹æ®Laravelçš„å®˜æ–¹æ–‡æ¡£ï¼Œ/var/www/laravel/storageç›®å½•éœ€è¦ç»™ç½‘ç«™çš„ç”¨æˆ·å†™æƒé™ sudo chmod -R 775 /var/www/laravel/storage åŒæ—¶è¿˜è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œ 123php artisan cache:clear //åœ¨bootstrap/cache ç”Ÿæˆ services.php æ–‡ä»¶php artisan key:generate //å°†ç”Ÿæˆçš„keyå¤åˆ¶åˆ°config/app.phpæ›¿æ¢82è¡Œçš„APP_KEYé”®å€¼ã€‚ Â¶ssh ç™»å½•æœåŠ¡å™¨ ssh-keygen -t rsa æœ¬åœ°ç”Ÿæˆç§˜é’¥å¯¹ æ¥ä¸‹æ¥éœ€è¦å°†æœ¬åœ°çš„ id_rsa.pub æ‹·è´æœåŠ¡å™¨ä¸Šã€‚ sshç™»å½•æœåŠ¡å™¨åˆ›å»º .ssh ç›®å½• 12cd ~sudo mkdir .ssh åˆ‡å›åˆ°æœ¬åœ° .ssh ç›®å½• scp id_rsa.pub root@123.98.35.77:~/.ssh/id_rsa.pub è¾“å…¥æœåŠ¡å™¨å¯†ç æ‹·è´ æ‹·è´æˆåŠŸå›åˆ°æœåŠ¡å™¨ cat id_rsa.pub &gt;&gt; authorized_keys æœ€ååˆ æ‰ id_rsa.pub ,é€€å‡ºæœåŠ¡å™¨ï¼Œé‡æ–°ç™»å½•ï¼Œå°±ä¸ç”¨è¾“å…¥å¯†ç äº†ã€‚ Â¶åˆ©ç”¨webhook å®ç°PHP è‡ªåŠ¨éƒ¨ç½² git ä»£ç  é¦–å…ˆæ¨èä¸¤ç¯‡æ–‡ç«  http://m.aoh.cc/149.html http://overtrue.me/articles/2015/01/how-to-deploy-project-with-git-hook.html ç™»å½•æœåŠ¡å™¨éƒ¨ç½²ç”¨æˆ·å…¬é’¥ ssh-keygen -t rsa -C &quot;bjletaoba@sina.com&quot; å°†ç”¨æˆ·å…¬é’¥éƒ¨ç½²åˆ°codding çš„ç”¨æˆ·è®¾ç½®ä¸­ åˆ›å»ºç›®å½• sudo mkdir /var/www/.ssh ä¿®æ”¹æ‰€å±ä¸» (é’ˆå¯¹ nginx çš„) sudo chown -R www-data:www-data /var/www/.ssh/ éƒ¨ç½²é¡¹ç›®å…¬é’¥ (é’ˆå¯¹ nginx,æ³¨æ„ id_rsa çš„æƒé™å¿…é¡»ä¸èƒ½ä¸Š777 æˆ–è€… 755 ï¼Œå¯ä»¥ä¸Š700) sudo -Hu www-data ssh-keygen -t rsa //æ³¨æ„æ‰€åœ¨çš„å½“å‰ç›®å½•å¿…é¡»åœ¨ wwwä¸‹ éƒ¨ç½²åˆ° codding çš„é¡¹ç›®ä¸­ sudo cat /var/www/.ssh/id_rsa.pub å‡†å¤‡éƒ¨ç½²ä»£ç å’Œæ³¨å†Œè·¯ç”± è·¯ç”±è¦æ³¨å†Œåˆ° middleware å¤–é¢ 123456Route::group([&#x27;middleware&#x27;=&gt;[&#x27;web&#x27;]],function()&#123;&#125;)Route::any(&#x27;/deploy&#x27;,&#x27;DeployController@deploy&#x27;); 123456789101112131415161718public function deploy(Request $request)&#123; $token = &#x27;ffanfood&#x27;; $target = &#x27;/var/www/ffanfood/aliyun&#x27;; // ç”Ÿäº§ç¯å¢ƒwebç›®å½• $wwwUser = &#x27;www-data&#x27;; $wwwGroup = &#x27;www-data&#x27;; $json = json_decode(file_get_contents(&#x27;php://input&#x27;),true); if(empty($json[&#x27;token&#x27;]) || $json[&#x27;token&#x27;] !== $token)&#123; exit(&#x27;error_request&#x27;); &#125; file_put_contents(&#x27;deploy.log&#x27;,var_export($json,true),FILE_APPEND); $cmds = array( &quot;cd $target &amp;&amp; git pull&quot;, &quot;chown -R &#123;$wwwUser&#125;:&#123;$wwwGroup&#125; $target/&quot;, ); foreach ($cmds as $cmd) &#123; shell_exec($cmd); &#125;&#125; ä»¥ä¸Šä»£ç å¯ä»¥ä½¿ç”¨ php-shell-wrapper è¿™ä¸ª åŒ… https://github.com/adambrett/php-shell-wrapper 1234567891011/** * æ‰§è¡Œcd å‘½ä»¤ * @param $paht * @return $this */ protected function cdInfo($paht)&#123; $command = new Command(&#x27;cd&#x27;); $command-&gt;addParam(new Param($paht)); $this-&gt;shell-&gt;run($command); return $this; &#125; ä¿®æ”¹gité…ç½®å’Œä¿å­˜gitç”¨æˆ·åå¯†ç  (ä¼šåœ¨ ï¼var/www ä¸‹ç”Ÿæˆgit é…ç½®æ–‡ä»¶) 123sudo -Hu www git config --global credential.helper store # æ°¸ä¹…ä¿å­˜sudo -Hu www-data git config --global user.name lhwsudo -Hu www-data git config --global user.email bjletaoba@sina.com åˆå§‹åŒ– (æ³¨æ„è¦ç”¨ssh çš„é“¾æ¥ è¿™æ ·å°±ä¸ç”¨è¾“å…¥å¯†ç ) sudo -Hu www-data git clone git@git.coding.net:goodawei/aliyun_laravel_5_2.git --depth=1","raw":null,"content":null,"categories":[{"name":"webserver","slug":"webserver","permalink":"http://blog.nicexiangcun.com/categories/webserver/"}],"tags":[{"name":"webhook","slug":"webhook","permalink":"http://blog.nicexiangcun.com/tags/webhook/"}]},{"title":"git","slug":"git","date":"2016-07-09T13:20:05.000Z","updated":"2020-11-20T13:06:15.512Z","comments":true,"path":"2016/07/09/git/","link":"","permalink":"http://blog.nicexiangcun.com/2016/07/09/git/","excerpt":"git çš„é…ç½®é¡¹  git config ä»¥ä¸‹çš„ä¸‰ä¸ªçº§åˆ«\nÂ¶global\né’ˆå¯¹ä¸€å°ç”µè„‘ä¸­ä¸€ä¸ªç”¨æˆ·ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ä¸­ç”¨æˆ·çš„åŠ ç›®å½•çš„ .gitconfig ä¸­\n1234567891011git config --é…ç½®çº§åˆ«  é€‰é¡¹.å±æ€§ å€¼ å¦‚ï¼šgit config --global color.ui true\t\t\t\t\tï¼ƒé…ç½®uié¢œè‰²git config --global user.name lhw                   ï¼ƒæŒ‡å®šæäº¤çš„ç”¨æˆ·ågit config --global user.email bjletaoba@sina.com   ï¼ƒæŒ‡å®šæäº¤çš„ç”¨æˆ·é‚®ç®±git config --global core.editor emacs  (vim)        ï¼ƒæŒ‡å®šæ‰“å¼€çš„ç¼–è¾‘å™¨git config --global merge.tool vimdiff              ï¼ƒæŒ‡å®šæ¯”è¾ƒå·¥å…·git config --list                                   ï¼ƒæŸ¥çœ‹é…ç½®é¡¹git help config                                     ï¼ƒå¸®åŠ©\nÂ¶system\né’ˆå¯¹ä¸€å°ç”µè„‘ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ä¸­/etc/.gitconfig ä¸‹\nÂ¶local\né’ˆå¯¹æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ä¸­ æ¯ä¸ªé¡¹ç›®çš„ .git/æ–‡ä»¶å¤¹ä¸‹\nå¸¸ç”¨æŸ¥çœ‹å‘½ä»¤\ngit status\ngit log --oneline\ngit log --oneline --graph\ngit  show  hashå€¼ æŸ¥çœ‹çŠ¶æ€å’Œè·Ÿè¸ªæ—¥å¿—å’Œhash\nÂ¶git add ç”¨æ³•\ngit add å°†æ–‡ä»¶æ”¾å…¥ç¼“å­˜åŒºï¼Œå…¶ç›®çš„æ˜¯ä¸ºä¸‹æ¬¡çš„ commit åšå‡†å¤‡ï¼Œå…¶å®æ¯æ¬¡ git commit æäº¤çš„æ–‡ä»¶éƒ½æ˜¯ ç¼“å­˜åŒºçš„ï¼Œå¦‚æœåœ¨ç¼“å­˜åŒºçš„æ–‡ä»¶commitä¹‹å‰åœ¨æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆä¿®æ”¹çš„éƒ¨åˆ†ä¸ä¼šcommitåˆ°ç‰ˆæœ¬æ§åˆ¶ä¸­\n12345git add . \t\t#æ·»åŠ æ‰€æœ‰æ–‡ä»¶git add *.php \t# æ·»åŠ PHPæ–‡ä»¶git add /dir/* \t#æ·»åŠ ç›®å½•","text":"git çš„é…ç½®é¡¹ git config ä»¥ä¸‹çš„ä¸‰ä¸ªçº§åˆ« Â¶global é’ˆå¯¹ä¸€å°ç”µè„‘ä¸­ä¸€ä¸ªç”¨æˆ·ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ä¸­ç”¨æˆ·çš„åŠ ç›®å½•çš„ .gitconfig ä¸­ 1234567891011git config --é…ç½®çº§åˆ« é€‰é¡¹.å±æ€§ å€¼ å¦‚ï¼šgit config --global color.ui true ï¼ƒé…ç½®uié¢œè‰²git config --global user.name lhw ï¼ƒæŒ‡å®šæäº¤çš„ç”¨æˆ·ågit config --global user.email bjletaoba@sina.com ï¼ƒæŒ‡å®šæäº¤çš„ç”¨æˆ·é‚®ç®±git config --global core.editor emacs (vim) ï¼ƒæŒ‡å®šæ‰“å¼€çš„ç¼–è¾‘å™¨git config --global merge.tool vimdiff ï¼ƒæŒ‡å®šæ¯”è¾ƒå·¥å…·git config --list ï¼ƒæŸ¥çœ‹é…ç½®é¡¹git help config ï¼ƒå¸®åŠ© Â¶system é’ˆå¯¹ä¸€å°ç”µè„‘ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ä¸­/etc/.gitconfig ä¸‹ Â¶local é’ˆå¯¹æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ä¸­ æ¯ä¸ªé¡¹ç›®çš„ .git/æ–‡ä»¶å¤¹ä¸‹ å¸¸ç”¨æŸ¥çœ‹å‘½ä»¤ git status git log --oneline git log --oneline --graph git show hashå€¼ æŸ¥çœ‹çŠ¶æ€å’Œè·Ÿè¸ªæ—¥å¿—å’Œhash Â¶git add ç”¨æ³• git add å°†æ–‡ä»¶æ”¾å…¥ç¼“å­˜åŒºï¼Œå…¶ç›®çš„æ˜¯ä¸ºä¸‹æ¬¡çš„ commit åšå‡†å¤‡ï¼Œå…¶å®æ¯æ¬¡ git commit æäº¤çš„æ–‡ä»¶éƒ½æ˜¯ ç¼“å­˜åŒºçš„ï¼Œå¦‚æœåœ¨ç¼“å­˜åŒºçš„æ–‡ä»¶commitä¹‹å‰åœ¨æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆä¿®æ”¹çš„éƒ¨åˆ†ä¸ä¼šcommitåˆ°ç‰ˆæœ¬æ§åˆ¶ä¸­ 12345git add . #æ·»åŠ æ‰€æœ‰æ–‡ä»¶git add *.php # æ·»åŠ PHPæ–‡ä»¶git add /dir/* #æ·»åŠ ç›®å½• git ä½¿ç”¨æ€»ç»“ Â¶å¦‚ä½•ä½¿commitå°½å¯èƒ½çš„å°‘ åœºæ™¯ï¼šé€šå¸¸ä¸€ä¸ªcommitå°±ä»£è¡¨ä¸€ä¸ªç‰ˆæœ¬æˆ–è€…ä¸€ä¸ªåŠŸèƒ½çš„æäº¤ï¼Œæ‰€ä»¥æœ‰æ—¶å€™æˆ‘ä»¬ä¸å¸Œæœ›æœ‰è¿‡å¤šçš„commitï¼Œæ¯”å¦‚å·²ç»commitåˆ°æœ¬åœ°çš„lhw.php æ–‡ä»¶ï¼Œå½“æˆ‘å†æ¬¡ä¿®æ”¹å®ƒçš„æ—¶å€™ï¼Œæˆ‘ä¸å¸Œæœ›è¿™æ¬¡çš„commit çºªå½•è¿›logï¼Œè¿™æ—¶å¯ç”¨ä½¿ç”¨amendï¼šgit commit --amend(ä¼šåœ¨æŒ‡å®šçš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€ï¼Œå…³é—­åè‡ªåŠ¨æäº¤),æ³¨æ„åªé™äºæäº¤åˆ°æœ¬åœ°å¹¶æœªæ¨é€åˆ°è¿œç«¯ï¼Œå¦‚æœå·²ç»æ¨é€åˆ°è¿œç«¯æš‚æ—¶æ²¡ç”¨æƒ³åˆ°åŠæ³•ã€‚å¦å¤–amendåªé€‚ç”¨äºä¿®æ­£æœ€åä¸€æ¬¡commitå¦‚æœé€‰æ‹©ä¹‹å‰çš„æŸä¸ªç‰ˆæœ¬ï¼Œåªèƒ½git reset --hardå›åˆ°æŸä¸ªå†å²ç‰ˆæœ¬ååœ¨åšamendã€‚ æŸ¥çœ‹ä¿®æ”¹å¯ç”¨ä½¿ç”¨ï¼š git show æŒ‡å®šhashå€¼ ï¼Œè€Œæ­¤å¤„ git commit ä¸ä¼šäº§ç”Ÿæ–°çš„log (å…·ä½“æƒ³è¦å‡ ä¸ªcommitè¿˜è¦æ ¹æ®å…·ä½“çš„åœºæ™¯) Â¶è¿½éšå›å½’åˆ°è¿‡å»çš„æŸä¸€ä¸ªç‰ˆæœ¬ git reset --hard å½»åº•å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œæœ¬åœ°çš„æºç ä¹Ÿä¼šå˜ä¸ºä¸Šä¸€ä¸ªç‰ˆæœ¬çš„å†…å®¹ã€‚ git reset --soft å›æ»šä¸€ä¸ªcommitçŠ¶æ€ã€‚èƒ½å›åˆ°addä¹‹åé‚£é‡Œ,å›é€€çš„æ˜¯commitçš„ä¿¡æ¯ï¼Œä¸ä¼šå›é€€ä»£ç ã€‚å¦‚æœè¿˜è¦æäº¤ï¼Œç›´æ¥commitå³å¯ Â¶gitignore å¿½ç•¥ç‰ˆæœ¬æ§åˆ¶ ä¸€ä¸ªç®€å•çš„ä¾‹å­å¿½ç•¥ç¼–è¾‘å™¨ç”Ÿæˆçš„ .ideaæ–‡ä»¶ git rm -r --cached .idea/ ï¼ƒæŒ‡ç›®å½•ï¼Œä»ç¼“å­˜åŒºä¸­åˆ é™¤ä¸­æ·»åŠ  ç„¶ååœ¨ gitignore é…ç½®ä¸­æ·»åŠ  .idea ,åœ¨æäº¤ã€‚ Â¶rebase å˜åŸº ç”±äºåˆ†æ”¯ä¸Šçš„commitåˆå¹¶åˆ°masterçš„æ—¶å€™ä¼šäº§ç”Ÿæ–°çš„commit,è€Œrebaseå¯ä»¥å°†åˆ†æ”¯ä¸Šæäº¤æ•´åˆåˆ°masterä¸Šï¼Œæ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š git checkout feacture åˆ‡æ¢åˆ°å‘å¸ƒåˆ†æ”¯ git rebase master å·²masterä¸ºåŸºç¡€ git checkout master åˆ‡å›ä¸»å¹² git merge feacture åˆå¹¶å‘å¸ƒåˆ†æ”¯ Â¶cherry-pick æŒ‘æ‹£commit åœºæ™¯ï¼šå‡è®¾æˆ‘ä»¬æœ‰ä¸ªç¨³å®šç‰ˆæœ¬çš„åˆ†æ”¯ï¼Œå«v2.0ï¼Œå¦å¤–è¿˜æœ‰ä¸ªå¼€å‘ç‰ˆæœ¬çš„åˆ†æ”¯v3.0ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥æŠŠä¸¤ä¸ªåˆ†æ”¯åˆå¹¶ï¼Œè¿™æ ·ä¼šå¯¼è‡´ç¨³å®šç‰ˆæœ¬æ··ä¹±ï¼Œä½†æ˜¯åˆæƒ³å¢åŠ ä¸€ä¸ªv3.0ä¸­çš„åŠŸèƒ½åˆ°v2.0ä¸­ï¼Œè¿™é‡Œå°±å¯ä»¥ä½¿ç”¨cherry-pickäº†ã€‚ å¦‚æŠŠdevåˆ†æ”¯ä¸Šçš„æŸäº›commitåˆå¹¶åˆ°releaseä¸Š git checkout dev å½“å‰çš„å¼€å‘åˆ†æ”¯ä¸Š git checkout 0628fadz ä»å½“å‰å¼€å‘åˆ†æ”¯çš„0628fadzè¿™ä¸ªç‚¹å¼€å§‹æ£€å‡ºä»£ç  git branch test ä¸ºæ£€å‡ºçš„ä»£ç åˆ›å»ºteståˆ†æ”¯ git checkout test åˆ‡æ¢teståˆ†æ”¯ git checkout release åˆ‡æ¢åˆ°è¦åˆåˆ°çš„åˆ†æ”¯ä¸Š git cherry-pick 014de66 4dd1669 b6493af 803d021 å°†è¦åˆå¹¶çš„commitæŒ‰å…ˆåé¡ºåºåˆå¹¶è¿‡æ¥ git check-pick --abord å¦‚æœé‡åˆ°å†²çªå¯ä»¥å–æ¶ˆæ“ä½œå¹¶è¿”å›åˆ°é¢„åºåˆ—çŠ¶æ€ git status git check-pick --abord å¯ä»¥è¿ç»­ä½¿ç”¨ git push -u origin test git checekout release git merge test git pull git push å…·ä½“ä½¿ç”¨å‚ç…§ ï¼š https://git-scm.com/docs/git-cherry-pick åˆ†æ”¯ åˆ†æ”¯çš„ä½¿ç”¨åœºæ™¯ï¼š åˆ†æ”¯ä½¿ç”¨åœºæ™¯ä¸ªäººç†è§£ä¹Ÿå°±æ˜¯gitçš„å¼€å‘è§„èŒƒï¼Œgitå¼€å‘è§„èŒƒæœ‰å¾ˆå¤šï¼Œå¦‚gitflow,æ„Ÿè§‰gitflowç¡®å®è§£å†³äº†è®¸å¤šé—®é¢˜ï¼Œä½†åŒæ—¶åˆå¸¦å‡ºæ¥äº†è®¸å¤šæ–°çš„é—®é¢˜ï¼Œå¦‚åˆ†æ”¯çš„æœ€ç»ˆç®¡ç†æœ€ç»ˆçœ‹èµ·æ¥å¾ˆä¹±ã€‚ ç®€å•çš„ä¸€å¥—gitåˆ†æ”¯è§„èŒƒï¼šmaster(å—ä¿æŠ¤çš„) ï¼Œdev(å¼€å‘åˆ†æ”¯)ï¼Œfeacture(æ¬²å‘å¸ƒ)ï¼Œå¼€å‘äººå‘˜æ‹‰å–devåˆ†æ”¯åœ¨æœ¬åœ°å°æ­¥æäº¤ï¼Œå¼€å‘å®Œæˆåˆå¹¶åˆ°feactureï¼Œåœ¨ç”±feactureåˆå¹¶åˆ°master å¤§èŒƒå›´çš„bug,å¯ä»¥åˆ›å»ºä¸€ä¸ªbugåˆ†æ”¯. æ–°å»ºåˆ†æ”¯ï¼š git branch -b lhwtest_1000 åˆ‡æ¢åˆ†æ”¯ï¼š git checkout -b lhwtest_1000 æŸ¥çœ‹åˆ†æ”¯ï¼š git branch æäº¤åˆ°åˆ†æ”¯ï¼š git commit -m 'new touch file' æ¨é€åˆ°æŒ‡å®š master åˆ†æ”¯: git push origin lhwtest_1000 åˆ‡æ¢åˆ°ä¸»å¹²ï¼š git checkout master åˆå¹¶åˆ†æ”¯ï¼š git merge origin lhwtest_1000 æœ€åæ¨é€åˆ°master: git push origin å•ç‹¬revestæŸä¸ªæ–‡ä»¶ ï¼š git checkout -- /app/lhw.php åˆ†æ”¯å¼€å‘å®Œæˆæ²¡æœ‰bugååˆ é™¤åˆ†æ”¯ï¼š git branch -d lhwtest_1000 æ³¨æ„åˆ†æ”¯å¼€å‘è¿‡ç¨‹ä¸­è¦ä¸æ–­çš„è·å–ä¸»å¹²ä»£ç ï¼Œä¿æŒæœ¬åœ°ä¸ä¸»å¹²çš„ä»£ç åŒæ­¥, è·å–æœ€æ–°çš„è¿œç«¯ä»£ç (å¦åˆ™æ— æ³•æ¨é€åˆ°è¿œç«¯)ï¼Œå·²ä¿è¯è¿œç«¯ä»£ç å’Œæœ¬åœ°æ˜¯å¦å­˜åœ¨å†²çª git fetch origin git pull origin pull äº fetch çš„åŒºåˆ«ï¼š pull = fetch + merge , git fetch çš„æ—¶å€™ä¼šä»è¿œç«¯æ‹‰å–ä¸€ä¸ªéšè—masteråˆ†æ”¯,ä½¿ç”¨git branch -r æŸ¥çœ‹ï¼Œè¿™ä¸ªåˆ†æ”¯ä¼šä¸æœ¬åœ°åˆ†æ”¯è¿›è¡Œdiff,ç„¶åå†³å®šæ˜¯å¦éœ€è¦åˆå¹¶ï¼Œè€Œ git pull åˆ™ç›´æ¥è¿›è¡Œåˆå¹¶ é€šå¸¸éƒ½è¯´ git fetch æ›´åŠ å®‰å…¨ï¼Œä½†æ˜¯å®é™…å·¥ä½œä¸­éƒ½é»˜è®¤ä½¿ç”¨ git pull å› ä¸ºæˆ‘ä»¬é»˜è®¤å°±æ˜¯è¦å·²è¿œç«¯ä»£ç ä¸ºå‡†ã€‚ å†²çªè§£å†³ å†²çªåœºæ™¯ï¼šå½“åœ¨åˆ†æ”¯å’Œä¸»å¹²ä¿®æ”¹å¹¶æäº¤äº†ç›¸åŒæ–‡ä»¶çš„ç›¸åŒä½ç½®ï¼Œåœ¨ä¸ä¸»å¹²åˆå¹¶æ—¶gitä¼šæç¤ºmerge failed fix conficts and then commit the result,æ­¤æ—¶å¯ä»¥é€šè¿‡ git diff fileæŸ¥çœ‹æ–‡ä»¶å†²çªä¿¡æ¯ï¼Œå¹¶ä¸”ç”¨ç¼–è¾‘å™¨æ‰“å¼€æ–‡ä»¶ä¿®æ”¹å†²çªä¿¡æ¯ï¼Œä¿å­˜é€€å‡ºï¼Œé‡æ–° git addå’Œ git commit git å‘½ä»¤åˆ«å ä¸€ git æœ¬èº«çš„é…ç½®æ–‡ä»¶ æ·»åŠ ï¼šgit config --global alias.s status åˆ é™¤ï¼šgit config --global --unset alias.s äºŒ linux bash shell çš„ .bash_profile æˆ–è€… zshçš„ .zshrc 123456789101112alias ll=&#x27;ls -al&#x27;alias subl=&quot;&#x27;/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl&#x27;&quot;alias nano=&quot;subl&quot;alias des=&quot;cd ~/WebServer/Documents/&quot;alias gs=&quot;git status&quot;alias gc=&quot;git commit -m &quot;alias gaa=&quot;git add .&quot;alias gp=&quot;git push&quot;alias gl=&quot;git log --graph&quot;alias he=&quot;cd ~/hexo/hexo/lhw-hexo/&quot;alias pos=&quot;cd ~/hexo/hexo/lhw-hexo/source/_posts/&quot;export EDITOR=&quot;subl&quot; github å¸¸ç”¨æŠ€å·§ å¿«æ·é”® ï¼š shift + ? æŸ¥çœ‹ä¸€äº›æµè¡Œçš„packgecg : https://github.com/trending pullä»£ç çš„æ—¶å€™ï¼Œç»å¸¸ä¼šå’Œæœ¬åœ°æœ‰åˆå¹¶æƒ…å†µï¼Œä¸€ä½†åˆå¹¶ä¾¿ä¼šäº§ç”Ÿæ–°çš„åˆ†æ”¯ï¼Œä½¿åˆ†æ”¯çº¿æ¯”è¾ƒå‡Œä¹±ï¼Œè§£å†³åŠæ³•ï¼š å‘½ä»¤è¡Œï¼šgit pull --rebase phpstorm é€‰æ‹©rebase sourcetree å‹¾é€‰å¯…ç”Ÿé€‰é¡¹ ç†è§£ä¸€äº›æ„Ÿå¿µ ä¸€ä¸ªæœ¬åœ°ä»“åº“å¯ä»¥å¯¹åº”å¤šä¸ªè¿œç¨‹ä»“åº“ï¼Œcloneä¸‹æ¥çš„ä»“åº“é»˜è®¤æ˜¯ä¸è¿œç«¯originå»ºç«‹å…³è”çš„,æ‰€ä»¥pushçš„æ—¶å€™æ˜¯å¯ä»¥ç›´æ¥pushçš„ï¼Œ ä½¿ç”¨ remote add æŒ‡å‘æ–°çš„è¿œç¨‹ä»“åº“ã€‚å…·ä½“å­¦ä¹ githubflowçš„æµç¨‹ï¼Œæ‰€ä»¥åœ¨pushä¸€ä¸ªæ²¡ç”¨å’Œè¿œç«¯å»ºç«‹å…³è”çš„æœ¬åœ°ä»“åº“æ—¶é€šå¸¸æ˜¯è¦ push -u æŒ‡å®šè¿œç¨‹ä»“åº“åç§°çš„ã€‚","raw":null,"content":null,"categories":[{"name":"git","slug":"git","permalink":"http://blog.nicexiangcun.com/categories/git/"}],"tags":[{"name":"git","slug":"git","permalink":"http://blog.nicexiangcun.com/tags/git/"}]},{"title":"å¸¸ç”¨sqlæ€»ç»“","slug":"sql","date":"2016-06-28T14:18:35.000Z","updated":"2020-11-20T13:06:15.518Z","comments":true,"path":"2016/06/28/sql/","link":"","permalink":"http://blog.nicexiangcun.com/2016/06/28/sql/","excerpt":"Â¶ğŸ†” sqlæŸ¥è¯¢å‰nå¤©çš„æ—¥æœŸ n&gt;=1\n12345678910111213141516select UNIX_TIMESTAMP(date_sub(curdate(),interval 1 day) ) ;+-----------------------------------------------------+| UNIX_TIMESTAMP(date_sub(curdate(),interval 1 day) ) |+-----------------------------------------------------+|                                          1466956800 |-----------------------------------------------------+select date_sub(curdate(),interval 1 day) ;+------------------------------------+| date_sub(curdate(),interval 1 day) |+------------------------------------+| 2016-06-27                         |+------------------------------------+\nÂ¶æŸ¥å½“å¤©æ—¥æœŸå’Œæ—¶é—´\n123456789101112131415select CURDATE();+------------+| CURDATE()  |+------------+| 2016-06-28 |+------------+select NOW();+---------------------+| NOW()               |+---------------------+| 2016-06-28 22:29:48 |+---------------------+","text":"Â¶ğŸ†” sqlæŸ¥è¯¢å‰nå¤©çš„æ—¥æœŸ n&gt;=1 12345678910111213141516select UNIX_TIMESTAMP(date_sub(curdate(),interval 1 day) ) ;+-----------------------------------------------------+| UNIX_TIMESTAMP(date_sub(curdate(),interval 1 day) ) |+-----------------------------------------------------+| 1466956800 |-----------------------------------------------------+select date_sub(curdate(),interval 1 day) ;+------------------------------------+| date_sub(curdate(),interval 1 day) |+------------------------------------+| 2016-06-27 |+------------------------------------+ Â¶æŸ¥å½“å¤©æ—¥æœŸå’Œæ—¶é—´ 123456789101112131415select CURDATE();+------------+| CURDATE() |+------------+| 2016-06-28 |+------------+select NOW();+---------------------+| NOW() |+---------------------+| 2016-06-28 22:29:48 |+---------------------+ Â¶æŒ‰æœˆæˆ–æŒ‰å¹´ 12345678910111213141516select YEAR(NOW());+-------------+| YEAR(NOW()) |+-------------+| 2016 |+-------------+select MONTH(NOW());+--------------+| MONTH(NOW()) |+--------------+| 7 |+--------------+ Â¶ä¸€ç§ä¸æ˜ç™½çš„sql insert è¯­å¥ 12345678910111213$sql=&quot;INSERT INTO fee&quot; . &quot;(`create_time`, `create_uid`, `update_time`, `update_uid` &quot; . &quot;SELECT &quot; . &quot;2016-06-28&quot; . &quot;,10&quot; . &quot;,2016-06-28&quot; . &quot;,10&quot; . &quot;FROM DUAL &quot; . &quot;WHERE NOT EXISTS(SELECT * fee WHERE type=2 &quot; . &quot;and id=1 &quot; $pdo-&gt;query($sql);","raw":null,"content":null,"categories":[{"name":"mysql","slug":"mysql","permalink":"http://blog.nicexiangcun.com/categories/mysql/"}],"tags":[{"name":"sql","slug":"sql","permalink":"http://blog.nicexiangcun.com/tags/sql/"}]},{"title":"phpç›¸å…³æ–°ç‰¹æ€§","slug":"php-new-performance","date":"2016-06-25T13:52:10.000Z","updated":"2020-11-20T13:06:15.515Z","comments":true,"path":"2016/06/25/php-new-performance/","link":"","permalink":"http://blog.nicexiangcun.com/2016/06/25/php-new-performance/","excerpt":"æ•°ç»„ç›¸å…³\nÂ¶ä¸å®šé•¿å‚æ•°çš„ä¸€ç§ä¼ é€’æ–¹å¼ php5.6ä»¥ä¸Š\n123456789101112function add(...$args)&#123;\tvar_dump($args)&#125;\t //è¿™é‡Œä¼ å…¥çš„å‚æ•°ä¸ªæ•°æ˜¯å¯ä»¥æ”¹å˜çš„add(1, 2, 3, 4);\t //ä¹Ÿå¯ä»¥ä¼ å…¥æ•°ç»„ï¼Œ...ä¼šå±•å¼€æ•°ç»„ä¸ºå¤šä¸ªå‚æ•°$args = [1, 2, 3, 4];add(...$args);\nä»¥å¾€å®ç°æ–¹å¼ï¼š\n1234567function()&#123;\t$args = func_get_args();\t$nums = func_num_args();&#125;","text":"æ•°ç»„ç›¸å…³ Â¶ä¸å®šé•¿å‚æ•°çš„ä¸€ç§ä¼ é€’æ–¹å¼ php5.6ä»¥ä¸Š 123456789101112function add(...$args)&#123; var_dump($args)&#125; //è¿™é‡Œä¼ å…¥çš„å‚æ•°ä¸ªæ•°æ˜¯å¯ä»¥æ”¹å˜çš„add(1, 2, 3, 4); //ä¹Ÿå¯ä»¥ä¼ å…¥æ•°ç»„ï¼Œ...ä¼šå±•å¼€æ•°ç»„ä¸ºå¤šä¸ªå‚æ•°$args = [1, 2, 3, 4];add(...$args); ä»¥å¾€å®ç°æ–¹å¼ï¼š 1234567function()&#123; $args = func_get_args(); $nums = func_num_args();&#125; Â¶å¤šç»´æ•°ç»„çš„ä¸€ç§å¾ªç¯æ–¹å¼ 12345678$array = [ [1, 2], [3, 4],];foreach ($array as list($a, $b)) &#123; echo &quot;A: $a; B: $b\\n&quot;;&#125; traitçš„ä½¿ç”¨ Â¶trait ä½¿ç”¨åœºæ™¯å’Œç›®çš„ trait ä½¿ç”¨ç›®çš„ ï¼š ä¸€ ä»£ç é‡ç”¨ äºŒ èºä¸é’‰ä½œç”¨ï¼Œåƒåˆ«äººçš„ä»£ç æˆ–è€…å·²å®Œæˆçš„ä»£ç  æ’å…¥æ–°çš„ä»£ç  yield çš„ä½¿ç”¨ 123456789101112131415161718//è¿­ä»£å™¨ï¼Œæ¯æ¬¡åªè¿”å›ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸ªå¤§æ•°ç»„ä¸€æ¬¡è¿”å›//ä¾‹å¦‚ä¸‹é¢çš„è¯»å–æ–‡ä»¶ï¼Œæ¯æ¬¡åªè¿”å›ä¸€è¡Œï¼Œè€Œä¸æ˜¯å°†æ•´ä¸ªæ–‡ä»¶éƒ½ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜//ä½¿ç”¨è¿­ä»£å™¨å¯ä»¥å¾ˆå¥½çš„èŠ‚çº¦å†…å­˜function getLines($file)&#123; $f = fopen($file, &#x27;r&#x27;); try &#123; while ($line = fgets($f)) &#123; yield $line; &#125; &#125; finally &#123; fclose($f); &#125;&#125;foreach (getLines(&quot;file.txt&quot;) as $n =&gt; $line) &#123; echo $line;&#125;","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/tags/php/"}]},{"title":"google-æ•…éšœè‡ªåŠ¨å‘ç°è‡ªåŠ¨æ¢å¤","slug":"google-devpos","date":"2016-06-07T14:13:00.000Z","updated":"2020-11-20T13:06:15.512Z","comments":true,"path":"2016/06/07/google-devpos/","link":"","permalink":"http://blog.nicexiangcun.com/2016/06/07/google-devpos/","excerpt":"","text":"service-level agreement å’Œ service-level objectives http://searchcio.techtarget.com/answer/Whats-the-difference-between-SLO-and-SLA åœ¨ä¿è¯ SLO é«˜å¯ç”¨çš„æ—¶å€™ ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§ å’Œ äº§å“äº¤ä»˜é€Ÿåº¦ã€‚ ï¼ˆSRE Googleè¿ç»´è§£å¯†ï¼‰ http://www.open-open.com/lib/view/open1479283593591.html æ™ºèƒ½ç›‘æ§çº§åˆ« å‘Šè­¦ å·¥å• æ—¥å¿— 24 å°æ—¶ æŠ€æœ¯æœåŠ¡ ï¼ã€‹ æŠ€æœ¯æœåŠ¡æ‰‹å†Œ","raw":null,"content":null,"categories":[],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://blog.nicexiangcun.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"phpStrom","slug":"phpStorm","date":"2016-06-04T15:10:45.000Z","updated":"2020-11-20T13:06:15.516Z","comments":true,"path":"2016/06/04/phpStorm/","link":"","permalink":"http://blog.nicexiangcun.com/2016/06/04/phpStorm/","excerpt":"Â¶idea\nhttp://idea.lanyus.com/\nÂ¶phpStrom å¸¸ç”¨å¿«æ·é”®ï¼š\nmacä¸‹\ncommand + ï¼Œæ‰“å¼€é…ç½®é¡¹\ncommand + shift + a åˆ—å‡ºæ‰€æœ‰é€šè¿‡ keymap å®šä¹‰å¿«æ·é”®\ncommand + 1 éšè—å’Œæ˜¾ç¤ºå·¦ä¾§å·¥å…·æ \ncommand + e æœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶\ncommand + shift + o æœç´¢æ–‡ä»¶å…¶å®ä¸ç”¨æ€»æ˜¯åœ¨å·¦ä¾§çš„å·¥å…·æ ä¸­æ‰¾ï¼Œä½¿ç”¨å¿«æ·é”®æ•ˆç‡æ›´é«˜\ncommand + shift + F å…¨å±€æœç´¢\ncommand + 7 æ˜¾ç¤ºç±»ä¸­çš„æ–¹æ³•ï¼Œå³é”®å¯ä»¥å°†æ˜¾ç¤ºåŒºåŸŸï¼Œç§»åŠ¨åˆ° å·¦ï¼Œä¸Š å³ ä¸åŒåŒºåŸŸ\ncommand + l è·³è½¬æŒ‡å®šçš„è¡Œæ•°\ncommand + x åˆ é™¤å½“å‰è¡Œ\ncommand + d å¤åˆ¶å½“å‰è¡Œ\ncommand + b è·Ÿè¸ªå˜é‡è‡³å£°æ˜å¤„\ncommand + option + l æ ¼å¼åŒ–ä»£ç \ncommand + w å…³é—­å½“å‰çª—å£\ncommand + option + / å¤šè¡Œæ³¨é‡Š\ncommand + 6   æŸ¥æ‰¾//@todoæ ‡ç­¾\nå¸¸ç”¨å·¥å…·æ¡çš„æ˜¾ç¤ºå’Œéšè—åœ¨viewä¸‹ç¼–è¾‘ã€‚ ä¸€äº›ä¸å¸¸ç”¨çš„å¯ä»¥éšè—æ‰ã€‚\nÂ¶å¤šç‚¹ç¼–è¾‘\né¼ æ ‡æ–¹å¼ï¼šæŒ‰ä½ option ï¼‹ é¼ æ ‡å·¦é”®é€‰ä¸­ç¼–è¾‘å†…å®¹\nå¿«æ·é”® ï¼šcontrol + g  å’Œ  command ï¼‹ control + g\nÂ¶æ›´æ”¹keymap é‡ç½®å¿«æ·é”®ï¼ˆæŒ‰å¿«æ·é”®æœç´¢ï¼‰\nÂ¶live templates\nÂ¶ä¸»é¢˜é…ç½®ï¼š\nå¸¸è§„é…ç½®æµç¨‹ command + ï¼Œå‘¼å‡ºé…ç½®é¡¹ æˆ–è€… preferences è¿›å…¥ font é€‰æ‹© schemeé…ç½®é¡¹ .","text":"Â¶idea http://idea.lanyus.com/ Â¶phpStrom å¸¸ç”¨å¿«æ·é”®ï¼š macä¸‹ command + ï¼Œæ‰“å¼€é…ç½®é¡¹ command + shift + a åˆ—å‡ºæ‰€æœ‰é€šè¿‡ keymap å®šä¹‰å¿«æ·é”® command + 1 éšè—å’Œæ˜¾ç¤ºå·¦ä¾§å·¥å…·æ  command + e æœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶ command + shift + o æœç´¢æ–‡ä»¶å…¶å®ä¸ç”¨æ€»æ˜¯åœ¨å·¦ä¾§çš„å·¥å…·æ ä¸­æ‰¾ï¼Œä½¿ç”¨å¿«æ·é”®æ•ˆç‡æ›´é«˜ command + shift + F å…¨å±€æœç´¢ command + 7 æ˜¾ç¤ºç±»ä¸­çš„æ–¹æ³•ï¼Œå³é”®å¯ä»¥å°†æ˜¾ç¤ºåŒºåŸŸï¼Œç§»åŠ¨åˆ° å·¦ï¼Œä¸Š å³ ä¸åŒåŒºåŸŸ command + l è·³è½¬æŒ‡å®šçš„è¡Œæ•° command + x åˆ é™¤å½“å‰è¡Œ command + d å¤åˆ¶å½“å‰è¡Œ command + b è·Ÿè¸ªå˜é‡è‡³å£°æ˜å¤„ command + option + l æ ¼å¼åŒ–ä»£ç  command + w å…³é—­å½“å‰çª—å£ command + option + / å¤šè¡Œæ³¨é‡Š command + 6 æŸ¥æ‰¾//@todoæ ‡ç­¾ å¸¸ç”¨å·¥å…·æ¡çš„æ˜¾ç¤ºå’Œéšè—åœ¨viewä¸‹ç¼–è¾‘ã€‚ ä¸€äº›ä¸å¸¸ç”¨çš„å¯ä»¥éšè—æ‰ã€‚ Â¶å¤šç‚¹ç¼–è¾‘ é¼ æ ‡æ–¹å¼ï¼šæŒ‰ä½ option ï¼‹ é¼ æ ‡å·¦é”®é€‰ä¸­ç¼–è¾‘å†…å®¹ å¿«æ·é”® ï¼šcontrol + g å’Œ command ï¼‹ control + g Â¶æ›´æ”¹keymap é‡ç½®å¿«æ·é”®ï¼ˆæŒ‰å¿«æ·é”®æœç´¢ï¼‰ Â¶live templates Â¶ä¸»é¢˜é…ç½®ï¼š å¸¸è§„é…ç½®æµç¨‹ command + ï¼Œå‘¼å‡ºé…ç½®é¡¹ æˆ–è€… preferences è¿›å…¥ font é€‰æ‹© schemeé…ç½®é¡¹ . å¦‚æœé€‰æ‹©å­—ä½“primaryfontï¼Œå­—ä½“å¤§å°sizeæˆ–è€…é—´è·linespacingçš„è¯ï¼Œé¦–å…ˆè¦save as ä¸€ä»½scheme . Â¶è‡ªå®šä¹‰ä¸»é¢˜ï¼š daylerees.github.io ä¸Šé€‰æ‹©ä¸€æ¬¾è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ï¼š å¦‚é€‰æ‹© Potpourriï¼Œç„¶åå» https://github.com/daylerees/colour-schemes/tree/master/jetbrainsæ‰¾åˆ°å¯¹åº”çš„ä¸»é¢˜æ–‡ä»¶å¦‚å›¾ï¼š è¿›å…¥é€‰æ‹©å…·ä½“çš„URL è¿›å…¥å‘½ä»¤è¡Œ 1wget https://raw.githubusercontent.com/daylerees/colour-schemes/master/jetbrains/potpourri.icls ä¸‹è½½åé‡å¯ phpstrom æˆ–è€…å» http://www.ideacolorthemes.org/themes/ ä¸Šé€‰æ‹©å–œæ¬¢çš„ä¸»é¢˜ç„¶åä¸‹è½½. ç„¶åfileå€’å…¥è®¾ç½® å°†ä¸»é¢˜å’Œå·¦ä¾§çš„å·¥å…·æ è‰²è°ƒä¿æŒä¸€è‡´æ–¹æ³•ï¼š command + ï¼Œå‘¼å‡ºé…ç½®é¡¹,ç„¶åæœç´¢plugins,ä¸‹è½½ color Ide å°†ä¸»é¢˜å­—ä½“å’Œå·¦ä¾§çš„å·¥å…·æ å­—ä½“ä¿æŒä¸€è‡´æ–¹æ³•ï¼š Â¶ ä¸‹è½½å­—ä½“ï¼ˆ primary fontï¼‰ æ–¹æ³•ï¼š ä»¥FiraCodeå­—ä½“ä¸ºä¾‹ ç™»é™† https://github.com/tonsky/FiraCode ä¸‹è½½ ç„¶å å€’å…¥è®¾ç½® Â¶phpstrom æç®€ä¸»ä¹‰é…ç½® ä¸€ éšè—å„ç§ toolbar view å»æ‰ toolbar ï¼Œstatus Bar , Navigation Bar ,Tool Buttons å‹¾é€‰ äºŒ éšè— breadcrumbs å‘¼å‡ºé…ç½®é¡¹ï¼Œæœç´¢ breadcrumbs ï¼Œå»æ‰ show breadcrumbs å‹¾é€‰é¡¹ ä¸‰ éšè—æ–‡ä»¶åï¼Œä¿æŒå½“å‰çª—å£ç›´æœ‰ä¸€ä¸ªæ–‡ä»¶ æ–‡ä»¶å³é”®ï¼Œé€‰æ‹© tabs placement ,é€‰æ‹© none æ¢å¤ï¼Œå‘¼å‡ºé…ç½®é¡¹ æœç´¢ editor tabs é‡æ–°æŒ‡å®š placement å±æ€§ å›› é…ç½®ä¸»é¢˜ å»é€‰ä¸»é¢˜ http://daylerees.github.io ä¸‹è½½ä¸»é¢˜ https://github.com/daylerees/colour-schemes é€‰æ‹© jetbrains ï¼Œå…·ä½“å‚æ•°ä»¥ä¸Šæ­¥éª¤ã€‚ 123cd ~/Library/Preferences/WebIde100/colorswget https://raw.githubusercontent.com/daylerees/colour-schemes/master/jetbrains/earthsong.icls é‡å¯ phpstromï¼Œå‘¼å‡ºé…ç½®é¡¹ï¼Œé€‰æ‹©ä¸»é¢˜ ï¼Œsave as ä¸º earthsong-themeï¼Œåœ¨é‡æ–°è®¾ç½®å­—ä½“ç­‰ã€‚ äº” ç»Ÿä¸€ left bar çš„é¢œè‰² å¿«æ·é”® command + shift + A æœç´¢ plugins ç„¶åé€‰æ‹© config pluginsï¼Œæˆ–è€… å‘¼å‡ºé…ç½®é¡¹ æœç´¢ plugins,ç„¶åé€‰æ‹© Browse repositores â€¦ , æœç´¢color ide ,å®‰è£… å…­ ä¸¤ä¸ªé‡è¦çš„å¿«æ·é”®é‡ç½® ï¼ˆ1ï¼‰æœç´¢æ–‡ä»¶ æ”¹ä¸º command + P command + shift + A æœç´¢ keymap è¿›å…¥è®¾ç½®é¡¹é¡µé¢ï¼Œé¦–å…ˆå°†default copyä¸€ä»½ååœ¨é‡ç½®ï¼Œç‚¹å‡»copy ,å‘½å lihongwei-keymap æœç´¢ command + shift + O , ç„¶å remove command + shift + O ,åœ¨ add keyboard shortcut ,è¾“å…¥æ–°çš„å¿«æ·é”®ï¼Œç‚¹ ok (2) åˆ—å‡ºæ–‡ä»¶ä¸­çš„æ–¹æ³•åŸå¿«æ·é”® command + F12 æ”¹ä¸º command + W æ–¹æ³•åŒä¸Š,æ³¨æ„ F12 åŒæ—¶è¦æŒ‰ä½ Fn ä¸ƒ å¿«é€Ÿåˆ›å»ºæ–‡ä»¶ command + ä¸Šç®­å¤´ äº§çœ‹å½“å‰æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡å·¦å³ç®­å¤´æ§åˆ¶è¦åˆ›å»ºæ–‡ä»¶æ‰€è¦åœ¨çš„ç›®å½•ç„¶åï¼Œåœ¨æŒ‰ command + N è°ƒå‡ºæ–°å»ºæ–‡ä»¶é€‰é¡¹æ¡† å…« æ¨¡ç‰ˆ è¿ç»­ä¸¤ä¸‹ shift æœç´¢ file template æˆ–è€… command + shift + A æœç´¢ file template (1) æ–°å»ºæ¨¡ç‰ˆåä¸º Eloquent Model ï¼ŒExtension ä¸º php 12345678910111213#parse(&quot;PHP File Header.php&quot;)#if ($&#123;NAMESPACE&#125;)namespace $&#123;NAMESPACE&#125;;#endclass $&#123;NAME&#125; extends Eloquent &#123; protected \\$fillable = [];&#125; ç„¶åå»æ–°å»º Eloquent Model ä¹ åŠ¨æ€æ¨¡ç‰ˆ å å…³äºæ„é€ ï¼Œset,get,doc åˆ›å»ºæ„é€ æ–¹æ³•,è®¾ç½®å±æ€§å€¼ ,è·å–å±æ€§å€¼ ï¼Œæ–‡æ¡£æ³¨é‡Š command + N é€‰æ‹©å¯¹åº”çš„é€‰é¡¹ ç»™æ„é€ æ–¹æ³•åšä¾èµ–æ³¨å…¥å¿«æ·é”® option + return (å›è½¦) ç„¶åå¯ä»¥æŒ‡å®šè¦æ„é€ çš„å±æ€§ ï¼Œå‰ææ¡ä»¶ï¼Œé¼ æ ‡è¦åœ¨æ„é€ æ–¹æ³•çš„æ‹¬å·å†… æ„é€ çš„åŠ¨æ€æ¨¡ç‰ˆ,æœç´¢ live template ,é€‰æ‹© php ,æ–°å»º _c 12345public function __construct($ARGS$)&#123; $END$&#125; æœ€ådifine PHP ä½¿ç”¨ ç›´æ¥ _c ï¼Œç„¶å option + return","raw":null,"content":null,"categories":[{"name":"ç¼–è¾‘å™¨","slug":"ç¼–è¾‘å™¨","permalink":"http://blog.nicexiangcun.com/categories/%E7%BC%96%E8%BE%91%E5%99%A8/"}],"tags":[{"name":"phpstrom","slug":"phpstrom","permalink":"http://blog.nicexiangcun.com/tags/phpstrom/"}]},{"title":"RESTful API è®¾è®¡è¦ç´ ","slug":"RESTful-API","date":"2016-06-03T13:51:45.000Z","updated":"2020-11-20T13:06:15.509Z","comments":true,"path":"2016/06/03/RESTful-API/","link":"","permalink":"http://blog.nicexiangcun.com/2016/06/03/RESTful-API/","excerpt":"RESTful API è®¾è®¡\nÂ¶åè®®\nAPIä¸ç”¨æˆ·çš„é€šä¿¡åè®®ï¼ŒHTTPS/HTTPã€‚\nÂ¶åŸŸå\nhttps://api.domain.com ä¸“ç”¨apiåŸŸå\næˆ–è€…\nhttps://domain.com/api/ å°†apiä½œä¸ºä¸€ä¸ªæ¨¡å—\nÂ¶ç‰ˆæœ¬ï¼ˆVersioningï¼‰\nhttps://api.example.com/v1/ å°†ç‰ˆæœ¬å·ä½“ç°åœ¨URLä¸Š\nÂ¶è·¯å¾„\nåœ¨RESTfulæ¶æ„ä¸­ï¼Œæ¯ä¸ªç½‘å€ä»£è¡¨ä¸€ç§èµ„æºï¼ˆresourceï¼‰ï¼Œæ‰€ä»¥ç½‘å€ä¸­ä¸èƒ½æœ‰åŠ¨è¯ï¼Œåªèƒ½æœ‰åè¯ï¼Œè€Œä¸”æ‰€ç”¨çš„åè¯å¾€å¾€ä¸æ•°æ®åº“çš„è¡¨æ ¼åå¯¹åº”ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®åº“ä¸­çš„è¡¨éƒ½æ˜¯åŒç§è®°å½•çš„&quot;é›†åˆ&quot;ï¼ˆcollectionï¼‰ï¼Œæ‰€ä»¥APIä¸­çš„åè¯ä¹Ÿåº”è¯¥ä½¿ç”¨å¤æ•°ã€‚\nhttps://api.example.com/v1/article","text":"RESTful API è®¾è®¡ Â¶åè®® APIä¸ç”¨æˆ·çš„é€šä¿¡åè®®ï¼ŒHTTPS/HTTPã€‚ Â¶åŸŸå https://api.domain.com ä¸“ç”¨apiåŸŸå æˆ–è€… https://domain.com/api/ å°†apiä½œä¸ºä¸€ä¸ªæ¨¡å— Â¶ç‰ˆæœ¬ï¼ˆVersioningï¼‰ https://api.example.com/v1/ å°†ç‰ˆæœ¬å·ä½“ç°åœ¨URLä¸Š Â¶è·¯å¾„ åœ¨RESTfulæ¶æ„ä¸­ï¼Œæ¯ä¸ªç½‘å€ä»£è¡¨ä¸€ç§èµ„æºï¼ˆresourceï¼‰ï¼Œæ‰€ä»¥ç½‘å€ä¸­ä¸èƒ½æœ‰åŠ¨è¯ï¼Œåªèƒ½æœ‰åè¯ï¼Œè€Œä¸”æ‰€ç”¨çš„åè¯å¾€å¾€ä¸æ•°æ®åº“çš„è¡¨æ ¼åå¯¹åº”ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®åº“ä¸­çš„è¡¨éƒ½æ˜¯åŒç§è®°å½•çš„&quot;é›†åˆ&quot;ï¼ˆcollectionï¼‰ï¼Œæ‰€ä»¥APIä¸­çš„åè¯ä¹Ÿåº”è¯¥ä½¿ç”¨å¤æ•°ã€‚ https://api.example.com/v1/article Â¶HTTPåŠ¨è¯ å¯¹äºèµ„æºçš„å…·ä½“æ“ä½œç±»å‹ï¼Œç”±HTTPåŠ¨è¯è¡¨ç¤ºã€‚ å¸¸ç”¨çš„HTTPåŠ¨è¯æœ‰ä¸‹é¢äº”ä¸ªï¼ˆæ‹¬å·é‡Œæ˜¯å¯¹åº”çš„SQLå‘½ä»¤ï¼‰ã€‚ GETï¼ˆSELECTï¼‰ï¼šä»æœåŠ¡å™¨å–å‡ºèµ„æºï¼ˆä¸€é¡¹æˆ–å¤šé¡¹ï¼‰ã€‚ POSTï¼ˆCREATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªèµ„æºã€‚ PUTï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜åçš„å®Œæ•´èµ„æºï¼‰ã€‚ PATCHï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜çš„å±æ€§ï¼‰ã€‚ DELETEï¼ˆDELETEï¼‰ï¼šä»æœåŠ¡å™¨åˆ é™¤èµ„æºã€‚ ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ã€‚ GET /articleï¼šåˆ—å‡ºæ‰€æœ‰æ–‡ç«  POST /articleï¼šæ–°å»ºä¸€ç¯‡æ–‡ç«  GET /article/IDï¼šè·å–ä¸€ç¯‡æ–‡ç«  PUT /article/IDï¼šæ›´æ–°ä¸€ç¯‡æ–‡ç«  ï¼ˆæä¾›æ–‡ç« çš„å…¨éƒ¨ä¿¡æ¯ï¼‰ PATCH /article/IDï¼šæ›´æ–°ä¸€ç¯‡æ–‡ç« ï¼ˆæä¾›æ–‡ç« çš„éƒ¨åˆ†ä¿¡æ¯ï¼‰ DELETE /article/IDï¼šåˆ é™¤ä¸€ç¯‡æ–‡ç«  GET /article/ID/tagsï¼šåˆ—å‡ºä¸€ç¯‡æ–‡ç« çš„æ‰€æœ‰æ ‡ç­¾ DELETE /article/ID/tags/IDï¼šåˆ é™¤ä¸€ç¯‡æ–‡ç« çš„ä¸€ä¸ªæ ‡ç­¾ Â¶è¿‡æ»¤ä¿¡æ¯ï¼ˆFilteringï¼‰ å¦‚æœè®°å½•æ•°é‡å¾ˆå¤šï¼ŒæœåŠ¡å™¨ä¸å¯èƒ½éƒ½å°†å®ƒä»¬è¿”å›ç»™ç”¨æˆ·ã€‚APIåº”è¯¥æä¾›å‚æ•°ï¼Œè¿‡æ»¤è¿”å›ç»“æœã€‚ ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„å‚æ•°ã€‚ ?limit=10ï¼šæŒ‡å®šè¿”å›è®°å½•çš„æ•°é‡ ?offset=10ï¼šæŒ‡å®šè¿”å›è®°å½•çš„å¼€å§‹ä½ç½®ã€‚ ?page=2&amp;per_page=100ï¼šæŒ‡å®šç¬¬å‡ é¡µï¼Œä»¥åŠæ¯é¡µçš„è®°å½•æ•°ã€‚ ?sortby=name&amp;order=ascï¼šæŒ‡å®šè¿”å›ç»“æœæŒ‰ç…§å“ªä¸ªå±æ€§æ’åºï¼Œä»¥åŠæ’åºé¡ºåºã€‚ ?article_type_id=1ï¼šæŒ‡å®šç­›é€‰æ¡ä»¶ Â¶çŠ¶æ€ç ï¼ˆStatus Codesï¼‰ æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›çš„çŠ¶æ€ç å’Œæç¤ºä¿¡æ¯ï¼Œå¸¸è§çš„æœ‰ä»¥ä¸‹ä¸€äº›ï¼ˆæ–¹æ‹¬å·ä¸­æ˜¯è¯¥çŠ¶æ€ç å¯¹åº”çš„HTTPåŠ¨è¯ï¼‰ã€‚ 200 OK - [GET]ï¼šæœåŠ¡å™¨æˆåŠŸè¿”å›ç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼ˆIdempotentï¼‰ã€‚ 201 CREATED - [POST/PUT/PATCH]ï¼šç”¨æˆ·æ–°å»ºæˆ–ä¿®æ”¹æ•°æ®æˆåŠŸã€‚ 202 Accepted - []ï¼šè¡¨ç¤ºä¸€ä¸ªè¯·æ±‚å·²ç»è¿›å…¥åå°æ’é˜Ÿï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰ 204 NO CONTENT - [DELETE]ï¼šç”¨æˆ·åˆ é™¤æ•°æ®æˆåŠŸã€‚ 400 INVALID REQUEST - [POST/PUT/PATCH]ï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚æœ‰é”™è¯¯ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ–°å»ºæˆ–ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ã€‚ 401 Unauthorized - []ï¼šè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰ã€‚ 403 Forbidden - [] è¡¨ç¤ºç”¨æˆ·å¾—åˆ°æˆæƒï¼ˆä¸401é”™è¯¯ç›¸å¯¹ï¼‰ï¼Œä½†æ˜¯è®¿é—®æ˜¯è¢«ç¦æ­¢çš„ã€‚ 404 NOT FOUND - []ï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚é’ˆå¯¹çš„æ˜¯ä¸å­˜åœ¨çš„è®°å½•ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ã€‚ 406 Not Acceptable - [GET]ï¼šç”¨æˆ·è¯·æ±‚çš„æ ¼å¼ä¸å¯å¾—ï¼ˆæ¯”å¦‚ç”¨æˆ·è¯·æ±‚JSONæ ¼å¼ï¼Œä½†æ˜¯åªæœ‰XMLæ ¼å¼ï¼‰ã€‚ 410 Gone -[GET]ï¼šç”¨æˆ·è¯·æ±‚çš„èµ„æºè¢«æ°¸ä¹…åˆ é™¤ï¼Œä¸”ä¸ä¼šå†å¾—åˆ°çš„ã€‚ 422 Unprocesable entity - [POST/PUT/PATCH] å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªéªŒè¯é”™è¯¯ã€‚ 500 INTERNAL SERVER ERROR - [*]ï¼šæœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œç”¨æˆ·å°†æ— æ³•åˆ¤æ–­å‘å‡ºçš„è¯·æ±‚æ˜¯å¦æˆåŠŸã€‚ Â¶é”™è¯¯å¤„ç†ï¼ˆError handlingï¼‰ å¦‚æœçŠ¶æ€ç æ˜¯4xxï¼Œå°±åº”è¯¥å‘ç”¨æˆ·è¿”å›å‡ºé”™ä¿¡æ¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿”å›çš„ä¿¡æ¯ä¸­å°†errorä½œä¸ºé”®åï¼Œå‡ºé”™ä¿¡æ¯ä½œä¸ºé”®å€¼å³å¯ã€‚ 123&#123; error: &quot;Invalid API key&quot;&#125; Â¶è¿”å›ç»“æœ é’ˆå¯¹ä¸åŒæ“ä½œï¼ŒæœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›çš„ç»“æœåº”è¯¥ç¬¦åˆä»¥ä¸‹è§„èŒƒã€‚ GET /collectionï¼šè¿”å›èµ„æºå¯¹è±¡çš„åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰ GET /collection/resourceï¼šè¿”å›å•ä¸ªèµ„æºå¯¹è±¡ POST /collectionï¼šè¿”å›æ–°ç”Ÿæˆçš„èµ„æºå¯¹è±¡ PUT /collection/resourceï¼šè¿”å›å®Œæ•´çš„èµ„æºå¯¹è±¡ PATCH /collection/resourceï¼šè¿”å›å®Œæ•´çš„èµ„æºå¯¹è±¡ DELETE /collection/resourceï¼šè¿”å›ä¸€ä¸ªç©ºæ–‡æ¡£ Â¶Hypermedia API RESTful APIæœ€å¥½åšåˆ°Hypermediaï¼Œå³è¿”å›ç»“æœä¸­æä¾›é“¾æ¥ï¼Œè¿å‘å…¶ä»–APIæ–¹æ³•ï¼Œä½¿å¾—ç”¨æˆ·ä¸æŸ¥æ–‡æ¡£ï¼Œä¹ŸçŸ¥é“ä¸‹ä¸€æ­¥åº”è¯¥åšä»€ä¹ˆã€‚ æ¯”å¦‚ï¼Œå½“ç”¨æˆ·å‘api.example.comçš„æ ¹ç›®å½•å‘å‡ºè¯·æ±‚ï¼Œä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªæ–‡æ¡£ã€‚ 123456&#123;&quot;link&quot;: &#123; &quot;rel&quot;: &quot;collection https://www.example.com/zoos&quot;, &quot;href&quot;: &quot;https://api.example.com/zoos&quot;, &quot;title&quot;: &quot;List of zoos&quot;, &quot;type&quot;: &quot;application/vnd.yourformat+json&quot;&#125;&#125; ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œæ–‡æ¡£ä¸­æœ‰ä¸€ä¸ªlinkå±æ€§ï¼Œç”¨æˆ·è¯»å–è¿™ä¸ªå±æ€§å°±çŸ¥é“ä¸‹ä¸€æ­¥è¯¥è°ƒç”¨ä»€ä¹ˆAPIäº†ã€‚relè¡¨ç¤ºè¿™ä¸ªAPIä¸å½“å‰ç½‘å€çš„å…³ç³»ï¼ˆcollectionå…³ç³»ï¼Œå¹¶ç»™å‡ºè¯¥collectionçš„ç½‘å€ï¼‰ï¼Œhrefè¡¨ç¤ºAPIçš„è·¯å¾„ï¼Œtitleè¡¨ç¤ºAPIçš„æ ‡é¢˜ï¼Œtypeè¡¨ç¤ºè¿”å›ç±»å‹ã€‚ Hypermedia APIçš„è®¾è®¡è¢«ç§°ä¸ºHATEOASã€‚Githubçš„APIå°±æ˜¯è¿™ç§è®¾è®¡ï¼Œè®¿é—®api.github.comä¼šå¾—åˆ°ä¸€ä¸ªæ‰€æœ‰å¯ç”¨APIçš„ç½‘å€åˆ—è¡¨ã€‚ 12345&#123; &quot;current_user_url&quot;: &quot;https://api.github.com/user&quot;, &quot;authorizations_url&quot;: &quot;https://api.github.com/authorizations&quot;, // ...&#125; ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæƒ³è·å–å½“å‰ç”¨æˆ·çš„ä¿¡æ¯ï¼Œåº”è¯¥å»è®¿é—®api.github.com/userï¼Œç„¶åå°±å¾—åˆ°äº†ä¸‹é¢ç»“æœã€‚ 1234&#123; &quot;message&quot;: &quot;Requires authentication&quot;, &quot;documentation_url&quot;: &quot;https://developer.github.com/v3&quot;&#125; ä¸Šé¢ä»£ç è¡¨ç¤ºï¼ŒæœåŠ¡å™¨ç»™å‡ºäº†æç¤ºä¿¡æ¯ï¼Œä»¥åŠæ–‡æ¡£çš„ç½‘å€ã€‚ Â¶å®‰å…¨å’Œå…¶å®ƒ ï¼ˆ1ï¼‰APIçš„èº«ä»½è®¤è¯åº”è¯¥ä½¿ç”¨OAuth 2.0æ¡†æ¶ã€‚ ï¼ˆ2ï¼‰æœåŠ¡å™¨è¿”å›çš„æ•°æ®æ ¼å¼ï¼Œåº”è¯¥å°½é‡ä½¿ç”¨JSONï¼Œé¿å…ä½¿ç”¨XMLã€‚","raw":null,"content":null,"categories":[{"name":"api","slug":"api","permalink":"http://blog.nicexiangcun.com/categories/api/"}],"tags":[{"name":"api","slug":"api","permalink":"http://blog.nicexiangcun.com/tags/api/"}]},{"title":"å¾®æœåŠ¡é¢†åŸŸè®¾è®¡èŒƒå¼-é¢†åŸŸè¾¹ç•Œ-é¢†åŸŸèŒè´£","slug":"å¾®æœåŠ¡-domain","date":"2016-06-01T13:55:53.000Z","updated":"2020-11-20T13:06:15.521Z","comments":true,"path":"2016/06/01/å¾®æœåŠ¡-domain/","link":"","permalink":"http://blog.nicexiangcun.com/2016/06/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1-domain/","excerpt":"","text":"Â¶design step ç¡®å®šé¢†åŸŸè¾¹ç•Œï¼Œé¢†åŸŸåŠŸèƒ½ï¼ˆæ‰€èƒ½æš´éœ²çš„æ¥å£åŠŸèƒ½ï¼‰ ï¼Œ é¢†åŸŸæ¨¡å‹ æ¦‚è¦è®¾è®¡ api è¯¦ç»†è®¾è®¡ API è¾“å…¥ è¾“å‡º coding é‡è¦çš„ä¸šåŠ¡ç”»ä¸€ç”»æµç¨‹å›¾ Â¶æœåŠ¡æ‹†åˆ† å°±ç°åœ¨çš„è½¯ä»¶å·¥ç¨‹æ¥è¯´ï¼Œéƒ½å¯ä»¥é€šè¿‡æŠ½è±¡æ¥ä¼˜é›…çš„è§£å†³é—®é¢˜ã€‚ é‡ç‚¹ï¼šæ˜ç¡®èŒè´£ï¼Œå…³æ³¨ç‚¹åˆ†ç¦» ã€‚ ä¸è¦é‡å¤æ—©è½®å­ï¼Œä½ è‡ªå·±é€ çš„è½®å­æ˜¯è‡ªå·±ä¸€ä¸ªäººæ‹ç€è„‘è¢‹ç“œé€ çš„ï¼Œç»“å¯¹ç¼–ç¨‹æˆ–è€…ä¸€ä¸ªå±‹å­å°±ä¸€å°ç”µè„‘å‡ ä¸ªäººè½®æºœå†™ä»£ç ï¼Œæœ‰è¶³å¤Ÿå¤šçš„çœ¼ç›ï¼Œå°±å¯ä»¥è®©é—®é¢˜æµ®ç°ã€‚ é‡è¦çš„ä¸šåŠ¡åœºæ™¯ä¸€å®šè¦åŒ–æµç¨‹å›¾ã€‚ç»“å¯¹ç¼–ç¨‹ã€‚ è¿½æ±‚å•ä¸ªæ–‡ä»¶ä»£ç è¡Œæ•°ï¼Œè¿˜æ˜¯æ–‡ä»¶ä¸ªæ•°ï¼Œå–å†³ä½ æ˜¯å¦ èƒ½å¤Ÿå¿«é€Ÿæè¿°ä¸€æ®µä»£ç çš„æµç¨‹ æœåŠ¡æ‹†åˆ†ï¼šä»£ç æŒ‰ç…§ä¸šåŠ¡ æ°´å¹³æ‹†ï¼Œç»“å¯¹ç¼–ç¨‹ å‚ç›´æ‹†ï¼Œè¿™é‡Œå¯èƒ½æ¶‰åŠåˆ°devpos çš„åæ¨¡å¼ã€‚ Â¶pass äº‘å¹³å° part component Â¶Apigetway Â¶æœåŠ¡æ³¨å†Œä¸­å¿ƒ æœåŠ¡æ³¨å†Œä¸­å¿ƒæ˜¯æœåŠ¡å‘ç°çš„æ ¸å¿ƒã€‚å®ƒä¿å­˜äº†å„ä¸ªå¯ç”¨æœåŠ¡å®ä¾‹çš„ç½‘ç»œåœ°å€ï¼ˆIP Addresså’ŒPortï¼‰ã€‚æœåŠ¡æ³¨å†Œä¸­å¿ƒå¿…é¡»è¦æœ‰é«˜å¯ç”¨æ€§å’Œå®æ—¶æ›´æ–°åŠŸèƒ½ã€‚ æœåŠ¡å‘ç°çš„æ ¸å¿ƒæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚æœåŠ¡æ³¨å†Œä¸­å¿ƒä¿å­˜äº†å„ä¸ªæœåŠ¡å¯ç”¨çš„å®ä¾‹çš„ç›¸å…³ä¿¡æ¯ã€‚æœåŠ¡æ³¨å†Œä¸­å¿ƒæä¾›äº†ç®¡ç†APIå’ŒæŸ¥è¯¢APIã€‚ä½¿ç”¨ç®¡ç†APIè¿›è¡ŒæœåŠ¡æ³¨å†Œã€æ³¨é”€ã€‚ç³»ç»Ÿçš„å…¶ä»–ç»„ä»¶å¯ä»¥é€šè¿‡æŸ¥è¯¢APIæ¥è·å¾—å½“å‰å¯ç”¨çš„æœåŠ¡å®ä¾‹ä¿¡æ¯ã€‚ æœ‰ä¸¤ç§ä¸»è¦çš„æœåŠ¡å‘ç°æ–¹å¼ï¼šå®¢æˆ·ç«¯å‘ç°ï¼ˆclient-side service discoveryï¼‰å’ŒæœåŠ¡ç«¯å‘ç°ï¼ˆ server-side discoveryï¼‰ã€‚åœ¨ä½¿ç”¨å®¢æˆ·ç«¯æœåŠ¡å‘ç°çš„æ–¹å¼ä¸­ï¼Œå®¢æˆ·é€šè¿‡æŸ¥è¯¢æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œé€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å®ä¾‹ã€‚åœ¨ä½¿ç”¨æœåŠ¡å™¨ç«¯å‘ç°ç³»ç»Ÿä¸­ï¼Œå®¢æˆ·è®¿é—®Router/load balancerï¼Œé€šè¿‡Router/load balanceræŸ¥è¯¢æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°ä¸€ä¸ªå¯ç”¨æœåŠ¡å®ä¾‹ä¸Šã€‚ æœåŠ¡æ³¨å†Œå’Œæ³¨é”€çš„æ–¹å¼ä¹Ÿæœ‰ä¸¤ç§ã€‚ä¸€ç§æ˜¯æœåŠ¡è‡ªå·±ä¸»åŠ¨çš„å°†è‡ªå·±æ³¨å†Œåˆ°æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œç§°ä¸ºself-registrationã€‚å¦ä¸€ç§æ˜¯é€šè¿‡å…¶ä»–ç»„ä»¶æ¥å¤„ç†æœåŠ¡çš„æ³¨å†Œå’Œæ³¨é”€ï¼Œç§°ä¸ºthird-party registrationã€‚ ä¸åŒè¯­è¨€ä¹‹é—´å¯ä»¥é€šè¿‡å„ç§ä»£ç†å®ç°æœåŠ¡æ³¨å†Œã€‚ Â¶problem ç¨‹åºå±‚çº§ç›®å½•ç»“æ„ï¼šå°½é‡é¿å…å·²ç¨‹åºå±‚é¢å»ºç«‹ç›®å½• ï¼Œ åº”ä»ä¸šåŠ¡è§’åº¦ç»„å»ºç›®å½•ç»“æ„ï¼Œå¹¶ä¸”ä¿è¯åŠŸèƒ½æ–‡ä»¶çš„é«˜å†…èšä½è€¦åˆ ã€‚ æ”¯æŒé—¨é¢åŒ…è£…æœåŠ¡ã€‚ Â¶Minimum Viable Product æ˜¯ä¸€ç§é¿å…å¼€å‘å‡ºå®¢æˆ·å¹¶ä¸çœŸæ­£éœ€è¦çš„äº§å“çš„å¼€å‘ç­–ç•¥ã€‚è¯¥ç­–ç•¥çš„åŸºæœ¬æƒ³æ³•æ˜¯ï¼Œå¿«é€Ÿåœ°æ„å»ºå‡ºç¬¦åˆäº§å“é¢„æœŸåŠŸèƒ½çš„æœ€å°åŠŸèƒ½é›†åˆï¼Œè¿™ä¸ªæœ€å°é›†åˆæ‰€åŒ…å«çš„åŠŸèƒ½è¶³ä»¥æ»¡è¶³äº§å“éƒ¨ç½²çš„è¦æ±‚å¹¶èƒ½å¤Ÿæ£€éªŒæœ‰å…³å®¢æˆ·ä¸äº§å“äº¤äº’çš„å…³é”®å‡è®¾[1]ã€‚è¯¥æ¦‚å¿µç”±Eric Riesåœ¨å…¶è‘—ä½œã€Šç²¾ç›Šåˆ›ä¸šå®æˆ˜ã€‹ä¸­æå‡ºï¼Œç”¨æœ€å¿«ã€æœ€ç®€æ˜çš„æ–¹å¼å»ºç«‹ä¸€ä¸ªå¯ç”¨çš„äº§å“åŸå‹ï¼Œè¿™ä¸ªåŸå‹è¦è¡¨è¾¾å‡ºä½ äº§å“æœ€ç»ˆæƒ³è¦çš„æ•ˆæœï¼Œç„¶åé€šè¿‡è¿­ä»£æ¥å®Œå–„ç»†èŠ‚ã€‚ http://www.jianshu.com/p/2e1ca1c22b65 http://www.woshipm.com/pd/237443.html","raw":null,"content":null,"categories":[{"name":"devops","slug":"devops","permalink":"http://blog.nicexiangcun.com/categories/devops/"}],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://blog.nicexiangcun.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ç”¨å¼‚æˆ–è¿ç®—å®ç°ä¸€ç§åŠ å¯†è§£å¯†æ–¹æ³•","slug":"php-sign","date":"2016-05-29T11:31:42.000Z","updated":"2020-11-20T13:06:15.515Z","comments":true,"path":"2016/05/29/php-sign/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/29/php-sign/","excerpt":"å…ˆæ¥ä»‹ç»PHPå‡ ä¸ªå‡½æ•°\n1234ctype_alpha    //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å…¨æ˜¯å­—æ¯ctype_lower    //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å°å†™ctype_upper    //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å¤§å†™ctype_digit    //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å…¨æ˜¯æ•°å­—","text":"å…ˆæ¥ä»‹ç»PHPå‡ ä¸ªå‡½æ•° 1234ctype_alpha //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å…¨æ˜¯å­—æ¯ctype_lower //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å°å†™ctype_upper //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å¤§å†™ctype_digit //æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å…¨æ˜¯æ•°å­— 1234567891011121314151617function StrCode($string, $action =&#x27;ENCODE&#x27;) &#123; $action!= &#x27;ENCODE&#x27; &amp;&amp; $string = base64_decode($string); $code= &#x27;&#x27;; $key= &#x27;abcdefghijklmnopqrstuvwxyz&#x27;; $keyLen= strlen($key); $strLen= strlen($string); for($i = 0; $i &lt; $strLen; $i++) &#123; $k= $i % $keyLen; /* 1 ^ 1 (åŠ å¯†å› å­å¯†é’¥) 0 ^ 1 = 1 * 0 ^ 1 (åŠ å¯†å› å­å¯†é’¥) 1 ^ 1 = 0 * 1 ^ 0 (åŠ å¯†å› å­å¯†é’¥) 1 ^ 0 = 1 * 0 ^ 0 (åŠ å¯†å› å­å¯†é’¥) 0 ^ 0 = 0 */ $code.= $string[$i] ^ $key[$k]; &#125; return($action != &#x27;DECODE&#x27; ? base64_encode($code) : $code);&#125;","raw":null,"content":null,"categories":[{"name":"php","slug":"php","permalink":"http://blog.nicexiangcun.com/categories/php/"}],"tags":[{"name":"sign","slug":"sign","permalink":"http://blog.nicexiangcun.com/tags/sign/"}]},{"title":"memcache","slug":"memcache","date":"2016-05-29T11:20:44.000Z","updated":"2020-11-20T13:06:15.514Z","comments":true,"path":"2016/05/29/memcache/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/29/memcache/","excerpt":"\nmemcache ä¸€è‡´æ€§hash\n\n123456789101112131415161718// memcacheä¸€è‡´æ€§hashå®ç°,ä¸ºäº†è§£å†³å¤šå°memcacheæœåŠ¡å™¨setcacheçš„æ—¶å€™å¢åŠ æˆ–åˆ é™¤èŠ‚ç‚¹å¯¼è‡´,ç¼“å­˜ç¬é—´å‘½ä¸ä¸­é—®é¢˜ é€šè¯hashç®—æ³•å°†èŠ‚ç‚¹æ˜ å°„åˆ°ä¸€ä¸ªåœ†ç¯ä¸Š// å®šä¹‰å¾ªç¯é“¾è¡¨ é•¿åº¦ ä¸º2çš„32 æ¬¡æ–¹$circle = array(0,1,2,3,4,5,6,7,8,9,10,11);//å°†3å°memcache æœåŠ¡å™¨èŠ‚ç‚¹æ˜ å°„çš„åœ†ç¯ä¸Š$circle[&#x27;3&#x27;] = &#x27;192.168.10.1&#x27;;$circle[&#x27;6&#x27;] = &#x27;192.168.10.2&#x27;;$circle[&#x27;9&#x27;] = &#x27;192.168.10.3&#x27;;//å»ºç«‹cacheè¯·æ±‚$key = 2;foreach ($circle as $key=&gt;$val)&#123;\tif(strlen($circle[$key])!=1)&#123;\t\t$cache-&gt;connect($circle[$key],&#x27;11211&#x27;);\t\t$cache-&gt;set($key,&#x27;val&#x27;);break;\t&#125;&#125;","text":"memcache ä¸€è‡´æ€§hash 123456789101112131415161718// memcacheä¸€è‡´æ€§hashå®ç°,ä¸ºäº†è§£å†³å¤šå°memcacheæœåŠ¡å™¨setcacheçš„æ—¶å€™å¢åŠ æˆ–åˆ é™¤èŠ‚ç‚¹å¯¼è‡´,ç¼“å­˜ç¬é—´å‘½ä¸ä¸­é—®é¢˜ é€šè¯hashç®—æ³•å°†èŠ‚ç‚¹æ˜ å°„åˆ°ä¸€ä¸ªåœ†ç¯ä¸Š// å®šä¹‰å¾ªç¯é“¾è¡¨ é•¿åº¦ ä¸º2çš„32 æ¬¡æ–¹$circle = array(0,1,2,3,4,5,6,7,8,9,10,11);//å°†3å°memcache æœåŠ¡å™¨èŠ‚ç‚¹æ˜ å°„çš„åœ†ç¯ä¸Š$circle[&#x27;3&#x27;] = &#x27;192.168.10.1&#x27;;$circle[&#x27;6&#x27;] = &#x27;192.168.10.2&#x27;;$circle[&#x27;9&#x27;] = &#x27;192.168.10.3&#x27;;//å»ºç«‹cacheè¯·æ±‚$key = 2;foreach ($circle as $key=&gt;$val)&#123; if(strlen($circle[$key])!=1)&#123; $cache-&gt;connect($circle[$key],&#x27;11211&#x27;); $cache-&gt;set($key,&#x27;val&#x27;);break; &#125;&#125; 1ã€ä¸€è‡´æ€§hashç®—æ³•åªæ˜¯å¸®æˆ‘ä»¬å‡å°‘cacheé›†ç¾¤ä¸­çš„æœºå™¨æ•°é‡å¢å‡çš„æ—¶å€™ï¼Œcacheçš„æ•°æ®èƒ½è¿›è¡Œæœ€å°‘é‡å»ºã€‚åªè¦cacheé›†ç¾¤çš„serveræ•°é‡æœ‰å˜åŒ–ï¼Œå¿…ç„¶äº§ç”Ÿæ•°æ®å‘½ä¸­çš„é—®é¢˜ 2ã€å¯¹äºæ•°æ®çš„åˆ†å¸ƒå‡è¡¡é—®é¢˜ï¼Œé€šè¿‡è™šæ‹ŸèŠ‚ç‚¹çš„æ€æƒ³æ¥è¾¾åˆ°å‡è¡¡åˆ†é…ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬cache serverèŠ‚ç‚¹è¶Šå°‘å°±è¶Šéœ€è¦è™šæ‹ŸèŠ‚ç‚¹è¿™ä¸ªæ–¹å¼æ¥å‡è¡¡è´Ÿè½½ã€‚ 3ã€æˆ‘ä»¬çš„cacheå®¢æˆ·ç«¯æ ¹æœ¬ä¸ä¼šç»´æŠ¤ä¸€ä¸ªmapæ¥è®°å½•æ¯ä¸ªkeyå­˜å‚¨åœ¨å“ªé‡Œï¼Œéƒ½æ˜¯é€šè¿‡keyçš„hashå’Œcacheserverï¼ˆä¹Ÿè®¸ipå¯ä»¥ä½œä¸ºå‚æ•°ï¼‰çš„hashè®¡ç®—å½“å‰çš„keyåº”è¯¥å­˜å‚¨åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šã€‚ 4ã€å½“æˆ‘ä»¬çš„cacheèŠ‚ç‚¹å´©æºƒäº†ã€‚æˆ‘ä»¬å¿…å®šä¸¢å¤±éƒ¨åˆ†cacheæ•°æ®ï¼Œå¹¶ä¸”è¦æ ¹æ®æ´»ç€çš„cache serverå’Œkeyè¿›è¡Œæ–°çš„ä¸€è‡´æ€§åŒ¹é…è®¡ç®—ã€‚æœ‰å¯èƒ½å¯¹éƒ¨åˆ†æ²¡æœ‰ä¸¢å¤±çš„æ•°æ®ä¹Ÿè¦åšé‡å»ºâ€¦ 5ã€è‡³äºæ­£å¸¸åˆ°è¾¾æ•°æ®å­˜å‚¨èŠ‚ç‚¹ï¼Œå¦‚ä½•æ‰¾åˆ°keyå¯¹åº”çš„æ•°æ®ï¼Œé‚£å°±æ˜¯cache serveræœ¬èº«çš„å†…éƒ¨ç®—æ³•å®ç°äº†ï¼Œæ­¤å¤„ä¸åšæè¿°ã€‚ è¿™é‡Œåªæ˜¯é’ˆå¯¹æ•°æ®çš„å­˜å‚¨æ–¹å¼ä»¥åŠæå–æ–¹å¼è¿›è¡Œäº†æµç¨‹å±•ç¤ºã€‚","raw":null,"content":null,"categories":[{"name":"memcache","slug":"memcache","permalink":"http://blog.nicexiangcun.com/categories/memcache/"}],"tags":[{"name":"memcache","slug":"memcache","permalink":"http://blog.nicexiangcun.com/tags/memcache/"}]},{"title":"PythonåŸºç¡€æ•°æ®ç±»å‹","slug":"python-base","date":"2016-05-29T10:50:03.000Z","updated":"2020-11-20T13:06:15.516Z","comments":true,"path":"2016/05/29/python-base/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/29/python-base/","excerpt":"12345678910111213141516#!/bin/python#ecoding=utf-8#å€’å…¥æ‰€éœ€è¦çš„æ¨¡å—import timeimport osimport md5import randomï¼ƒæ‰“å°è¯­å¥print &quot;ä½ å¥½!&quot;#å˜é‡çš„ç”³æ˜ï¼Œå‰é¢ä¸ç”¨åŠ ä¿®é¥°ç±»å‹#--intç±»å‹intA = 1;intB = 2;","text":"12345678910111213141516#!/bin/python#ecoding=utf-8#å€’å…¥æ‰€éœ€è¦çš„æ¨¡å—import timeimport osimport md5import randomï¼ƒæ‰“å°è¯­å¥print &quot;ä½ å¥½!&quot;#å˜é‡çš„ç”³æ˜ï¼Œå‰é¢ä¸ç”¨åŠ ä¿®é¥°ç±»å‹#--intç±»å‹intA = 1;intB = 2; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273#intç±»å‹å’ŒString ä¸èƒ½ç›´æ¥ç”¨+å·ï¼Œéœ€è¦è½¬æˆStringå†æ‹¼æ¥ã€‚print &quot;values:&quot; + str(intA + intB);#boolean ç±»å‹ è¦æ³¨æ„é‡Œé¢çš„å¤§å°å†™ Trueå’ŒFalsename = True#ifè¯­å¥ï¼Œéœ€è¦ä¸€èµ·å’Œforæ³¨æ„çš„æ˜¯åé¢åŠ å†’å·ï¼ˆ:ï¼‰if name== True: print &quot;true&quot;else: print &quot;false&quot; #forfor i in range(1,5,1): print i;#æ–¹æ³•ï¼ˆä¹Ÿåœ¨å‡½æ•°çš„å«æ³•ï¼‰çš„ç”³æ˜ã€‚åŒæ ·ä¸è¦å¿˜è®°äº†å†’å·ï¼Œå› ä¸ºPythonä¸åƒå…¶ä»–è¯­è¨€é‚£æ ·è¿˜è¦æ‹¬å·ï¼Œæ˜¯æŒ‰ä¸¥æ ¼çš„æ ¼å¼æ¥åŒºåˆ†çš„æ‰€ä»¥ä¸ªäººä¹Ÿæ¯”è¾ƒå–œæ¬¢åœ¨æ–¹æ³•åé¢åŠ ä¸ªç»“æŸæ³¨é‡Šã€‚def printName(name): print name print len(name) #end fun printNameprintName(&quot;my name is xxx&quot;)#å®¹å™¨,ä¹ æƒ¯Javaçš„æœ‹å‹è‚¯å®šä¹Ÿä¼šåƒæˆ‘ä¸€æ ·æƒ³åˆ°æ•°ç»„ï¼ˆString[]ï¼‰ã€é›†åˆï¼ˆListã€Mapï¼‰Pythonä¹ŸåŒæ ·æœ‰ç±»ä¼¼çš„ç±»å‹ã€‚#åˆ—è¡¨Listï¼Œç±»å‹Javaä¸­çš„é›†åˆList a = [1,2,3,&quot;array&quot;]a.append(&quot;insert values&quot;)a.insert(0, 0)for v in a: print v #å…ƒç»„ trupeï¼Œå’ŒJavaä¸­çš„æ•°ç»„ç±»ä¼¼ array = (&quot;array1&quot;,&quot;array2&quot;,&quot;array3&quot;)for arr in array: print arr#Dict å’ŒJavaä¸­çš„mapç±»ä¼¼mapValues = &#123;&quot;name&quot;:&quot;text123&quot;,&quot;age&quot;:18&#125;print mapValues.get(&#x27;age&#x27;)print mapValues[&#x27;name&#x27;]#timeå‡½æ•°ï¼Œéœ€è¦åœ¨å¤´éƒ¨æ·»åŠ  import timetime.sleep(1.5) #è¿™é‡Œçš„å•ä½æ˜¯ç§’ï¼Œå’ŒJavaæ¯«ç§’ä¸ä¸€æ ·ã€‚å½“ç„¶å¯ä»¥ä¼ å…¥å°æ•°print &quot;print content&quot;print time.time() print time.strftime(&#x27;%Y-%m-%d %H:%M:%d&#x27;) # Java ä¸­SimpleDateFormat#oså¯¹ç³»ç»Ÿä¸€äº›æ“ä½œprint os.name #ä½¿ç”¨çš„å¹³å°print os.getcwd() #å½“å‰å·¥ä½œç›®å½•files = os.listdir(&#x27;E:\\software&#x27;)#for f in files:#print f#os.remove(&#x27;D://Test.java&#x27;);#MD5m = md5.new(&quot;test123&quot;)print m.digest() #16ä½print m.hexdigest() #32ä½#randomprint random.random()#file textFile = open(&quot;D:\\\\test.txt&quot;);for line in textFile.readlines(): print linefile.close()","raw":null,"content":null,"categories":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://blog.nicexiangcun.com/tags/python/"}]},{"title":"YiiåŒ¿åå‡½æ•°","slug":"Yiidaytoday","date":"2016-05-28T04:34:35.000Z","updated":"2020-11-20T13:06:15.510Z","comments":true,"path":"2016/05/28/Yiidaytoday/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/28/Yiidaytoday/","excerpt":"","text":"Yii2åŒ¿åå‡½æ•°å°åº”ç”¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125namespace console\\controllers;use Yii;class TestController extends \\yii\\console\\Controller&#123; public $enableCsrfValidation = false; public function actionTest() &#123; //åœ¨å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…æ—¶,è¦æ³¨æ„å¦‚æœä¸€ä¸ªå˜é‡åœ¨é—­åŒ…ä¸­æ”¹å˜äº†å€¼,åˆ°ä¸‹ä¸€æ¬¡å¾ªç¯æ—¶,ä¸ä¼šè¢«é‡Šæ”¾ $type = []; $flg = 0; //è¦æ”¹å˜çš„å˜é‡ æˆ–è€…å¯¹è±¡ $data = [ [&#x27;type&#x27;=&gt;&#x27;1&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], [&#x27;type&#x27;=&gt;&#x27;1&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], [&#x27;type&#x27;=&gt;&#x27;2&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], [&#x27;type&#x27;=&gt;&#x27;1&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], [&#x27;type&#x27;=&gt;&#x27;2&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], [&#x27;type&#x27;=&gt;&#x27;1&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], [&#x27;type&#x27;=&gt;&#x27;2&#x27;,&#x27;one_level&#x27;=&gt;100,&#x27;two_lever&#x27;=&gt;200,&#x27;phone&#x27;=&gt;&#x27;15510337665&#x27; ], ] ; foreach($data as $key=&gt;$val)&#123; $this-&gt;filter($val , $flg ,function($ret) use ($type)&#123; file_put_contents(&#x27;lhw.log&#x27;,var_export($ret,true).PHP_EOL,FILE_APPEND); &#125;); &#125; &#125; private function filter(array $arr,$flg,$fun) &#123; if($arr[&#x27;type&#x27;] == &#x27;1&#x27;)&#123; $flg = 500; //ä¸‹æ¬¡å¾ªç¯500ä¸ä¼šä»å†…å­˜ä¸­é‡Šæ”¾ $arr[&#x27;one_level&#x27;] = $arr[&#x27;one_level&#x27;] + 1000; $arr[&#x27;flg&#x27;] = $flg + $arr[&#x27;one_level&#x27;]; &#125; $fun($arr); &#125; //ä½¿ç”¨è¿‡æ»¤ public function actionFilter() &#123; //ä¹ æƒ¯ä½¿ç”¨list æŒ‡å®šè·å–ç´¢å¼•æ•°ç»„å€¼ list($value, $property, $cType) = [&#x27;dd&#x27;,&#x27;33&#x27;,&#x27;32&#x27;]; //ä½¿ç”¨åŒ¿åå‡½æ•°è¿‡æ»¤å…ƒç´  $filterItem[&#x27;andor&#x27;] = &#x27;or&#x27;;//è¿‡æ»¤å…ƒç´  $andor = call_user_func(function($default) use($filterItem) &#123; if ((array_key_exists(&#x27;andor&#x27;, $filterItem)) &amp;&amp; (strtolower($filterItem[&#x27;andor&#x27;]) == &#x27;or&#x27;)) &#123; return &quot;OR&quot;; &#125; return $default; &#125;, &quot;AND&quot;); //ç»“åˆä½¿ç”¨ list($val) = [call_user_func(function($default) use ($filterItem)&#123; if ((array_key_exists(&#x27;andor&#x27;, $filterItem)) &amp;&amp; (strtolower($filterItem[&#x27;andor&#x27;]) == &#x27;or&#x27;)) &#123; return &quot;OR&quot;; &#125; return $default; &#125;,&#x27;default&#x27;)]; echo $val; &#125; //å¦‚æœæ•´ä¸ªaction éƒ½è¦æ±‚è¿”å›json å¯ä»¥åœ¨è¿›action ä¹‹å‰ åˆ¤æ–­è½¬æ¢å¦‚ï¼š public function beforeAction($action) &#123; if (Yii::$app-&gt;request-&gt;isAjax) &#123; Yii::$app-&gt;response-&gt;format = Response::FORMAT_JSON; &#125; return parent::beforeAction($action);//å¿…é¡»return &#125; public function actionApi() &#123; return [&#x27;name&#x27;=&gt;&#x27;lwh&#x27;] ;//è‡ªåŠ¨è½¬æ¢æˆjson &#125; //ä½¿ç”¨æ¨¡å‹å¯¹è±¡æ·»åŠ æ•°æ®çš„ä¸€ç§æ–¹æ³• public function actionAdd() &#123; SmsMessage::initSms( $user, [$user-&gt;real_name, date(&#x27;Y-m-d H:i&#x27;, $draw-&gt;created_at), $draw-&gt;money, &#x27;T+1&#x27;, Yii::$app-&gt;params[&#x27;contact_tel&#x27;]], Yii::$app-&gt;params[&#x27;sms&#x27;][&#x27;tixian_apply&#x27;] )-&gt;save(false); &#125; //æ•°æ®æ¨¡å‹ public static function initSms(User $user, array $message, $template_id, $level = self::LEVEL_MIDDLE) &#123; $smsmsg = new self([ &#x27;uid&#x27; =&gt; $user-&gt;id, &#x27;template_id&#x27; =&gt; $template_id, &#x27;mobile&#x27; =&gt; $user-&gt;mobile, &#x27;level&#x27; =&gt; $level, &#x27;message&#x27; =&gt; json_encode($message), ]); return $smsmsg; &#125;&#125;","raw":null,"content":null,"categories":[{"name":"Yii","slug":"Yii","permalink":"http://blog.nicexiangcun.com/categories/Yii/"}],"tags":[{"name":"Yii","slug":"Yii","permalink":"http://blog.nicexiangcun.com/tags/Yii/"}]},{"title":"designpatterns","slug":"designpatterns","date":"2016-05-22T06:48:32.000Z","updated":"2020-11-20T13:06:15.511Z","comments":true,"path":"2016/05/22/designpatterns/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/22/designpatterns/","excerpt":"ç»„åˆæ¨¡å¼\nç»„åˆæ¨¡å¼ç›¸å…³æ¦‚å¿µï¼šä¾èµ–æ³¨å…¥ã€æ§åˆ¶åè½¬\nÂ¶ä¾èµ–æ³¨å…¥æ¦‚å¿µï¼š\nä¸€ä¸ªç±»å¦‚æœæƒ³ä½¿ç”¨å¦ä¸€ç±»ä¸­çš„æŸäº›æ–¹æ³•æˆ–è€…å±æ€§ï¼Œé™¤äº†ç»§æ‰¿å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»„åˆï¼Œç»„åˆçš„å«ä¹‰æ˜¯å°†ç»§æ‰¿æˆ–è€…åœ¨æ„é€ è§¦å‘newçš„è¿‡ç¨‹ï¼Œæåˆ°ç±»çš„å¤–é¢å»åšï¼Œé‡‡ç”¨ä¾èµ–æ³¨å…¥çš„æ–¹å¼ä¼ é€’å¯¹è±¡ã€‚ï¼ˆæ¶ˆé™¤äº†ä¾èµ–ï¼‰é™ä½ä»£ç è€¦åˆç¨‹åº¦ï¼Œæé«˜é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€‚","text":"ç»„åˆæ¨¡å¼ ç»„åˆæ¨¡å¼ç›¸å…³æ¦‚å¿µï¼šä¾èµ–æ³¨å…¥ã€æ§åˆ¶åè½¬ Â¶ä¾èµ–æ³¨å…¥æ¦‚å¿µï¼š ä¸€ä¸ªç±»å¦‚æœæƒ³ä½¿ç”¨å¦ä¸€ç±»ä¸­çš„æŸäº›æ–¹æ³•æˆ–è€…å±æ€§ï¼Œé™¤äº†ç»§æ‰¿å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»„åˆï¼Œç»„åˆçš„å«ä¹‰æ˜¯å°†ç»§æ‰¿æˆ–è€…åœ¨æ„é€ è§¦å‘newçš„è¿‡ç¨‹ï¼Œæåˆ°ç±»çš„å¤–é¢å»åšï¼Œé‡‡ç”¨ä¾èµ–æ³¨å…¥çš„æ–¹å¼ä¼ é€’å¯¹è±¡ã€‚ï¼ˆæ¶ˆé™¤äº†ä¾èµ–ï¼‰é™ä½ä»£ç è€¦åˆç¨‹åº¦ï¼Œæé«˜é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€‚ è¿™ç§æ³¨å…¥çš„ç¼ºé™·åœ¨äºï¼šæˆ‘ä»¬çš„ä¸šåŠ¡å±‚å¯¹ä¾èµ–å•å…ƒçš„å®ä¾‹åŒ–ä»£ç æ˜¯ä¸€ä¸ªé‡å¤ã€ç¹ççš„è¿‡ç¨‹ã€‚ Â¶æ§åˆ¶åè½¬æ¦‚å¿µï¼š å°†ç±»ï¼ˆä¸Šå±‚ï¼‰,æ‰€ä¾èµ–çš„å•å…ƒï¼ˆä¸‹å±‚ï¼‰çš„å®ä¾‹åŒ–è¿‡ç¨‹äº¤ç”±ç¬¬ä¸‰æ–¹æ¥å®ç°ã€‚ä¸€ä¸ªç®€å•çš„ç‰¹å¾ï¼Œå°±æ˜¯ç±»ä¸­ä¸å¯¹æ‰€ä¾èµ–çš„å•å…ƒæœ‰è¯¸å¦‚ $component = new yii\\component\\SomeClassï¼ˆï¼‰ çš„å®ä¾‹åŒ–è¯­å¥ã€‚ Yiiä¸­ä¸ºä»€ä¹ˆè¦ä½¿ç”¨DIï¼Œåƒä¸Šé¢æ‰€æ‰€è¯´çš„ï¼Œä¸€ä¸ªç±»å¦‚æœæƒ³ä½¿ç”¨å¦ä¸€ç±»ä¸­çš„æŸäº›æ–¹æ³•æˆ–è€…å±æ€§ï¼Œé™¤äº†ç»§æ‰¿å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»„åˆï¼Œä¹Ÿå°±æ˜¯DIæ¨¡å¼ï¼Œå…¶æœ¬è´¨ç°è±¡å°±æ˜¯ï¼Œæˆ‘è®¿é—®æˆ‘æ‰€ä¾èµ–çš„å•å…ƒå¯¹è±¡ä¸­æˆå‘˜æ–¹æ³•æˆ–è€…å±æ€§æ—¶å°±åƒè®¿é—®æœ¬ç±»ä¸€æ ·ã€‚å› ä¸ºæˆ‘å·²ç»é€šè¿‡DIå°†æœ¬ç±»æ‰€ä¾èµ–çš„å•å…ƒæ³¨å…¥åˆ°äº†æœ¬ç±»ä¸­ã€‚ Â¶ä»€ä¹ˆæ—¶å€™æ˜¯æœ‰ç»§æ‰¿ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ ç»§æ‰¿æ„å‘³ç€å…¬ç”¨ï¼Œå…¬ç”¨çš„å«ä¹‰ï¼š ä¸€ å…¬ç”¨çš„åŠŸèƒ½ã€é€»è¾‘ï¼Œæ„å‘³ç€å…·ä½“çš„ï¼Œå¯å°è£…çš„ äºŒ å…¬ç”¨çš„ç‰¹æ€§ï¼Œä½†æ˜¯è¡¨ç°ä¸ä¸€æ ·ï¼Œæ„å‘³ç€æŠ½è±¡ï¼ŒæŠ½è±¡ç±» åŸºäºä»¥ä¸Šå¯ä»¥ä½¿ç”¨ç»§æ‰¿ã€‚ æ¥å£ï¼Œå½“æŸäº›å®ä¾‹æ‹¥æœ‰ä¸€éƒ¨åˆ†åŒºåˆ«äºå…¶ä»–åŒç±»å®ä¾‹çš„ç‰¹æ€§ï¼Œé‚£ä¹ˆè¿™äº›ç‰¹æ€§æ˜¯ä¸é€‚åˆè¢«è¿™äº›ç±»ç»§æ‰¿è¿‡æ¥çš„ï¼Œé‚£ä¹ˆè¿™äº›ç‰¹æ€§å¯ä»¥ä½¿ç”¨æ¥å£ï¼Œåªæœ‰é€‚ç”¨è¿™äº›ç‰¹æ€§çš„ç±»æ¥å®ç°è¿™ä¸ªæ¥å£ã€‚ Â¶ç­–ç•¥ å’Œ å¤šæ€ Â¶å·¥å‚ å’Œ æŠ½è±¡å·¥å‚","raw":null,"content":null,"categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://blog.nicexiangcun.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"Yii_install","slug":"Yii-install","date":"2016-05-17T13:37:39.000Z","updated":"2020-11-20T13:06:15.509Z","comments":true,"path":"2016/05/17/Yii-install/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/17/Yii-install/","excerpt":"ç”¨composer å®‰è£…Yii2\nå®‰è£…ä¾èµ–åŒ…æ–¹å¼ï¼Œè·å–å®šä¹‰çš„ä¾èµ–åˆ°ä½ çš„æœ¬åœ°é¡¹ç›®ï¼Œåªéœ€è¦è°ƒç”¨ composer.phar è¿è¡Œ install å‘½ä»¤å¦‚ã€‚\n1php composer.phar install\nå®‰è£…æ—¶éœ€è¦githugè´¦å·ï¼Œä¸‹è½½æ—¶éœ€è¦token,å¯ä»¥é€šè¿‡ git  ssh-keygen ç”Ÿæˆ tokenç§˜é’¥\nä¸€ å…ˆä¸‹è½½ advanced æ¨¡æ¿  https://github.com/yiisoft/yii2-app-advanced\näºŒ dos cd åˆ° advanced æ¨¡æ¿ä¸‹ ï¼šæ‰§è¡Œ\n12php -r &quot;readfile(&#x27;https://getcomposer.org/installer&#x27;);&quot; | php   //ä¸‹è½½ composer.phar \nä¸‰ å‡†å¤‡æ’ä»¶\n1php composer.phar global require &quot;fxp/composer-asset-plugin:1.0.0&quot;\næˆ–è€…\n1php composer.phar global require &quot;fxp/composer-asset-plugin:~1.1.1&quot;","text":"ç”¨composer å®‰è£…Yii2 å®‰è£…ä¾èµ–åŒ…æ–¹å¼ï¼Œè·å–å®šä¹‰çš„ä¾èµ–åˆ°ä½ çš„æœ¬åœ°é¡¹ç›®ï¼Œåªéœ€è¦è°ƒç”¨ composer.phar è¿è¡Œ install å‘½ä»¤å¦‚ã€‚ 1php composer.phar install å®‰è£…æ—¶éœ€è¦githugè´¦å·ï¼Œä¸‹è½½æ—¶éœ€è¦token,å¯ä»¥é€šè¿‡ git ssh-keygen ç”Ÿæˆ tokenç§˜é’¥ ä¸€ å…ˆä¸‹è½½ advanced æ¨¡æ¿ https://github.com/yiisoft/yii2-app-advanced äºŒ dos cd åˆ° advanced æ¨¡æ¿ä¸‹ ï¼šæ‰§è¡Œ 12php -r &quot;readfile(&#x27;https://getcomposer.org/installer&#x27;);&quot; | php //ä¸‹è½½ composer.phar ä¸‰ å‡†å¤‡æ’ä»¶ 1php composer.phar global require &quot;fxp/composer-asset-plugin:1.0.0&quot; æˆ–è€… 1php composer.phar global require &quot;fxp/composer-asset-plugin:~1.1.1&quot; è¦ä¿è¯ composer ç‰ˆæœ¬ä¸€è‡´ å‡çº§ 1.1.1 æ›´æ–°å‘½ä»¤ 12composer self-updatecomposer update å›› å®‰è£… 1php composer.phar create-project --prefer-dist --stability=dev yiisoft/yii2-app-advanced ../yii2test äº” æœ€åä¸€æ­¥ï¼šåˆå§‹åŒ–æˆ‘ä»¬çš„åº”ç”¨,åˆå§‹åŒ–æ˜¯åœ¨ä½ åˆ›å»ºçš„yii2testç›®å½•ä¸‹ æ‰§è¡Œ initå‘½ä»¤ é€‰0 æŒ‰y æœ€åYii2 æ·»åŠ æ–°åº”ç”¨éœ€è¦æ³¨æ„çš„åœ°æ–¹ ä»¥æ–°åŠ wap ç«™ä¸ºä¾‹ ä¸€ å°† frontend å‰å°å¤åˆ¶ä¸€ä»½ æ”¹åwap(æ³¨æ„æŠŠé‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„å‘½åç©ºé—´æ”¹ä¸º wapçš„) äºŒ å°†common/config bootstrap æ–°åŠ ä¸€ä»½ wap çš„åˆ«å ä¸‰ å°†common/config main.php æ–°åŠ è·¯ç”±ä¿®æ”¹é…ç½®ï¼ˆä¸ä½¿ç”¨é»˜è®¤è·¯ç”±è§„åˆ™ï¼‰ å°†æ”¹è¿‡æ¥çš„wap ä¸‹çš„config çš„main.php ä¸­çš„ id å’ŒcontrollerNamespace ç­‰æ”¹æ­£ç¡® 1234&#x27;urlManager&#x27; =&gt; [ &#x27;enablePrettyUrl&#x27; =&gt; true, &#x27;showScriptName&#x27; =&gt; false,] å››ï¼šä¿®æ”¹apache è·¯ç”±è§„åˆ™ éšè—ç‚¹ index.php RewriteEngine on RewriteCond %{REQUEST_FILENAME} !-d RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]","raw":null,"content":null,"categories":[{"name":"Yii","slug":"Yii","permalink":"http://blog.nicexiangcun.com/categories/Yii/"}],"tags":[{"name":"Yii","slug":"Yii","permalink":"http://blog.nicexiangcun.com/tags/Yii/"}]},{"title":"svn æ­å»º","slug":"svn","date":"2016-05-17T13:25:12.000Z","updated":"2020-11-20T13:06:15.518Z","comments":true,"path":"2016/05/17/svn/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/17/svn/","excerpt":"ubuntu svn æ­å»ºæ­¥éª¤ï¼š\nÂ¶ğŸ· å®‰è£…\n1sudo apt-get install subversion\nÂ¶å»ºç«‹ç‰ˆæœ¬åº“\n1234sudo mkdir -p /data/repossudo svnadmin create /data/repos/clientsudo svnadmin create /data/repos/serversudo svnadmin create /data/repos/api","text":"ubuntu svn æ­å»ºæ­¥éª¤ï¼š Â¶ğŸ· å®‰è£… 1sudo apt-get install subversion Â¶å»ºç«‹ç‰ˆæœ¬åº“ 1234sudo mkdir -p /data/repossudo svnadmin create /data/repos/clientsudo svnadmin create /data/repos/serversudo svnadmin create /data/repos/api Â¶é…ç½®æ–‡ä»¶ 123456789101112131415sudo vi authz[/]lhw=rwzhang=rwsudo vi passwd[users]zhang=123456lhw=123456sudo vi svnserve.confanon-access = none auth-access = writepassword-db = passwdrealm = /data/repos Â¶å¯åŠ¨svn (æ³¨æ„ç›®å½•ä¸ºç‰ˆæœ¬ä»“åº“çš„ä¸Šä¸€çº§ç›®å½•) 1sudo svnserve -d -r /data/repos/ Â¶æ€æ‰svn 1killall svnserve å¦‚æœå‡ºç°ï¼š 123svn: warning: cannot set LC_CTYPE localesvn: warning: environment variable LC_CTYPE is UTF-8svn: warning: please check that your locale name is correct è§£å†³ï¼š å‚è€ƒ http://stackoverflow.com/questions/11300633/svn-cannot-set-lc-ctype-locale 12345sudo apt-get install language-pack-en-basesudo locale-gen UTF-8sudo locale-gen en_GB.UTF-8sudo locale-gen en_US.UTF-8","raw":null,"content":null,"categories":[{"name":"svn","slug":"svn","permalink":"http://blog.nicexiangcun.com/categories/svn/"}],"tags":[{"name":"svn","slug":"svn","permalink":"http://blog.nicexiangcun.com/tags/svn/"}]},{"title":"nginx","slug":"nginx","date":"2016-05-15T05:19:51.000Z","updated":"2020-11-20T13:06:15.514Z","comments":true,"path":"2016/05/15/nginx/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/15/nginx/","excerpt":"nginx ä¿¡å·æ§åˆ¶\n\nÂ¶æŸ¥çœ‹æœåŠ¡ç«¯å£åˆ—è¡¨é¡¹\nnetstat -antp (pæ˜¯æ˜¾ç¤ºé‚£ä¸ªè¿›ç¨‹ å’Œè¿›ç¨‹å·)\nÂ¶æŸ¥çœ‹è¿›ç¨‹\nps -aux | grep 80  ï¼ˆhttpdï¼‰\nÂ¶ä¿¡å·æ§åˆ¶\nä½¿ç”¨å‚æ•°INTæ˜¯ç´§æ€¥æ€æ‰è¿›ç¨‹éå¸¸æš´åŠ›ï¼ˆç‰¹æ®Šåœºæ™¯ä¸æ¨èï¼‰ï¼ŒQUIT ä¼˜é›…çš„æ€æ‰è¿›ç¨‹ï¼Œç­‰å¾…workä¸»è¿›ç¨‹æ¥æ”¶å¤„ç†æ‰€æœ‰è¯·æ±‚ååœ¨æ€æ‰ã€‚HUPå¹³æ»‘çš„è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¸ç”¨é‡å¯nginxå°±èƒ½ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼ˆå¾ˆé‡è¦ï¼‰ï¼ŒUSR1 å‘Šè¯‰nginx å†™å…¥log å¾€æ–°å»ºçš„æ–‡ä»¶ä¸­å†™ï¼ˆåœ¨å¤‡ä»½logæ—¥å¿—æ—¶å¿…é¡»è¦ç”¨ï¼Œå› ä¸ºlinuxä¸­çš„æ–‡ä»¶å­˜æ”¾åœ°å€æ˜¯é€šè¿‡innodeå·å­˜å‚¨çš„ï¼Œå½“mv å¤‡ä»½æ–‡ä»¶çš„æ—¶å€™åªæ˜¯å˜åŒ–åå­—è€Œå·²ï¼Œè€Œinnodeå·ä¾ç„¶ä¸å˜ï¼Œæ‰€æœ‰nginxä¾ç„¶å¾€åŸå§‹çš„innodeå·æ–‡ä»¶å†™å…¥æ—¥å¿—ï¼Œæ­¤æ—¶éœ€è¦ç”¨ä¿¡å·é‡USR1ï¼‰ã€‚","text":"nginx ä¿¡å·æ§åˆ¶ Â¶æŸ¥çœ‹æœåŠ¡ç«¯å£åˆ—è¡¨é¡¹ netstat -antp (pæ˜¯æ˜¾ç¤ºé‚£ä¸ªè¿›ç¨‹ å’Œè¿›ç¨‹å·) Â¶æŸ¥çœ‹è¿›ç¨‹ ps -aux | grep 80 ï¼ˆhttpdï¼‰ Â¶ä¿¡å·æ§åˆ¶ ä½¿ç”¨å‚æ•°INTæ˜¯ç´§æ€¥æ€æ‰è¿›ç¨‹éå¸¸æš´åŠ›ï¼ˆç‰¹æ®Šåœºæ™¯ä¸æ¨èï¼‰ï¼ŒQUIT ä¼˜é›…çš„æ€æ‰è¿›ç¨‹ï¼Œç­‰å¾…workä¸»è¿›ç¨‹æ¥æ”¶å¤„ç†æ‰€æœ‰è¯·æ±‚ååœ¨æ€æ‰ã€‚HUPå¹³æ»‘çš„è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¸ç”¨é‡å¯nginxå°±èƒ½ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼ˆå¾ˆé‡è¦ï¼‰ï¼ŒUSR1 å‘Šè¯‰nginx å†™å…¥log å¾€æ–°å»ºçš„æ–‡ä»¶ä¸­å†™ï¼ˆåœ¨å¤‡ä»½logæ—¥å¿—æ—¶å¿…é¡»è¦ç”¨ï¼Œå› ä¸ºlinuxä¸­çš„æ–‡ä»¶å­˜æ”¾åœ°å€æ˜¯é€šè¿‡innodeå·å­˜å‚¨çš„ï¼Œå½“mv å¤‡ä»½æ–‡ä»¶çš„æ—¶å€™åªæ˜¯å˜åŒ–åå­—è€Œå·²ï¼Œè€Œinnodeå·ä¾ç„¶ä¸å˜ï¼Œæ‰€æœ‰nginxä¾ç„¶å¾€åŸå§‹çš„innodeå·æ–‡ä»¶å†™å…¥æ—¥å¿—ï¼Œæ­¤æ—¶éœ€è¦ç”¨ä¿¡å·é‡USR1ï¼‰ã€‚ kill -INT è¿›ç¨‹å· æ€æ‰nginxè¿›ç¨‹ï¼Œps -aux | greap nginxæŸ¥çœ‹è¿›ç¨‹å· å°æŠ€å·§ï¼šæœ‰æ—¶å€™ç»å¸¸éœ€è¦æŸ¥çœ‹ nginx ä¸»è¿›ç¨‹å·ï¼Œ å¯ä»¥æŸ¥çœ‹pidçš„å­˜æ”¾æ–‡ä»¶ï¼Œè¿™æ ·ç”¨çš„æ—¶å€™ç›´æ¥å¦‚ï¼š 1kill -INT &#x27;cat /usr/local/var/niginx/log/nginx.pid&#x27; Â¶nginxç¬¬äºŒç§å¯åŠ¨æ–¹æ³• nginx -s reload é‡å¯ nginx -s stop åœæ­¢ nginx -s reopen é‡æ–°è¯»å–é…ç½®æ–‡ä»¶ nginx -t æŸ¥çœ‹é…ç½®æ–‡ä»¶é…ç½®æ˜¯å¦æ­£ç¡® Â¶è™šæ‹Ÿä¸»æœºé…ç½® Nginx çš„è™šæ‹Ÿä¸»æœºå°±æ˜¯é…ç½® http ä¸­çš„ server å—ã€‚ å¯ä»¥åŸºäº åŸŸåã€ç«¯å£ã€å’Œip ä¸»è¦ ä¸‰é¡¹ï¼š listenã€server_nameã€location&#123; root:&#125; Location å®šä½é…ç½®å— ä¸‰ç§: ç²¾å‡†åŒ¹é…ï¼ˆç²¾å‡†åŒ¹é…æœ€å¥½ä¸è¦åŒ¹é…è·Ÿç›®å½•ï¼Œä¼šé»˜è®¤è¿½åŠ ç´¢å¼•æ–‡ä»¶å¯èƒ½å¯¼è‡´å¤šé‡å®šä½ï¼Œå¦‚å¾ªç¯é‡å®šå‘æ­»å¾ªç¯ç­‰ï¼‰ æ­£åˆ™åŒ¹é… æ™®é€šåŒ¹é…ï¼šæ™®é€šåŒ¹é…ä¼˜å…ˆçº§æœ€é«˜ï¼Œè¨€å¤–ä¹‹æ„æ˜¯æ­£åˆ™ä¼šè¦†ç›–æ™®é€šåŒ¹é…çš„ç»“æœ ï¼Œæ™®é€šåŒ¹é…å¦‚æœå‘½ä¸­å¤šä¸ªåˆ™æœ€é•¿çš„åŒ¹é…ç»“æœå…ˆè®°ä¸‹æ¥ï¼Œç„¶åèµ°æ­£åˆ™åŒ¹é…å¦‚æœæ­£åˆ™æ²¡æœ‰åŒ¹é…åˆ°è¿™è¿”å›è¿™ä¸ªæœ€é•¿çš„åŒ¹é…ç»“æœï¼Œé™æ€æ–‡ä»¶çš„åŠ¨é™åˆ†ç¦» å¯ä»¥ç”¨ location å°†é™æ€æ–‡ä»¶ æ”¾åˆ° åº”ç”¨ä»¥å¤–çš„ç›®å½• ç„¶åç”¨ loaction æ­£åˆ™å®šä½ã€‚ å¤‡æ³¨ï¼šå½“å‘ç° 404 æ—¶ è¦è®°ä½çœ‹ä¸‹log æ—¥å¿— æ˜¯å»å“ªä¸ªç›®å½•æ²¡æ‰¾åˆ° éå¸¸æœ‰ç”¨ ã€‚ Â¶æ—¥å¿—ç®¡ç†ï¼š é¦–å…ˆæ—¥å¿—å¯ä»¥è¾…åŠ©æ’é”™ï¼Œnginxå¯ä»¥é’ˆå¯¹ä¸åŒçš„serveré…ç½®ä¸åŒçš„logä½ç½®å’Œlogæ—¥å¿—æ ¼å¼ ï¼šé»˜è®¤æ˜¯main æ ¼å¼ï¼Œå¤§æ¦‚æ˜¯ æ¥è®¿è€…ip ï¼Œè®¿é—®æ–¹å¼ â€¦â€¦ ä¸€ä¸ªæ—¥å¿—çš„åˆ‡å‰²ç®¡ç†bash: 12345678910#!/bin/bashlogpath = /usr/local/nginx/log/access.logtopath = /data/log/$(date -d yesterday + &quot;%Y%m&quot;)mkdir -p $topathbathpath = $topaht/$(date -d yesterday + &quot;%Y%m%d&quot;).logmv $logpath $bathpahttouch $logpathkill USR1 /usr/run/nginx.pidsh ./run.sh","raw":null,"content":null,"categories":[{"name":"webserver","slug":"webserver","permalink":"http://blog.nicexiangcun.com/categories/webserver/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.nicexiangcun.com/tags/nginx/"}]},{"title":"Yii2","slug":"Yii2","date":"2016-05-13T07:17:31.000Z","updated":"2020-11-20T13:06:15.510Z","comments":true,"path":"2016/05/13/Yii2/","link":"","permalink":"http://blog.nicexiangcun.com/2016/05/13/Yii2/","excerpt":"Yii2 ç™»å½•æœºåˆ¶å’ŒéªŒè¯ç çš„ä½¿ç”¨\n\nÂ¶ğŸ¿ï¸ Yii2ç™»å½•\nå¦‚æœè¦é€šè¿‡giiè‡ªå®šä¹‰ç”Ÿäº§useræ¨¡å‹çš„è¯(ä¸é€‚ç”¨é»˜è®¤çš„user)ï¼Œè¦åœ¨å½“å‰åº”ç”¨çš„config/main ä¸‹é…ç½®userç»„ä»¶è·¯å¾„å¦‚ï¼š\n1234&#x27;user&#x27; =&gt; [        &#x27;identityClass&#x27; =&gt; &#x27;common\\models\\user\\Diyouuser&#x27;,        &#x27;enableAutoLogin&#x27; =&gt; true,    ],\næ¥ä¸‹æ¥åœ¨`loginForm` æ¨¡å‹ä¸‹ `use common\\models\\user\\Diyouuser;` ä½¿ç”¨è¯¥æ¨¡å‹\n\néªŒè¯è§„åˆ™å†™åœ¨ loginForm ä¸‹ å¦‚ï¼š\n","text":"Yii2 ç™»å½•æœºåˆ¶å’ŒéªŒè¯ç çš„ä½¿ç”¨ Â¶ğŸ¿ï¸ Yii2ç™»å½• å¦‚æœè¦é€šè¿‡giiè‡ªå®šä¹‰ç”Ÿäº§useræ¨¡å‹çš„è¯(ä¸é€‚ç”¨é»˜è®¤çš„user)ï¼Œè¦åœ¨å½“å‰åº”ç”¨çš„config/main ä¸‹é…ç½®userç»„ä»¶è·¯å¾„å¦‚ï¼š 1234&#x27;user&#x27; =&gt; [ &#x27;identityClass&#x27; =&gt; &#x27;common\\models\\user\\Diyouuser&#x27;, &#x27;enableAutoLogin&#x27; =&gt; true, ], æ¥ä¸‹æ¥åœ¨`loginForm` æ¨¡å‹ä¸‹ `use common\\models\\user\\Diyouuser;` ä½¿ç”¨è¯¥æ¨¡å‹ éªŒè¯è§„åˆ™å†™åœ¨ loginForm ä¸‹ å¦‚ï¼š 12345678910111213141516171819public function rules()&#123; return [ [[&#x27;username&#x27;, &#x27;password&#x27;], &#x27;required&#x27;], [&#x27;password&#x27;, &#x27;validatePassword&#x27;], ];&#125;public function validatePassword($attribute, $params)&#123; if (!$this-&gt;hasErrors()) &#123; $user = $this-&gt;getUser(); if (!$user || $user-&gt;password != md5($this-&gt;password)) &#123; $this-&gt;addError($attribute, &#x27;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&#x27;); &#125; &#125;&#125; åœ¨è§¦å‘ç™»å½•å‰è¦å…ˆéªŒè¯validatePasswordçš„è¯ å¿…é¡»è§¦å‘ Yiiçš„ $model-&gt;validate() å¦‚æœè¦æ·»åŠ è‡ªå®šä¹‰validateçš„è¯ï¼Œä¹Ÿå¿…é¡»åœ¨è§¦å‘loginå‰è°ƒç”¨è‡ªå®šä¹‰çš„mycustvalidateï¼Œ validate éƒ½éªŒè¯é€šè¿‡å åœ¨è§¦å‘ Yii çš„ login : Yii::$app-&gt;user-&gt;login($user); $user æ˜¯ common\\models\\user\\Diyouuser;ç»„ä»¶çš„ä¸€ä¸ªç»„ä»¶è€Œä¸”å¿…é¡»å®ç° IdentityInterface è¿™ä¸ªæ¥å£ Â¶Yii2 éªŒè¯ç ç›¸å…³ ä½¿ç”¨éªŒè¯ç æ­¥éª¤: åœ¨ä½¿ç”¨çš„ç›¸å…³ç±»ä¸­é‡å†™ Controllerä¸­çš„actionsæ–¹æ³•ä¸»è¦æ˜¯è‡ªå®šä¹‰é…ç½®ã€‚ è¦åšModelçš„éªŒè¯è§„åˆ™ä¸­æŒ‡å®šä½¿ç”¨çš„è·¯å¾„ä½ç½®å¦‚ : ['verify', 'captcha','captchaAction'=&gt;'login/captcha'] åœ¨è§†å›¾ä¸­ä½¿ç”¨widget éƒ¨ä»¶ å¦‚ï¼š 1234567891011121314151617&lt;?= $form-&gt;field($model, &#x27;verify&#x27;, [ ])-&gt;widget(yii\\captcha\\Captcha::className(), [ &#x27;template&#x27; =&gt; &#x27;&lt;div class=&quot;input-group&quot;&gt; &lt;span class=&quot;input-group-addon&quot;&gt; &lt;span class=&quot;glyphicon glyphicon-picture&quot;&gt;&lt;/span&gt; &lt;/span&gt;&#123;input&#125; &lt;span class=&quot;input-group-addon&quot;style=&quot;margin:0;padding:0&quot;&gt; &#123;image&#125; &lt;/span&gt; &lt;/div&gt;&#x27;, &#x27;imageOptions&#x27; =&gt; [ &#x27;alt&#x27; =&gt; &#x27;ç‚¹å‡»æ¢å›¾&#x27;, &#x27;title&#x27; =&gt; &#x27;ç‚¹å‡»æ¢å›¾&#x27;, &#x27;style&#x27; =&gt; &#x27;cursor:pointer&#x27; ], &#x27;captchaAction&#x27; =&gt; &#x27;login/captcha&#x27;, ])-&gt;label(false) ?&gt; Â¶Yii2 ä¸­çš„åˆ†é¡µ 1234567891011121314151617&lt;nav&gt;&lt;?php$this-&gt;widget(&#x27;CLinkPager&#x27;,array( &#x27;header&#x27;=&gt;&#x27;&#x27;, &#x27;firstPageLabel&#x27; =&gt; &#x27;é¦–é¡µ&#x27;, &#x27;lastPageLabel&#x27; =&gt; &#x27;æœ«é¡µ&#x27;, &#x27;prevPageLabel&#x27; =&gt; &#x27;ä¸Šä¸€é¡µ&#x27;, &#x27;nextPageLabel&#x27; =&gt; &#x27;ä¸‹ä¸€é¡µ&#x27;, &#x27;pages&#x27; =&gt; $pager, &#x27;maxButtonCount&#x27;=&gt;8, &#x27;cssFile&#x27;=&gt;false, &#x27;htmlOptions&#x27; =&gt;array(&quot;class&quot;=&gt;&quot;pagination&quot;), &#x27;selectedPageCssClass&#x27;=&gt;&quot;active&quot; ) );?&gt;&lt;/nav&gt; åˆ†é¡µå¿…é¡»åœ¨&lt;nav&gt;é‡Œ htmlOptionsé€‰é¡¹æ˜¯å¿…é¡»çš„ï¼Œä»–æŒ‡å®šäº†yiiç”Ÿæˆçš„åˆ†é¡µdivçš„classåç§°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨bootstrapçš„classå selectedPageCssClassé€‰é¡¹æŒ‡å®šäº†å½“å‰é€‰ä¸­é¡µçš„æ ·å¤šï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨bootstrapçš„active å¦å¤–è¿˜éœ€è¦æŠŠcssFileè®¾ä¸ºfalseï¼Œä¸åŠ è½½åˆ†é¡µcssæ ·å¼æ–‡ä»¶ Yii2äº‹ä»¶ Â¶Yii2ä¸­çš„äº‹ä»¶åŸç† Yii2ä¸­çš„äº‹ä»¶handle,å°±æ˜¯ä¸€æ®µå›è°ƒå¤„ç†ç¨‹åºï¼Œè¯´ç™½äº†handleå°±æ˜¯å›è°ƒå‡½æ•°çš„åº”ç”¨ï¼Œphpä¸­å›è°ƒçš„åº”ç”¨å‡ ç§æ–¹å¼ï¼š ä¸€. ä¸€ä¸ªå…¨å±€çš„å‡½æ•° å¦‚ 1234call_usr_func(&#x27;funcname&#x27;,&#x27;args&#x27;)$person = new Person;// ä½¿ç”¨PHPå…¨å±€å‡½æ•°ä½œä¸ºhandleræ¥è¿›è¡Œç»‘å®š$person-&gt;on(Person::EVENT_GREET, &#x27;person_say_hello&#x27;); äºŒ. å¯¹è±¡ä¸­çš„æˆå‘˜æ–¹æ³•å¦‚æœ: 12// ä½¿ç”¨å¯¹è±¡$objçš„æˆå‘˜å‡½æ•°say_helloæ¥è¿›è¡Œç»‘å®š$person-&gt;on(Person::EVENT_GREET, [$obj, &#x27;say_hello&#x27;]); ä¸‰.ç±»ä¸­çš„é™æ€æ–¹æ³•ï¼š 12// ä½¿ç”¨ç±»Greetçš„é™æ€æˆå‘˜å‡½æ•°say_helloè¿›è¡Œç»‘å®š$person-&gt;on(Person::EVENT_GREET, [&#x27;app\\helper\\Greet&#x27;, &#x27;say_hello&#x27;]); å››. åŒ¿åå‡½æ•°ï¼š 12345// ä½¿ç”¨åŒ¿åå‡½æ•°$person-&gt;on(Person::EVENT_GREET, function ($event) &#123; echo &#x27;Hello&#x27;;&#125;); Yii åœ¨ç»‘å®šäº‹ä»¶çš„æ—¶å€™ å…¶å®å°±æ˜¯ ç»´æŠ¤ä¸€ä¸ª _event äº‹ä»¶æ•°ç»„ï¼Œé€šè¿‡on æ–¹æ³• æŒ‰ç…§è§„åˆ™ å°† handleå’Œargsæ’å…¥åˆ°äº‹ä»¶æ•°ç»„é‡Œï¼Œå½“è°ƒç”¨triggeræ—¶å€™ï¼Œå…¶å®å°±æ˜¯å¾ªç¯ _enevt ç„¶å é€šè¿‡ call_user_func_array()è§¦å‘ å›è°ƒï¼Œå›è°ƒçš„é€»è¾‘è¦åœ¨ ï¼Œå®šä¹‰å¥½çš„ ä»¥ä¸Šå››ç§ ä¸­handdle ä¸­å®ç°ã€‚ Yii2 Layout Â¶Layoutå¸ƒå±€ åœ¨controall ä¸­ä½¿ç”¨å¸ƒå±€æ–‡ä»¶æ–¹æ³•ï¼š 1234567Public function init()&#123; Parent:: init(); //åœ¨å½“å‰controll æŒ‡å®šå¸ƒå±€æ–‡ä»¶ $this-&gt;layout = &#x27;custmain&#x27;ï¼› //åœ¨å½“å‰controllä¸ä½¿ç”¨å¸ƒå±€æ–‡ä»¶ $this-&gt;layout = false;&#125; ç„¶ååœ¨controll æ¸²æŸ“è§†å›¾å‰ åœ¨æŒ‡å®šè¦é‡æ–°å®šä¹‰çš„layout 1234Public function actionTest()&#123; $this-&gt;layout = &#x27;main&#x27;ï¼› $this-&gt;render();&#125; å¸ƒå±€æ–‡ä»¶å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼šåŸç†æ˜¯ä»å†…å¾€å¤–é€å±‚ä¼ é€’$content å˜é‡ ä¾‹å¦‚ï¼š Testlayout ä¸­æŒ‡å®š 123456789&lt;?php $this-&gt;beginContent(&#x27;@/app/view/layout/main&#x27;) ?&gt;&lt;div&gt; Cust content&lt;/div&gt;&lt;?php $content ?&gt;&lt;?php $this-&gt;endcontent ?&gt; æœ€ç»ˆå°†testlayoutæ–‡ä»¶ä½œä¸ºä¸€ä¸ªcontentå˜é‡ä¼ é€’åˆ°mainä¸­çš„content View ä¸­å¯ä»¥æŒ‡å®šå¤šä¸ª block å— é»˜è®¤æ˜¯ä¸€ä¸ª content,æ¯ä¸ªblockæ¬¾ è¦åœ¨layoutå¸ƒå±€æ–‡ä»¶ä¸­ ç”¨å˜é‡ä¸€ä¸€å¯¹åº” å¦‚: 1234567891011121314151617181920//View ä¸­æŒ‡å®šä¸¤ä¸ª block&lt;?php $this-&gt;beginBlock(&#x27;content&#x27;);?&gt; &lt;div&gt;test&lt;/div&gt; &lt;?php $this-&gt;endBlock ();?&gt;&lt;?php $this-&gt;beginBlock(&#x27;contenttwo&#x27;);?&gt; &lt;div&gt;test&lt;/div&gt; &lt;?php $this-&gt;endBlock ();?&gt;//é‚£ä¹ˆåœ¨ laoyout ä¸­main æ–‡ä»¶ä¸­ è¦æœ‰ä¸¤ä¸ªå˜é‡ &lt;?php echo $content ;?&gt;&lt;?php echo $contenttwo ;?&gt; Yii2ä¸­ widget å’Œ assets çš„ä½¿ç”¨ï¼š Â¶assets çš„ä½¿ç”¨ ä½¿ç”¨ assets èµ„æºæ§åˆ¶å™¨ï¼Œå¯ä»¥è¾¾åˆ°æŒ‰éœ€åŠ è½½cssã€jsæ ·å¼çš„ç›®çš„ï¼Œé€šå¸¸ä¼šå°†ä¸€ä¸ªç«™ç‚¹çš„å…¬å…±éƒ¨åˆ†æå–å‡ºæ¥ï¼Œåˆ¶ä½œlayoutå¸ƒå±€å¹¶ä¸”åˆ¶ä½œå…¬å…± assetsï¼Œåœ¨layoutçš„å¸ƒå±€ä¸­å°† assetsæ³¨å†Œè¿›æ¥ã€‚ ä¾‹å¦‚ï¼š å…ˆå®šä¹‰ä¸€ä¸ª MainAsset 123456789101112131415161718class MainAsset extends AssetBundle&#123; public $basePath = &#x27;@webroot&#x27;; public $baseUrl = &#x27;@web&#x27;; public $css = [ &#x27;css/base.css&#x27;, ]; public $js = [ ]; public $depends = [ &#x27;yii\\web\\YiiAsset&#x27;, &#x27;yii\\web\\JqueryAsset&#x27;, &#x27;backend\\assets\\FontAwesomeAsset&#x27;, &#x27;yii\\bootstrap\\BootstrapAsset&#x27;, ];&#125; ç„¶ååœ¨layoutä¸­è¿™æ ·ä½¿ç”¨ ï¼š 1MainAsset::register($this); //é»˜è®¤ä¼šå°†cssæ·»åŠ åˆ°headerä¸­å°†jsæ·»åŠ åˆ°é¡µå°¾ å½“æœ‰ä¸ªåˆ«é¡µé¢éœ€è¦åŠ è½½ä¸åŒé™æ€æ–‡ä»¶æ—¶ï¼Œæœ‰ä¸¤ç§å¼•ç”¨æ–¹å¼ï¼š ä¸€ï¼šåœ¨è§†å›¾ä¸­é€šè¿‡$this-&gt;registerJsFile()å¼•å…¥å¯ä»¥æŒ‡å®šä¾èµ–å…³ç³»å’ŒåŠ è½½é¡ºåºä¾‹å¦‚ï¼š 123$this-&gt;registerJsFile(&#x27;/js/editormd.js&#x27;,[&#x27;depends&#x27;=&gt;[&#x27;yii\\web\\JqueryAsset&#x27;]]);$this-&gt;registerCssFile(&#x27;/js/editormd.css&#x27;,[&#x27;depends&#x27;=&gt;[&#x27;yii\\web\\JqueryAsset&#x27;]]); å¦‚æœåœ¨æ§åˆ¶å™¨ä¸­å¯ä»¥ä½¿ç”¨å½“å‰çš„è§†å›¾å¯¹è±¡å¦‚ï¼š 123$view = $this-&gt;getView(); $view-&gt;registerJsFile(&#x27;/js/editormd.js&#x27;,[&#x27;depends&#x27;=&gt;[&#x27;yii\\web\\JqueryAsset&#x27;]]); $view-&gt;registerCssFile($cssfile, [AppAsset::className(), &#x27;depends&#x27; =&gt; &#x27;frontend\\assets\\AppAsset&#x27;]); äºŒï¼šåœ¨å•ç‹¬åˆ¶ä½œå‡ºä¸€ä¸ªauthorassetsç±» åœ¨é¡µé¢ä¸­é€šè¿‡ authorassets ::register($this);æ³¨å†Œè¿›æ¥ åœ¨æ§åˆ¶å™¨ä¸­ï¼š 12$view = $this-&gt;getView();authorassets::register($view); åœ¨æ§åˆ¶å™¨ä¸­æ‰§è¡Œä¸€æ®µjsä»£ç ï¼š 1$view-&gt;registerJs(&#x27;var &#x27;.$handle.&#x27; = editormd(&#x27;.$options.&#x27;);&#x27;); Â¶widgetçš„ä½¿ç”¨ widgetå¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨viewä¸­ä½¿ç”¨ åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š ä¸€ï¼šé€šè¿‡æ•°æ®æ¨¡å‹çš„ActiveFieldè°ƒç”¨ 1234567891011&lt;?=$form-&gt;field($model,&#x27;markdown&#x27;)-&gt;widget(&#x27;common\\widgets\\EditorMD&#x27;,[ &#x27;editorConfigs&#x27;=&gt;[ &#x27;height&#x27;=&gt;500, &#x27;markTextarea&#x27;=&gt;&#x27;Article[markdown]&#x27;, &#x27;htmlTextarea&#x27;=&gt;&#x27;Article[content]&#x27;, &#x27;saveHTMLToTextarea&#x27;=&gt;true, ], &#x27;editorOptions&#x27;=&gt;[ &#x27;style&#x27;=&gt;&#x27;z-index:1000;&#x27;, ]])?&gt; åœ¨ActiveFieldä¸­ä¼šè‡ªåŠ¨è§¦å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„widgetå¦‚ï¼š 12345678910public function widget($class, $config = [])&#123; /* @var $class \\yii\\base\\Widget */ $config[&#x27;model&#x27;] = $this-&gt;model; $config[&#x27;attribute&#x27;] = $this-&gt;attribute; $config[&#x27;view&#x27;] = $this-&gt;form-&gt;getView(); $this-&gt;parts[&#x27;&#123;input&#125;&#x27;] = $class::widget($config); return $this;&#125; äºŒï¼šç›´æ¥ä½¿ç”¨ 1&lt;?= \\backend\\widgets\\UploadWidget::widget([&#x27;id&#x27; =&gt; &#x27;icon_5&#x27;, &#x27;upload_success&#x27; =&gt; &#x27;upload_success&#x27;]) ?&gt; è®¾è®¡widgetçš„æ­¥éª¤ï¼š å®šä¹‰å±æ€§ï¼šè°ƒç”¨widgetçš„æ—¶å€™ä¼ çš„å±æ€§å€¼è¦åœ¨widgetä¸­å…ˆå®šä¹‰ widgetè°ƒç”¨åˆå§‹åŒ–æ—¶init()çš„é€»è¾‘ æœ€årun()è¿›è¡Œè¾“å‡ºã€‚","raw":null,"content":null,"categories":[{"name":"Yii","slug":"Yii","permalink":"http://blog.nicexiangcun.com/categories/Yii/"}],"tags":[{"name":"Yii","slug":"Yii","permalink":"http://blog.nicexiangcun.com/tags/Yii/"}]}]}